This file is a merged representation of the entire codebase, combined into a single document by Repomix.

================================================================
File Summary
================================================================

Purpose:
--------
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.

File Format:
------------
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  a. A separator line (================)
  b. The file path (File: path/to/file)
  c. Another separator line
  d. The full contents of the file
  e. A blank line

Usage Guidelines:
-----------------
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.

Notes:
------
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)


================================================================
Directory Structure
================================================================
.gitignore
backend/package.json
backend/README.md
backend/src/controllers/achivementsController.js
backend/src/controllers/admissionController.js
backend/src/controllers/auth.controller.js
backend/src/controllers/bookController.js
backend/src/controllers/feesController.js
backend/src/controllers/marksComtroller.js
backend/src/controllers/mngController.js
backend/src/controllers/readingProgressController.js
backend/src/controllers/recordController.js
backend/src/controllers/transactionController.js
backend/src/controllers/userController.js
backend/src/helper/bookHelper.js
backend/src/helper/transactionHelper.js
backend/src/helper/userHelper.js
backend/src/index.js
backend/src/lib/cloudinary.js
backend/src/lib/db.js
backend/src/lib/googleSheet.js
backend/src/lib/socket.js
backend/src/lib/utils.js
backend/src/middleware/auth.middleware.js
backend/src/models/achivement.model.js
backend/src/models/artsemester.model.js
backend/src/models/artsubject.model.js
backend/src/models/batch.model.js
backend/src/models/book.model.js
backend/src/models/fees.model.js
backend/src/models/feesStucture.model.js
backend/src/models/marklist.model.js
backend/src/models/mng.model.js
backend/src/models/readingProgress.model.js
backend/src/models/records.model.js
backend/src/models/registeredUser.model.js
backend/src/models/semester.model.js
backend/src/models/staff.model.js
backend/src/models/student.model.js
backend/src/models/Subject.model.js
backend/src/models/timetable.model.js
backend/src/models/transaction.model.js
backend/src/routes/achivement.route.js
backend/src/routes/admission.route.js
backend/src/routes/auth.route.js
backend/src/routes/book.route.js
backend/src/routes/fees.route.js
backend/src/routes/management.route.js
backend/src/routes/marks.route.js
backend/src/routes/readingProgress.route.js
backend/src/routes/records.route.js
backend/src/routes/transaction.route.js
backend/src/routes/user.route.js
frontend/eslint.config.js
frontend/index.html
frontend/package.json
frontend/postcss.config.js
frontend/public/apple-touch-icon.png
frontend/public/favicon-96x96.png
frontend/public/favicon.ico
frontend/public/favicon.svg
frontend/public/pdf.worker.min.js
frontend/public/site.webmanifest
frontend/public/UIA Logo.png
frontend/public/web-app-manifest-192x192.png
frontend/public/web-app-manifest-512x512.png
frontend/README.md
frontend/src/App.jsx
frontend/src/assets/logo.png
frontend/src/assets/react.svg
frontend/src/components/AchievementCard.jsx
frontend/src/components/AchievementDetailsModal.jsx
frontend/src/components/AchievementForm.jsx
frontend/src/components/AdminCard.jsx
frontend/src/components/AdminEmptyState.jsx
frontend/src/components/AdminInput.jsx
frontend/src/components/AdminReadingStatsCards.jsx
frontend/src/components/AdminStatsCards.jsx
frontend/src/components/BookTable.jsx
frontend/src/components/Button.jsx
frontend/src/components/Card.jsx
frontend/src/components/ChangePasswordModal.jsx
frontend/src/components/ConfirmPopup.jsx
frontend/src/components/EmptyState.jsx
frontend/src/components/Footer.jsx
frontend/src/components/Header.jsx
frontend/src/components/InputField.jsx
frontend/src/components/InstallPrompt.jsx
frontend/src/components/layout/DashboardLayout.jsx
frontend/src/components/layout/Sidebar.jsx
frontend/src/components/LoadingSpinner.jsx
frontend/src/components/ReadingEmptyState.jsx
frontend/src/components/ReadingProgressCard.jsx
frontend/src/components/ReadingProgressDetailsModal.jsx
frontend/src/components/ReadingProgressForm.jsx
frontend/src/components/ReadingStatsCards.jsx
frontend/src/components/SearchBar.jsx
frontend/src/components/SelectField.jsx
frontend/src/components/Skeleten.jsx
frontend/src/components/SociaIcons.jsx
frontend/src/components/StatsCards.jsx
frontend/src/components/StudentTable.jsx
frontend/src/components/ThemeSwapButton.jsx
frontend/src/components/TransactionsDetails.jsx
frontend/src/constants/index.js
frontend/src/index.css
frontend/src/lib/axios.js
frontend/src/main.jsx
frontend/src/pages/admin/AcademicRegister.jsx
frontend/src/pages/admin/AdminAchievementsPage.jsx
frontend/src/pages/admin/AdminAttendance.jsx
frontend/src/pages/admin/AdminBatches.jsx
frontend/src/pages/admin/AdminHome.jsx
frontend/src/pages/admin/AdminIshthiraq.jsx
frontend/src/pages/admin/AdminMarkUpdate.jsx
frontend/src/pages/admin/AdminReadingProgressPage.jsx
frontend/src/pages/admin/AdminsideMarkListes .jsx
frontend/src/pages/admin/AdmissionForm.jsx
frontend/src/pages/admin/AssignDutiesPage.jsx
frontend/src/pages/admin/AssignFees.jsx
frontend/src/pages/admin/BatchAcademicStatus.jsx
frontend/src/pages/admin/BatchStudents.jsx
frontend/src/pages/admin/CEMarkAdmin.jsx
frontend/src/pages/admin/FeesDashboardAnalytics.jsx
frontend/src/pages/admin/FeesRegister.jsx
frontend/src/pages/admin/InactiveStdList.jsx
frontend/src/pages/admin/IRMarkAdmin.jsx
frontend/src/pages/admin/ManagementPage.jsx
frontend/src/pages/admin/MarkSubmitedStudentsPage.jsx
frontend/src/pages/admin/RecordPage.jsx
frontend/src/pages/admin/RegisterdStudents.jsx
frontend/src/pages/admin/SemesterPage.jsx
frontend/src/pages/admin/SignupPage.jsx
frontend/src/pages/admin/StaffProfile.jsx
frontend/src/pages/admin/StudentForm.jsx
frontend/src/pages/admin/StudentList.jsx
frontend/src/pages/admin/TimetableAsigment.jsx
frontend/src/pages/LoginPage.jsx
frontend/src/pages/NotFound.jsx
frontend/src/pages/staff/AssignedSubjects.jsx
frontend/src/pages/staff/AttendancePage.jsx
frontend/src/pages/staff/BatchStudentsDetails.jsx
frontend/src/pages/staff/CalssTeacherHome.jsx
frontend/src/pages/staff/FeesTeacher.jsx
frontend/src/pages/staff/StaffAcademicRegister.jsx
frontend/src/pages/staff/TeacherAddGraceMark.jsx
frontend/src/pages/staff/TeacherHome.jsx
frontend/src/pages/student/AchivementPage.jsx
frontend/src/pages/student/CurruntSemSubjects.jsx
frontend/src/pages/student/MarkListPage.jsx
frontend/src/pages/student/readingProgressPage.jsx
frontend/src/pages/student/StdAcademicRegister.jsx
frontend/src/pages/student/StudentFees.jsx
frontend/src/pages/student/StudentHome.jsx
frontend/src/pages/student/StudentProfile.jsx
frontend/src/pages/student/StudentSemesterListing.jsx
frontend/src/pdf-overrides.css
frontend/src/routes/AdminRoutes.jsx
frontend/src/routes/AppRoutes.jsx
frontend/src/routes/PrivateRoutes.jsx
frontend/src/routes/PublicRoutes.jsx
frontend/src/routes/RoleBasedRoutes.jsx
frontend/src/routes/StudentRoutes.jsx
frontend/src/routes/TeacherRoutes.jsx
frontend/src/store/achivemnetStore.js
frontend/src/store/feesSrore.js
frontend/src/store/readingProgressStore.js
frontend/src/store/studentStore.js
frontend/src/store/useAdminMngStore.js
frontend/src/store/useAuthStore.js
frontend/src/store/useBooksStore.js
frontend/src/store/useMarksStore.js
frontend/src/store/useRecordStore.js
frontend/src/store/useRegisterdStudentStore.js
frontend/src/store/useStaffStore.js
frontend/src/store/useThemeStore.js
frontend/tailwind.config.js
frontend/vercel.json
frontend/vite.config.js

================================================================
Files
================================================================

================
File: frontend/src/components/layout/DashboardLayout.jsx
================
import { useState } from "react";
import { motion, AnimatePresence } from "framer-motion";
import { Outlet } from "react-router-dom";
import Header from "../Header"; // We will upgrade this next
import Sidebar from "./Sidebar"; // We will separate sidebar logic here

const DashboardLayout = () => {
  const [isSidebarOpen, setSidebarOpen] = useState(true);

  return (
    <div className="min-h-screen bg-slate-50 dark:bg-surface-dark text-slate-900 dark:text-slate-100 font-sans selection:bg-primary-500 selection:text-white overflow-hidden flex">
      
      {/* Background Decor Elements (Blobs) */}
      <div className="fixed top-0 left-0 w-full h-full overflow-hidden pointer-events-none z-0">
        <div className="absolute top-[-10%] left-[-10%] w-96 h-96 bg-primary-400/20 rounded-full blur-[100px] animate-float" />
        <div className="absolute bottom-[-10%] right-[-10%] w-96 h-96 bg-emerald-400/20 rounded-full blur-[100px] animate-float delay-1000" />
      </div>

      {/* Glass Sidebar */}
      <aside 
        className={`${isSidebarOpen ? 'w-72 translate-x-0' : 'w-20 translate-x-0'} 
        hidden md:flex flex-col fixed h-[96vh] top-[2vh] left-4 z-50
        bg-surface-glass dark:bg-surface-glassDark backdrop-blur-xl border border-white/20 dark:border-slate-700/50 
        rounded-3xl shadow-glass transition-all duration-500 ease-[cubic-bezier(0.25,0.8,0.25,1)]`}
      >
        <Sidebar isOpen={isSidebarOpen} toggle={() => setSidebarOpen(!isSidebarOpen)} />
      </aside>

      {/* Main Content Area */}
      <main 
        className={`flex-1 relative z-10 transition-all duration-500 ease-[cubic-bezier(0.25,0.8,0.25,1)]
        ${isSidebarOpen ? 'md:ml-80' : 'md:ml-28'} h-screen overflow-y-auto overflow-x-hidden scrollbar-hide`}
      >
        {/* Sticky Header */}
        <div className="sticky top-0 z-40 px-6 py-4">
          <Header fullWidth={!isSidebarOpen} />
        </div>

        {/* Page Content with Transition */}
        <div className="px-6 pb-6">
          <AnimatePresence mode="wait">
            <motion.div
              initial={{ opacity: 0, y: 20, scale: 0.98 }}
              animate={{ opacity: 1, y: 0, scale: 1 }}
              exit={{ opacity: 0, y: -20, scale: 0.98 }}
              transition={{ duration: 0.4, ease: "easeOut" }}
              className="w-full max-w-7xl mx-auto min-h-[85vh]"
            >
              <Outlet />
            </motion.div>
          </AnimatePresence>
        </div>
      </main>

    </div>
  );
};

export default DashboardLayout;

================
File: frontend/src/components/layout/Sidebar.jsx
================
import { NavLink } from "react-router-dom";
import { useAuthStore } from "../../store/useAuthStore";
import { 
  LayoutDashboard, Users, BookOpen, Calendar, 
  Award, Settings, LogOut, GraduationCap, 
  FileText, DollarSign, Layers, ChevronLeft, ChevronRight 
} from "lucide-react";
import { motion } from "framer-motion";

const Sidebar = ({ isOpen, toggle }) => {
  const { authUser, logout } = useAuthStore();
  const role = authUser?.role?.toLowerCase() || "student";

  // Define navigation items per role
  const NAV_ITEMS = {
    admin: [
      { name: "Dashboard", path: "/dashboard/admin", icon: LayoutDashboard },
      { name: "Students", path: "/dashboard/admin/users", icon: GraduationCap },
      { name: "Teachers", path: "/dashboard/admin/management", icon: Users }, // Assuming management holds teachers
      { name: "Academics", path: "/dashboard/admin/academic-register", icon: BookOpen },
      { name: "Duties", path: "/dashboard/admin/assign-duties", icon: Layers },
      { name: "Fees", path: "/dashboard/admin/ishthiraq", icon: DollarSign },
      { name: "Records", path: "/dashboard/admin/academic-records", icon: FileText },
    ],
    teacher: [
      { name: "Dashboard", path: "/dashboard/teacher", icon: LayoutDashboard },
      { name: "My Subjects", path: "/dashboard/teacher/assigned-subjects", icon: BookOpen },
      { name: "Register", path: "/dashboard/teacher/academic-register", icon: FileText },
      { name: "Profile", path: "/dashboard/teacher/profile", icon: Settings },
    ],
    student: [
      { name: "Home", path: "/dashboard/student", icon: LayoutDashboard },
      { name: "Academics", path: "/dashboard/student/academic-register", icon: BookOpen },
      { name: "Results", path: "/dashboard/student/semester-list", icon: FileText },
      { name: "Achievements", path: "/dashboard/student/achievement", icon: Award },
      { name: "Library", path: "/dashboard/student/reading-progress", icon: BookOpen },
      { name: "Fees", path: "/dashboard/student/ishthiraq", icon: DollarSign },
    ]
  };

  const items = NAV_ITEMS[role] || NAV_ITEMS.student;

  return (
    <div className="flex flex-col h-full py-6 px-4">
      {/* Brand Logo */}
      <div className={`flex items-center gap-3 mb-10 transition-all duration-300 ${isOpen ? "px-2" : "justify-center"}`}>
        <div className="w-10 h-10 rounded-xl bg-gradient-to-br from-primary-500 to-indigo-600 flex items-center justify-center shadow-lg shadow-primary-500/30 text-white font-display font-bold text-xl">
          U
        </div>
        {isOpen && (
          <motion.div 
            initial={{ opacity: 0, x: -10 }} 
            animate={{ opacity: 1, x: 0 }} 
            className="flex flex-col"
          >
            <span className="font-display font-bold text-lg text-slate-800 dark:text-white tracking-wide">
              UIA ACADEMICS
            </span>
            <span className="text-[10px] uppercase tracking-wider font-semibold text-slate-400">
              Management Suite
            </span>
          </motion.div>
        )}
      </div>

      {/* Navigation Links */}
      <nav className="flex-1 space-y-2">
        {items.map((item) => (
          <NavLink
            key={item.path}
            to={item.path}
            end={item.path.split('/').length > 3} // Exact match for sub-routes if needed
            className={({ isActive }) => `
              relative flex items-center gap-3 px-3 py-3 rounded-xl transition-all duration-300 group
              ${isActive 
                ? "bg-gradient-to-r from-primary-600 to-indigo-600 text-white shadow-lg shadow-primary-500/25" 
                : "text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 hover:text-primary-600 dark:hover:text-primary-400"
              }
            `}
          >
            {({ isActive }) => (
              <>
                <item.icon size={22} strokeWidth={isActive ? 2 : 1.5} className="flex-shrink-0" />
                
                {isOpen && (
                  <motion.span 
                    initial={{ opacity: 0 }}
                    animate={{ opacity: 1 }}
                    className="font-medium whitespace-nowrap"
                  >
                    {item.name}
                  </motion.span>
                )}

                {/* Active Indicator Dot */}
                {!isOpen && isActive && (
                  <div className="absolute right-2 w-1.5 h-1.5 rounded-full bg-white shadow-sm" />
                )}
              </>
            )}
          </NavLink>
        ))}
      </nav>

      {/* Footer / Toggle */}
      <div className="mt-auto pt-6 border-t border-slate-200 dark:border-slate-700/50 space-y-4">
        <button
          onClick={logout}
          className={`flex items-center gap-3 px-3 py-3 rounded-xl text-rose-500 hover:bg-rose-50 dark:hover:bg-rose-900/10 transition-colors w-full ${!isOpen && "justify-center"}`}
        >
          <LogOut size={20} />
          {isOpen && <span className="font-medium">Logout</span>}
        </button>

        <button
          onClick={toggle}
          className="w-full flex items-center justify-center p-2 rounded-lg bg-slate-100 dark:bg-slate-800 text-slate-500 hover:text-primary-600 transition-colors"
        >
          {isOpen ? <ChevronLeft size={18} /> : <ChevronRight size={18} />}
        </button>
      </div>
    </div>
  );
};

export default Sidebar;

================
File: backend/README.md
================
# School Management App - Backend

This is the **backend** of the School Management Application built with **Node.js**, **Express.js**, and **MongoDB**. It handles all API endpoints, authentication, database interactions, and real-time communication using **Socket.io**.

## üîß Tech Stack

- **Node.js**
- **Express.js**
- **MongoDB** with Mongoose
- **Socket.io** - Real-time communication
- **JWT** - Authentication
- **Cloudinary** - Image uploads
- **Google Sheets API** - External integration

## üì¶ Installation

cd backend
npm install

üöÄ Running the Server

npm run dev

 Environment Variables
Create a .env file in the backend/ directory with the following:

env
Copy
Edit
MONGODB_URI=your_mongo_connection_string
PORT=5000
JWT_SECRET=your_jwt_secret
NODE_ENV=development

# Cloudinary Config
CLOUDINARY_CLOUD_NAME=your_cloud_name
CLOUDINARY_API_KEY=your_api_key
CLOUDINARY_API_SECRET=your_api_secret

# Google Service Account
GOOGLE_SERVICE_ACCOUNT_EMAIL=your_service_account_email
GOOGLE_PRIVATE_KEY="your_private_key_with_newlines_escaped"

================
File: backend/src/helper/userHelper.js
================
const db = require('../config/connection');
const collections = require('../config/collection');
module.exports = {
     addUser : (data) => {
        return new Promise(async (resolve, reject) => {
          data.selectedBatch = parseInt(data.selectedBatch, 10);
          data.rollNumber = parseInt(data.rollNumber, 10);
  
          try {
            let user = await db.get().collection(collections.USER_COLLECTION).findOne({studentId: data.studentId});
            if(user){
                throw new Error("This student is already registered.")
            }
            let result = await db.get().collection(collections.USER_COLLECTION).insertOne(data);
      
            resolve({ success: true, message: "Student registered successfully", insertedId: result.insertedId });
          } catch (error) {
            reject({ success: false, error: error.message });
          }
        });
      },
    apdateUser:()=>{
        return new Promise((resolve,reject)=>{

        })
    },
    deleteUser:()=>{
        return new Promise((resolve,reject)=>{

        })
    },
    getUser:()=>{
        return new Promise(async(resolve,reject)=>{
        try {
          let users = await db.get().collection(collections.USER_COLLECTION).find().sort({selectedBatch: 1, rollNumber: 1, division: 1}).toArray();
          if(users){
            resolve(users);
          }
        } catch (error) {
          reject(error);
        }
        })
    }
}

================
File: backend/src/lib/cloudinary.js
================
import { v2 as cloudinary } from 'cloudinary';
import {config} from "dotenv";

config();

cloudinary.config({ 
    cloud_name: process.env.CLOUDINARY_CLOUD_NAME,
    api_key: process.env.CLOUDINARY_API_KEY, 
    api_secret: process.env.CLOUDINARY_API_SECRET
});

export default cloudinary;

================
File: backend/src/lib/db.js
================
import mongoose from "mongoose"

export const connectDB = async ()=>{
    try {
        const conn = await mongoose.connect(process.env.MONGODB_URI);
        console.log(`mongodb connected ${conn.connection.host}`);
        
    } catch (error) {
        console.log("mongodb connection error" + error);
        
    }
}

================
File: backend/src/lib/socket.js
================
// import { Server } from "socket.io";
// import http from "http";
// import express from "express";

// const app = express();
// const server = http.createServer(app);

// const io = new Server(server, {
//   cors: {
//     origin: ["http://localhost:5173"],
//   },
// });

// export function getReceiverSocketId(userId) {
//   return userSocketMap[userId];
// }

// // used to store online users
// const userSocketMap = {}; // {userId: socketId}

// io.on("connection", (socket) => {
//   console.log("A user connected", socket.id);

//   const userId = socket.handshake.query.userId;
//   if (userId) userSocketMap[userId] = socket.id;

//   // io.emit() is used to send events to all the connected clients
//   io.emit("getOnlineUsers", Object.keys(userSocketMap));

//   socket.on("disconnect", () => {
//     console.log("A user disconnected", socket.id);
//     delete userSocketMap[userId];
//     io.emit("getOnlineUsers", Object.keys(userSocketMap));
//   });
// });

// export { io, app, server };

================
File: backend/src/models/achivement.model.js
================
import mongoose from "mongoose";

const achivementSchema = new mongoose.Schema(
  {
  studentId: {
    type: mongoose.Schema.Types.ObjectId,
    required: true,
    ref: "Student"
  },
  batchId: {
    type: mongoose.Schema.Types.ObjectId,
    ref: "Batch"
  },
  achievedItem: {
    type: String,
    required: true
  },
  agencyLevel: {
    type: String
  },
  placeOrRank: {
    type: String
  },
  gradeOrPercentage: {
    type: String
  },
  monthAndYear: {
    type: String 
  },
  approval: {
    type: Boolean,
    default: false
  },
  remarks: {
    type: String
  }
}, {
  timestamps: true
});

export default mongoose.model("Achivement", achivementSchema);

================
File: backend/src/models/artsemester.model.js
================
import mongoose from "mongoose";

const semesterSchema = new mongoose.Schema(
  {
    name: {
      type: String,
      required: true,
      trim: true,
    },
    subjects: [
      {
        type: mongoose.Schema.Types.ObjectId,
        ref: "ArtSubject",
      }
    ]
  },
  { timestamps: true }
);

export default mongoose.model("ArtSemester", semesterSchema);

================
File: backend/src/models/artsubject.model.js
================
import mongoose from "mongoose";
import ArtSemester from "./artsemester.model.js";

const artSubjectSchema = new mongoose.Schema(
  {
    name: {
      type: String,
      required: true,
      trim: true,
    },
    mark: {
      type: Number,
      required: true
    },
    CEmark: {
     type: Boolean,
     default: false
    },
    code: {
      type: String,
      uppercase: true,
    },
    artSemester: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "ArtSemester",
      required: true, 
    },
    subTeacher: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "Staff",
    },
    subTeacher2: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "Staff",
    },
    periodTeacher1: {
      type: Number,
    },
    periodTeacher2: {
      type: Number,
    },
    description: {
      type: String,
      trim: true,
    },
  },
  { timestamps: true }
);

artSubjectSchema.pre("save", async function (next) {
  if (!this.code) {
    try {
      const semesterId = this.artSemester;  
      const semester = await ArtSemester.findById(semesterId); 
      if (!semester) {
        throw new Error("Semester not found");
      }

      const namePart = this.name.substring(0, 4).toUpperCase();
      const semesterSufix = semester.name.charAt(semester.name.length - 1); 

      const lastSubject = await mongoose
        .model("ArtSubject")
        .findOne({ code: new RegExp(`^${namePart}\\d{3}$`, "i") })
        .sort({ createdAt: -1 });

      let nextNumber = 10;
      if (lastSubject && lastSubject.code) {
        const lastNumber = parseInt(lastSubject.code.match(/\d+$/), 10);
        if (!isNaN(lastNumber)) {
          nextNumber = lastNumber + 1;
        }
      }

      this.code = `${namePart}${nextNumber}${semesterSufix}`;
    } catch (error) {
      return next(error); 
    }
  }
  next();
});

export default mongoose.model("ArtSubject", artSubjectSchema);

================
File: backend/src/models/book.model.js
================
import mongoose from "mongoose";

const BookSchema = new mongoose.Schema({
  title: { type: String, required: true },
  bookNumber: { type: Number, required: true, unique: true },
  author: { type: String, required: true },
  status: { type: String, default: "available" },
  borrowedBy: { type: String, default: null },
  studentName: { type: String, default: null },
  dueDate: { type: Date, default: null },
});

export default mongoose.model("Book", BookSchema);

================
File: backend/src/models/fees.model.js
================
import mongoose from 'mongoose';

const feeSchema = new mongoose.Schema({
  studentId: { 
    type: mongoose.Schema.Types.ObjectId,
    ref: 'Student',
    required: true
  },
  batchId: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'Batch',
    required: true
  },
  month: {
    type: String,
    required: true,
    enum: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", 
           "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]
  },
  paid: {
    type: Boolean,
    default: false
  },
  updatedAt: {
    type: Date,
    default: Date.now
  }
});

export default mongoose.model('Fee', feeSchema);

================
File: backend/src/models/marklist.model.js
================
import mongoose, { Schema } from "mongoose";

const markListSchema = new Schema({
    studentId: {
      type: Schema.Types.ObjectId,
      ref: 'Student', 
      required: true 
    },
    batchId: { 
      type: Schema.Types.ObjectId, 
      ref: 'Batch', 
      required: true 
    },
    semesterId: {
       type: Schema.Types.ObjectId, 
       ref: 'Semester', 
       required: true 
    },
    cicNumber: {
      type: Number,
      required: true
    },
    subjects: [],
    isApproved: {
      type: Boolean,
      default: false
    },
    isEditable: {
      type: Boolean,
      default: true
    },
    editingStatus: {
      type: String,
      enum: ["send", "allow", "disable"], 
      default: "disable"
    }
    

  },
  { timestamps: true }
);
  
  markListSchema.index({ cicNumber: 1 });
  
  export default mongoose.model('Marklist', markListSchema);

================
File: backend/src/models/mng.model.js
================
import mongoose from "mongoose";

const configSchema = new mongoose.Schema(
    {
        period: {
            type: Number,
        },
    },
    { timestamps: true } 
);

export default mongoose.model("Config", configSchema);

================
File: backend/src/models/readingProgress.model.js
================
import mongoose from "mongoose";

const readingProgressSchema = new mongoose.Schema({
  studentId: {
    type: mongoose.Schema.Types.ObjectId,
    ref: "Student",
    required: true
  },
  batchId: {
    type: mongoose.Schema.Types.ObjectId,
    ref: "Batch",
  },
  bookName: {
    type: String,
    required: true
  },
  authorName: {
    type: String
  },
  publisher: {
    type: String
  },
  numberOfPages: {
    type: Number
  },
  monthAndYear: {
    type: String
  },
  approval: {
    type: Boolean,
    default: false
  },
  remarks: {
    type: String
  }
}, {
  timestamps: true
});

export default mongoose.model("ReadingProgress", readingProgressSchema);

================
File: backend/src/models/registeredUser.model.js
================
import mongoose from "mongoose";

const RegisteredUserSchema = new mongoose.Schema(
  {
    studentName: {
      type: String,
      required: true,
      trim: true,
    },
    phoneNumber: {
      type: String,
      required: true,
      trim: true,
    },
    password: {
      type: String,
      required: true,
    },
    selectedBatch: {
      type: String,
      required: true,
    },
    classId: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "Batch"
    },
    gender: {
      type: String,
      enum: ['Male', 'Female'],
      required: true,
    },
    dateOfBirth: {
      type: Date,
      required: true,
    },
    profileImage: {
      type: String,
      default: '',
    },
    isSelected: {
      type: Boolean,
      default: false,
    }
  },
  { timestamps: true } 
);

RegisteredUserSchema.index({ selectedBatch: 1 });

export default mongoose.model('RegisteredUser', RegisteredUserSchema);

================
File: backend/src/models/semester.model.js
================
import mongoose from "mongoose";

const semesterSchema = new mongoose.Schema(
  {
    name: {
      type: String,
      required: true,
      trim: true,
    },
    subjects: [
      {
        type: mongoose.Schema.Types.ObjectId,
        ref: "Subject",
      }
    ]
  },
  { timestamps: true }
);

export default mongoose.model("Semester", semesterSchema);

================
File: backend/src/models/staff.model.js
================
import mongoose from "mongoose";

const staffSchema = new mongoose.Schema(
    {
        name: {
            type: String,
            required: true,
            trim: true,
        },
        userName: {
            type: String,
            required: true,
            trim: true,
        },
        phoneNumber: {
            type: String,
            trim: true,
        },
        password: {
            type: String,
            required: true,
        },  
        role: {
            type: String,
            enum: ["teacher", "admin"],
        },
        profileImage: {
            type: String,
            default: '',
          },
        subjects: [
            {
              type: mongoose.Schema.Types.ObjectId,
              ref: "Subject",
            },
          ],
    },
    { timestamps: true } 
);

export default mongoose.model("Staff", staffSchema);

================
File: backend/src/models/transaction.model.js
================
import mongoose from "mongoose";

const TransactionSchema = new mongoose.Schema({
  bookId: { type: mongoose.Schema.Types.ObjectId, ref: "Book", required: true },
  bookNumber: { type: Number, required: true },
  borrowDate: { type: Date, required: true },
  dueDate: { type: Date, required: true },
  studentId: { type: String, required: true },
  returned: { type: Boolean, default: false },
  returnDate: { type: Date, default: null },
});

export default mongoose.model("Transaction", TransactionSchema);

================
File: backend/src/routes/admission.route.js
================
import express from "express";
import { getRegisteredStudents, newAdmission, selected } from "../controllers/admissionController.js";

const router = express.Router();

router.post('/', newAdmission);

router.get('/', getRegisteredStudents);

router.post('/selected', selected);


export default router;

================
File: backend/src/routes/auth.route.js
================
import express from "express"
import { protectRoute } from "../middleware/auth.middleware.js";
import { checkAuth, fetchGoogleSheetData, login, logout, signup } from "../controllers/auth.controller.js";

const router = express.Router();

router.post("/signup", signup);

router.post("/login", login);

router.post("/logout", logout);

router.get("/check", protectRoute, checkAuth);

router.get("/google", fetchGoogleSheetData);

export default router;

================
File: backend/src/routes/book.route.js
================
import express from "express";
import { updateBook, deleteBook, addBook, getBooks } from "../controllers/bookController.js";

const router = express.Router();

router.get("/", getBooks)

router.post("/add", addBook);

router.put("/update/:bookId", updateBook); 

router.delete("/delete/:bookId", deleteBook); 

export default router;


// // Get all books
// router.get('/',bookController.getBooks );

// // Add  book form
// router.get('/add-book', bookController.addBookForm); 

// // Add a new book
// router.post('/add-book', bookController.addBook);

// // Update a book form
// router.get('/:id', bookController.updateBookForm );

// // Update a book
// router.put('/:id', bookController.updateBook );

// // Delete a book
// router.delete('/:id', bookController.deleteBook );

================
File: backend/src/routes/records.route.js
================
import express from "express";
import { addRecord, deleteRecord, editRecord, getRecords } from "../controllers/recordController.js";

const router = express.Router();

router.post('/', addRecord);

router.get('/', getRecords);

router.put('/:id', editRecord);

router.delete('/:id', deleteRecord);

export default router;

================
File: frontend/eslint.config.js
================
import js from '@eslint/js'
import globals from 'globals'
import react from 'eslint-plugin-react'
import reactHooks from 'eslint-plugin-react-hooks'
import reactRefresh from 'eslint-plugin-react-refresh'

export default [
  { ignores: ['dist'] },
  {
    files: ['**/*.{js,jsx}'],
    languageOptions: {
      ecmaVersion: 2020,
      globals: globals.browser,
      parserOptions: {
        ecmaVersion: 'latest',
        ecmaFeatures: { jsx: true },
        sourceType: 'module',
      },
    },
    settings: { react: { version: '18.3' } },
    plugins: {
      react,
      'react-hooks': reactHooks,
      'react-refresh': reactRefresh,
    },
    rules: {
      ...js.configs.recommended.rules,
      ...react.configs.recommended.rules,
      ...react.configs['jsx-runtime'].rules,
      ...reactHooks.configs.recommended.rules,
      'react/jsx-no-target-blank': 'off',
      'react-refresh/only-export-components': [
        'warn',
        { allowConstantExport: true },
      ],
    },
  },
]

================
File: frontend/postcss.config.js
================
export default {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
}

================
File: frontend/public/favicon.svg
================
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="267" height="458" viewBox="0 0 267 458"><image width="267" height="458" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQsAAAHKCAYAAAAU4W5DAAAACXBIWXMAACxKAAAsSgF3enRNAAAS1klEQVR4nO3dPXLcxtqG4UdfKZd2IJ4VmA4YcxwdIpIC5IRWIGoFglYgegUC86kyFYGZZtLDwMMVnOEOzBX4BOj5BFP8ecnB4O1u3FeVyz+s0rQt+mZ3owG8+PvvvwXc5bI52juoLtbe40Ac/s97AIjTZXP0TtKJ9zgQD2KB+5xIqrwHgXgQC/zksjmaSTqU9OqyOap8R4NYvGDPAn2XzdFrSStJb8I/upG0d1Bd/OU3KsSAmQVua/QjFJL0StKpz1AQE2KB/3fZHDWS3t7xpWOWI2AZgs3So9Hdoej7eFBdMMuYKGIxcWEzs9E/lx4PWUqqOH8xPcRigsJM4p26S6OHz/xllpLOJS0OqovVQENDxIjFRFw2R3vqAjHT48uNp7qRtAh/rA6qi8XAvz4iQCwyFeIw6/1hXWYMZakQEOKRB2KRicvmaF/Svvzi8BjikThikaCw59APw7668xApIR6JIRYJCLOGmboo7Ev6xXVAu0E8IkcsIhP2GvpxeO7VitRxtSUyxMJZb9YwUxeH2PYaYnCtbtaxiQf3qTggFiO7dQlzpvT2GmLwTV04zgnHeIjFCHqBqJTnfoOnb5Kag+ri3HsguSMWOxSOUleSjn1HMgnX6u6ObZht7Aax2IFwh2Yt9h883Ki71+WU+1eGRSwGEs4+bB5FRyTicCapJhrDIBZb6kXiRGxWxopoDIBYPBORSNKZpBP2NJ6HWDzDZXN0om5Pgkik50bdRugp0XgaYvEE4V0ap2JPIgfX6pYmjfdAUkEsDMIpy1NN9+h1zpbqliYcKX8EsXhA2JeoJX1wHgp273d1Mw2WJvcgFvcIS45G7EtMyY2654tyGvQOxOKWJzzpGvn6pi4azDJ6eG9IT5hNrEUopu6tpHX4fkDAzELMJvAgZhnB5GcW4WavlQgF7vZW0ip8n0zapGNx2RzVkr6LcxN42BtJ38P3y2RNchkSlh3n4twEnm4p6d0UlyWTm1mEA1YrEQo8z6G6zc+Z90DGNqlYhOdMLMSyA9t5pW5ZcuI9kDFNZhly2RydipOYGN7ZQXVReQ9iDNnHIuxPnIpH211J+kvdEmyz3u7/tdW+pNe3/jrFlxwN6UrSLPd9jKxjEUKx0LQekrtUF4F1+PNqrG/isB+0px8vQ5rSqw2u1W18ZntDWraxmEgoNu/TWCnSl/Hc8arFnDeWb9TNMKL7fRhClrEIP+HOld9PtRv982U7a9fRPFO4krB5d0puMb9Rd8t74z2QoWUXixCKhfJZQ9/oxwt1srsbMuN3qrzPLRhZxSKzUJwp00DcJ8NwZBWMbGKRSSiu1F25mfxr+cLv54m6eKT8e5pNMLKIRQahOFP3ANksN8a2ETZI3yntlzZlEYzkY5FwKDZ7EbzPwiicwK2U5hWV5IORdCwSvTzKo+i3FK6m1EovGkkHI9lYJBoK3ow1oERfzZBsMFKOxULp/GRZqnva0tp7IDkKy5NTpbMU/TXF/akkY3HZHDVK416Pa3WRWHgPJHeJvbYhyZOeycUi3Bb8xXscBp8PqovaexBTEza8G8W/PL2WtJ/SvlVSsQhr1D+8x/EI3nAVgUTeR3t1UF3sew/CKplYJHKJ9ONBdXHqPQh0wonQRnHvbSXzPIwkYpHAlY8rdXsTzCYiFB60+8l7HA9I4odMKo/VaxRvKM6U4GbVlIS9o1/V7RPE6EsKz/SMfmYR8U+FbG9FzlXkL5O6kbQX84Zn1LEItf3uPY47sOxIWMQ/gJYH1cXMexD3iXYZ0vspEJulWHYkLSxL3qv7aR6Tw5hfZBTtzOKyOTpXfNPFZHau8biIr7BFecIzyplFOL4bWyg+Eoq8hP8h99QtK2NyHmbWUYkuFuHaeGyXkd6ncGkLTxc2FGeKKxhv1B0oi0p0sVC3TxHTtDDZuwRh0wvG0nkofR9iu5wa1Z5FZPd93Ki74jGZZ2AiupsUo7p/JJqZRVh+1M7D6JsRiukJ+1Jn3uMIolqORBMLxfU8gvcx7kZjHCEYsSxJolmORBGLcDdpLFc/2KOA1D0kOJZNzyg2191j0XtxcQwIBSRFd5Xkl7Cf58o9FureDRHDMxR/JxTo6wUjhpOetffZC9dYhE1N92KqO5kZwzgQmYiC8UrOM3DvmUUt/03NK8URLEQqbHZX3uOQdBx+wLpwi0U4l+99PXvz4NQormMjXuEy+mfvccjx5krPmUUMm5qEAmbhbtVvzsM49LqU6hKL8C/r/VzEj5ylwDNU8n/iVu3xoV4zi9rpcze+cWMYniPMRN85D8NldjF6LCKYVdwojs0qJCrMSD86D6Me+wM9Zha1w2f2vWOfAtsKM1PPI+Gjzy5GjUUEs4rfeZUgBlTJ9/xFPeaHjT2z8DzPcC3/WQ0yEl50XTsOYdTZxWixCIdJPG8Wq1h+YGgRLEeqsT5ozJlFPeJn3faN5Qd2qHL87NFOdY4Si3ADjNflJq5+YKfCcsTzdOcoy/uxZhaV/O4BqVl+YASn8jusVY3xIS/+8/XfteJ8O9MQrg+qiz3vQWAawissvnqPY1e87zrdNe4mxWjC81BieRzf4HKOxZIH7sJB7T2AXck5FrX3ADA94apblrOLXGOx5FIpHNXeA9iFXGNRew8A05Xr7CLHWDCrQAxq7wEMLcdY8JyKLZRF8bositOyKLyf2ZC0HGcXL70HMLBrroA8T1kUr9Vdaj5Rd4DuQ1kUS0n1vG0XnmNLWCP/J8INJreZRe09gBSVRXEiaa3ucF7/pO2hpO9lUSzKotj3GFvKwrkL70fwDSanWNxIYlbxBGVRVGVRrNW9uf6h4/iHkv4si6Ipi2JvjLFlpPEewFByisU594DYlEUxC5H4qqe9De5Y0n9DNFzfjpWQxnsAQ8kpFmxsPiJEYiHpu7Z7ZeSxpHVZFDXReFi4I9X79QGDyCUW1zzW/35lUez3IjHUhtsrdXscRONxjfcAhpBLLJhV3KEsir2yKBpJf2p3u/KbaKzKoqh29BlJC1fovN+VurVcYsHGZk84K9FI+q/Ge0XkG0lfy6JYE407Jf89mkMsrsK6cPJCJGp1l0G93iO7icaiLIqZ0xhiRCwi0HgPIAa9SNw+K+Glf0Zj5j0YbzksRXI4wZl8sbcRpvy1tru6sUubaJypOw26dh6Pp3P5zfi2lvrM4nqqS5DegaqnnpXw0j+jsec9GCdJ/2BLfWaR9H/85whT+lrp3nNwLOm4LIrPkk7nbTulg3QL7wFsI/WZxcJ7AGO5daAq1VD0Te6MRjhhfOU9juciFpHrnZXIJRJ9/YNdlfNYxpLsbDjlWFzlfC9ILxJjnpXw8krTOaOx8B7Ac6Uci4X3AHahd1ZipfwjcdvmjMYq18utKT/FLeUNzoX3AIZ0x8NnpuwXdZdbc334zpW6f8ekpDyzyObGsTD1XiueA1Wx2JzROM/scmuS37seM4srSVvvNeRwviKBA1WxeCvpbUYHuxaS9gb4dfY04veOx7tOf0t53TaEsB4/VYJT0Uj8ri4a2W5wW1w2R7VG/H835T2L5GRwoCoWHyRVZVGcanoHu9ykvGeRjHAZ9Fx5npXw0j+jwQuwR8DMYofCplyt6V0CHdMrSV9CMOp52zbO48kWsdiB3mXQMfeCpm5zRqOWVGV4udUdsRgQZyWi8EZ5n9Fww57FQB54UQ988IKkgTGz2FJ4J+ipOCsRq80Lks4knXDl5PmYWWzvRIQiBceSmGFsgVgAMCEWuEs2L/PFcIgF+q4lvZ+37Z6kf0k68x0OYkIsIHWPqP8saX9zqGnetut521aSfpW09BsaYsHVkGm7UXcl5977K+Ztu5I0474WEIvpetLt3uFw04xLxdNFLKZnq2dCzNv2XNI5z+KYHmIxHUt1h5IGeUpT2NtoNjdwiVOr2WODM39LSb/N23Y2VCj65m17qu6JTZ+V+Ls88TBmFvm6VjeT2Pl7KsLmaB0eRlOrezgNMkMs8nMtp+c6hGic9KLBczwyQizycaPuEmjtPZCweVqFZ0s04nJrFtizSN/mQNVeDKHoCwe7ZpJ+Ewe7ksfMIm1JPOW6d0Zjpm6mweXWBBGLNCX5/owQjT3OaKSJWKTnX6lF4rbeGY1GbIImgz2LxKQeilvW3gOAHbEAYEIsAJgQCwAmxAKACbEAYJJMLMqi2A/Hh4EspPY9nUwsJL2W9Cm8Yeq192CAbYSDaQtJM9eBPEFKsdg4lLQOR4eBpJRF8bosinNJX5XYA4NSjIXU/Uf+ntIUDgjvXF1Jeus9ludINRYbn8qiOGdZgtiFxw/+qYTvh0k9FlJX6RVvykaMesuOL95j2VYOsZC6Wv8Z6g1EIeyrrZXosuO2XGKx8YVlCWIQ9tO+K7FNzIfkFgupq/iCZQk8hGXHQtIn77EMLcdYSNIv6oJReQ8E0xHe1rZWps8czTUWUjf9+1oWRcOyBLsWnmj+hzJadtyWcyw2jsWyBDtSFsVeWRQrTeBdKVOIhcSyBDsQlh0rdd9f2ZtKLKQfy5JT74EgbWETs1Hmy47bphSLjQ9lUazKotjzHgjSE5azC03wQcNTjIXUTRtXYRoJmPTuFJ3EsuO2qcZC6qaPf7AswWNSvlN0SFOOxcYHnpGB+6R+p+iQiEWHZ2TgJzncKTokYvEDz8iApLzuFB0SsfgZj+7DWiw7fkIs7nYoidvdp2uym5gPIRYATIgFABNiAcCEWAAwIRYATIgFABNiAcCEWAAwIRYATIgFABNiAcCEWAAwIRYATIgFABNiAcCEWAAweek9ADxNZo/9m3kPAHbEIj2fvAeAaWIZAsCEWAAwIRYATIgFABNiAcCEWAAwIRYATIgFABNiAcCEWAAwIRYATIgFABNiAcCEWAAwIRYATIgFABNiAcCEWAAwIRYATIgFABNiAcCEWAAwIRYATIgFABNiAcCEWAAw4fWF6fnsPYABzSQdeg8CNsQiMfO2rb3HMJTwkmdikQiWIQBMiAUAE2IBwIRYADAhFgBMiAUAE2IBwIRYADAhFgBMOMGZubIo/h7x4z7ndMIU/8TMAoAJsQBgQiwAmBALACbEAoAJsQBgQiwAmBALACbEAoAJsQBgQiwAmBALACbEAoAJsQBgQiwAmBALACbEAoAJsQBgQiwAmBALACbEAoAJsQBgQiwAmBALACbEAoAJsQBgQiwAmBALACbEAoAJsQBg8tJ7ANitedu+8B4D8sDMAoAJsQBgQiwAmBALACbEAoAJsQBgQiwAmBALACYcyspcWRT1iB+3mLftYsTPw4iIRf4+jfx5i5E/DyNhGQLAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHAhFgAMCEWAEyIBQATYgHA5KX3AFI3b9uZ9xgeMm/bF95juM+8bWtJtfMwYMTMAoAJsQBgQiwAmBALACbEAoAJsQBgQiwAmBALACYcyrrfp7IoPnkPAogFMwsAJsQCgAmxAGBCLACYEAsAJsQCgAmxAGBCLACYEAsAJsQCgAmxAGBCLACYEAsAJsQCgAmxAGBCLACYEAsAJsQCgAmxAGBCLACYEAsAJsQCgAmxAGBCLACYEAsAJsQCgElKry/8S9LSexDAwFbeA7BKJhbztl1JmnmPA5gqliEATIgFABNiAcCEWAAwIRYATIgFABNiAcCEWAAwIRYATIgFABNiAcCEWAAwIRYATIgFABNiAcCEWAAwIRYATIgFABNiAcCEWAAwIRYATIgFABOPVwF8v2yOHD42KcuD6mJ21xfKolhIOhxpHL/N23bR++xa0qeRPvvzvG3ru75w2RyNOQ4EzCwAmBALACbEAoAJsQBgQiwAmBALACbEAoAJsQBgQiwAmBALACbEAoAJsQBgQiwAmBALACbEAoAJsQBgQiwAmBALACbEAoAJsQBgQiwAmBALACbEAoAJsQBgQiwAmBALACYvJS28B4GfrB/4WqPxfs/Wt/5+rM997LMe+hp25H+V1oK3+OFmkwAAAABJRU5ErkJggg=="></image><style>@media (prefers-color-scheme: light) { :root { filter: none; } }
@media (prefers-color-scheme: dark) { :root { filter: none; } }
</style></svg>

================
File: frontend/README.md
================
# School Management App - Frontend

This is the **frontend** of the School Management Application built with **React.js (Vite)**, **Tailwind CSS**, **Zustand** for state management, and real-time UI features using **Framer Motion** and **Socket.io-client**.

## üîß Tech Stack

- **React.js (Vite)**
- **Tailwind CSS**
- **DaisyUI**
- **Zustand** - State Management
- **Framer Motion** - Animations
- **React Hot Toast & Toastify** - Notifications
- **Axios** - API calls

## üì¶ Installation

```bash
cd frontend
npm install


Running the App
npm run dev

================
File: frontend/src/assets/react.svg
================
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="35.93" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 228"><path fill="#00D8FF" d="M210.483 73.824a171.49 171.49 0 0 0-8.24-2.597c.465-1.9.893-3.777 1.273-5.621c6.238-30.281 2.16-54.676-11.769-62.708c-13.355-7.7-35.196.329-57.254 19.526a171.23 171.23 0 0 0-6.375 5.848a155.866 155.866 0 0 0-4.241-3.917C100.759 3.829 77.587-4.822 63.673 3.233C50.33 10.957 46.379 33.89 51.995 62.588a170.974 170.974 0 0 0 1.892 8.48c-3.28.932-6.445 1.924-9.474 2.98C17.309 83.498 0 98.307 0 113.668c0 15.865 18.582 31.778 46.812 41.427a145.52 145.52 0 0 0 6.921 2.165a167.467 167.467 0 0 0-2.01 9.138c-5.354 28.2-1.173 50.591 12.134 58.266c13.744 7.926 36.812-.22 59.273-19.855a145.567 145.567 0 0 0 5.342-4.923a168.064 168.064 0 0 0 6.92 6.314c21.758 18.722 43.246 26.282 56.54 18.586c13.731-7.949 18.194-32.003 12.4-61.268a145.016 145.016 0 0 0-1.535-6.842c1.62-.48 3.21-.974 4.76-1.488c29.348-9.723 48.443-25.443 48.443-41.52c0-15.417-17.868-30.326-45.517-39.844Zm-6.365 70.984c-1.4.463-2.836.91-4.3 1.345c-3.24-10.257-7.612-21.163-12.963-32.432c5.106-11 9.31-21.767 12.459-31.957c2.619.758 5.16 1.557 7.61 2.4c23.69 8.156 38.14 20.213 38.14 29.504c0 9.896-15.606 22.743-40.946 31.14Zm-10.514 20.834c2.562 12.94 2.927 24.64 1.23 33.787c-1.524 8.219-4.59 13.698-8.382 15.893c-8.067 4.67-25.32-1.4-43.927-17.412a156.726 156.726 0 0 1-6.437-5.87c7.214-7.889 14.423-17.06 21.459-27.246c12.376-1.098 24.068-2.894 34.671-5.345a134.17 134.17 0 0 1 1.386 6.193ZM87.276 214.515c-7.882 2.783-14.16 2.863-17.955.675c-8.075-4.657-11.432-22.636-6.853-46.752a156.923 156.923 0 0 1 1.869-8.499c10.486 2.32 22.093 3.988 34.498 4.994c7.084 9.967 14.501 19.128 21.976 27.15a134.668 134.668 0 0 1-4.877 4.492c-9.933 8.682-19.886 14.842-28.658 17.94ZM50.35 144.747c-12.483-4.267-22.792-9.812-29.858-15.863c-6.35-5.437-9.555-10.836-9.555-15.216c0-9.322 13.897-21.212 37.076-29.293c2.813-.98 5.757-1.905 8.812-2.773c3.204 10.42 7.406 21.315 12.477 32.332c-5.137 11.18-9.399 22.249-12.634 32.792a134.718 134.718 0 0 1-6.318-1.979Zm12.378-84.26c-4.811-24.587-1.616-43.134 6.425-47.789c8.564-4.958 27.502 2.111 47.463 19.835a144.318 144.318 0 0 1 3.841 3.545c-7.438 7.987-14.787 17.08-21.808 26.988c-12.04 1.116-23.565 2.908-34.161 5.309a160.342 160.342 0 0 1-1.76-7.887Zm110.427 27.268a347.8 347.8 0 0 0-7.785-12.803c8.168 1.033 15.994 2.404 23.343 4.08c-2.206 7.072-4.956 14.465-8.193 22.045a381.151 381.151 0 0 0-7.365-13.322Zm-45.032-43.861c5.044 5.465 10.096 11.566 15.065 18.186a322.04 322.04 0 0 0-30.257-.006c4.974-6.559 10.069-12.652 15.192-18.18ZM82.802 87.83a323.167 323.167 0 0 0-7.227 13.238c-3.184-7.553-5.909-14.98-8.134-22.152c7.304-1.634 15.093-2.97 23.209-3.984a321.524 321.524 0 0 0-7.848 12.897Zm8.081 65.352c-8.385-.936-16.291-2.203-23.593-3.793c2.26-7.3 5.045-14.885 8.298-22.6a321.187 321.187 0 0 0 7.257 13.246c2.594 4.48 5.28 8.868 8.038 13.147Zm37.542 31.03c-5.184-5.592-10.354-11.779-15.403-18.433c4.902.192 9.899.29 14.978.29c5.218 0 10.376-.117 15.453-.343c-4.985 6.774-10.018 12.97-15.028 18.486Zm52.198-57.817c3.422 7.8 6.306 15.345 8.596 22.52c-7.422 1.694-15.436 3.058-23.88 4.071a382.417 382.417 0 0 0 7.859-13.026a347.403 347.403 0 0 0 7.425-13.565Zm-16.898 8.101a358.557 358.557 0 0 1-12.281 19.815a329.4 329.4 0 0 1-23.444.823c-7.967 0-15.716-.248-23.178-.732a310.202 310.202 0 0 1-12.513-19.846h.001a307.41 307.41 0 0 1-10.923-20.627a310.278 310.278 0 0 1 10.89-20.637l-.001.001a307.318 307.318 0 0 1 12.413-19.761c7.613-.576 15.42-.876 23.31-.876H128c7.926 0 15.743.303 23.354.883a329.357 329.357 0 0 1 12.335 19.695a358.489 358.489 0 0 1 11.036 20.54a329.472 329.472 0 0 1-11 20.722Zm22.56-122.124c8.572 4.944 11.906 24.881 6.52 51.026c-.344 1.668-.73 3.367-1.15 5.09c-10.622-2.452-22.155-4.275-34.23-5.408c-7.034-10.017-14.323-19.124-21.64-27.008a160.789 160.789 0 0 1 5.888-5.4c18.9-16.447 36.564-22.941 44.612-18.3ZM128 90.808c12.625 0 22.86 10.235 22.86 22.86s-10.235 22.86-22.86 22.86s-22.86-10.235-22.86-22.86s10.235-22.86 22.86-22.86Z"></path></svg>

================
File: frontend/src/components/AdminCard.jsx
================
import React from "react";

export const Card = ({ children, className }) => {
  return (
    <div
      className={`relative bg-gradient-to-br from-sky-500 to-sky-700 rounded-3xl p-6 shadow-2xl text-white overflow-hidden transition-all duration-300 hover:scale-105 hover:shadow-blue-500/50 ${className}`}
    >
      <div className="absolute -top-10 -left-10 w-40 h-40 bg-sky-400 rounded-full opacity-30 blur-2xl"></div>
      <div className="absolute -bottom-10 -right-10 w-40 h-40 bg-sky-800 rounded-full opacity-20 blur-2xl"></div>
      
      {children}
    </div>
  );
};

export const CardContent = ({ children }) => {
  return (
    <div className="space-y-3 text-white text-base leading-relaxed z-10 relative">
      {children}
    </div>
  );
};

================
File: frontend/src/components/AdminEmptyState.jsx
================
"use client"

const AdminEmptyState = ({ searchTerm, hasAchievements, hasProgress }) => {
  if (searchTerm && (hasAchievements || hasProgress)) {
    return (
      <div className="flex flex-col items-center justify-center text-center p-12 min-h-96">
        <div className="w-32 h-32 bg-gradient-to-br from-indigo-100 to-purple-100 dark:from-blue-900/50 dark:to-purple-900/50 rounded-full flex items-center justify-center mb-6">
          <div className="text-4xl">üîç</div>
        </div>
        <h3 className="text-2xl font-bold mb-3 text-gray-700 dark:text-white">No results found</h3>
        <p className="text-lg max-w-md text-gray-600 dark:text-gray-300">
          We couldn't find any items matching your search criteria. Try adjusting your filters or search terms.
        </p>
      </div>
    )
  }

  return (
    <div className="flex flex-col items-center justify-center text-center p-12 min-h-96">
      <div className="w-32 h-32 bg-gradient-to-br from-indigo-100 to-purple-100 dark:from-blue-900/50 dark:to-purple-900/50 rounded-full flex items-center justify-center mb-6">
        <div className="text-4xl">üìã</div>
      </div>
      <h3 className="text-3xl font-bold mb-3 text-gray-700 dark:text-white">No Data Available</h3>
      <p className="text-lg mb-8 max-w-lg text-gray-600 dark:text-gray-300">
        There are no items to display at the moment. Students need to submit their data for review.
      </p>
    </div>
  )
}

export default AdminEmptyState

================
File: frontend/src/components/AdminInput.jsx
================
import React from "react";

const AdminInput = ({ className, ...props }) => {
  return (
    <input
      {...props}
      className={`w-full p-3 rounded-lg border focus:outline-none focus:ring-2 focus:ring-blue-500 
        bg-white text-gray-900 border-gray-300 
        dark:bg-gray-800 dark:text-white dark:border-gray-600
        ${className}`}
    />
  );
};

export default AdminInput;

================
File: frontend/src/components/BookTable.jsx
================
import React, { useState } from "react";
import { useThemeStore } from "../store/useThemeStore";
import { ChevronDown, ChevronUp } from "lucide-react";

const BookTable = ({ books }) => {
  const [expandedRows, setExpandedRows] = useState({});

  const toggleDetails = (bookNumber) => {
    setExpandedRows((prev) => ({
      ...prev,
      [bookNumber]: !prev[bookNumber],
    }));
  };

  return (
    <div className="w-full max-w-5xl bg-white dark:bg-gray-800 shadow-lg rounded-lg p-4">
      {/* TABLE VIEW (Larger Screens) */}
      <div className="hidden sm:block overflow-x-auto">
        <table className="table-auto w-full text-center border-collapse">
          <thead>
            <tr className="bg-green-600 dark:bg-green-700 text-white text-sm sm:text-base">
              <th className="py-3 px-4">Book No.</th>
              <th className="py-3 px-4">Title</th>
              <th className="py-3 px-4">Author</th>
              <th className="py-3 px-4">Price</th>
              <th className="py-3 px-4">Action</th>
            </tr>
          </thead>
          <tbody>
            {books.map((book) => (
              <React.Fragment key={book.bookNumber}>
                <tr
                  className={`transition-colors duration-300 text-sm ${
                    book.status === "borrowed"
                      ? "bg-green-100 dark:bg-gray-700"
                      : "bg-green-50 dark:bg-gray-900"
                  } hover:bg-green-200 dark:hover:bg-gray-600`}
                >
                  <td className="py-2 px-4 font-medium">{book.bookNumber}</td>
                  <td className="px-4 text-gray-900 dark:text-gray-200">{book.title}</td>
                  <td className="px-4 text-gray-900 dark:text-gray-200">{book.author}</td>
                  <td className="px-4 text-gray-900 dark:text-gray-200">${book.price}</td>
                  <td className="px-4">
                    <button
                      onClick={() => toggleDetails(book.bookNumber)}
                      className="flex items-center gap-1 bg-green-600 dark:bg-green-700 text-white px-3 py-1 rounded-lg hover:bg-green-700 dark:hover:bg-green-600 transition"
                    >
                      {expandedRows[book.bookNumber] ? <ChevronUp size={18} /> : <ChevronDown size={18} />}
                      Details
                    </button>
                  </td>
                </tr>
                {expandedRows[book.bookNumber] && (
                  <tr className="bg-gray-50 dark:bg-gray-700 transition-all duration-300">
                    <td colSpan="5" className="p-4 text-left text-sm text-gray-800 dark:text-gray-300">
                      <div className="space-y-2">
                        <p>
                          <strong>Status:</strong> {book.status}
                        </p>
                        <p>
                          <strong>Borrowed By:</strong> {book.borrowedBy}
                        </p>
                        <p>
                          <strong>Student Name:</strong> {book.studentName}
                        </p>
                        <p>
                          <strong>Due Date:</strong> {book.dueDate}
                        </p>
                      </div>
                    </td>
                  </tr>
                )}
              </React.Fragment>
            ))}
          </tbody>
        </table>
      </div>

      {/* MOBILE VIEW (Card Layout) */}
      <div className="sm:hidden">
        {books.map((book) => (
          <div
            key={book.bookNumber}
            className="mb-4 p-4 bg-green-50 dark:bg-gray-900 rounded-lg shadow-md transition hover:shadow-lg"
          >
            <div className="flex justify-between items-center">
              <h3 className="text-lg font-semibold text-gray-900 dark:text-white">{book.title}</h3>
              <button
                onClick={() => toggleDetails(book.bookNumber)}
                className="flex items-center text-green-600 dark:text-green-400"
              >
                {expandedRows[book.bookNumber] ? <ChevronUp size={18} /> : <ChevronDown size={18} />}
                <span className="ml-1 text-sm">Details</span>
              </button>
            </div>
            {expandedRows[book.bookNumber] && (
              <div className="mt-2 text-gray-800 dark:text-gray-300 space-y-2">
                <p>
                  <strong>Book No:</strong> {book.bookNumber}
                </p>
                <p>
                  <strong>Author:</strong> {book.author}
                </p>
                <p>
                  <strong>Price:</strong> ${book.price}
                </p>
                <p>
                  <strong>Status:</strong> {book.status}
                </p>
                {book.status === "borrowed" && (
                  <>
                    <p>
                      <strong>Borrowed By:</strong> {book.borrowedBy}
                    </p>
                    <p>
                      <strong>Student Name:</strong> {book.studentName}
                    </p>
                    <p>
                      <strong>Due Date:</strong> {book.dueDate}
                    </p>
                  </>
                )}
              </div>
            )}
          </div>
        ))}
      </div>
    </div>
  );
};

export default BookTable;

================
File: frontend/src/components/Button.jsx
================
import React from "react";

const Button = ({ children, className, ...props }) => {
  return (
    <button
      className={`px-4 py-2 rounded transition duration-300 ease-in-out ${className}`}
      {...props}
    >
      {children}
    </button>
  );
};

export default Button;

================
File: frontend/src/components/ChangePasswordModal.jsx
================
import React, { useState } from "react";
import { useAuthStore } from "../store/useAuthStore";

const ChangePasswordModal = ({ onClose }) => {
  const [currentPassword, setCurrentPassword] = useState("");
  const {changePassword} = useAuthStore()
  const [newPassword, setNewPassword] = useState("");
  const [confirmPassword, setConfirmPassword] = useState("");
  const [error, setError] = useState("");
  const [success, setSuccess] = useState("");

  const handleSubmit = () => {
    setError("");
    setSuccess("");

    // Basic check
    if (!currentPassword || !newPassword || !confirmPassword) {
      setError("Please fill in all fields.");
      return;
    }

      if (newPassword.length < 4) {
    setError("New password must be at least 4 characters long.");
    return;
  }

    if (newPassword !== confirmPassword) {
      setError("New passwords do not match.");
      return;
    }

    changePassword(currentPassword, newPassword);
  
    setCurrentPassword("");
    setNewPassword("");
    setConfirmPassword("");

    // Optionally close after delay:
    setTimeout(() => {
      onClose();
    }, 1500);
  };

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40">
      <div className="bg-white dark:bg-gray-900 rounded-2xl shadow-xl w-full max-w-md p-6">
        <h2 className="text-xl font-bold mb-4 text-gray-800 dark:text-white">Change Password</h2>

        <div className="space-y-4">
          <div>
            <label className="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1">
              Current Password
            </label>
            <input
              type="password"
              value={currentPassword}
              onChange={(e) => setCurrentPassword(e.target.value)}
              className="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-400 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-100"
              placeholder="Enter current password"
            />
          </div>
          <div>
            <label className="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1">
              New Password
            </label>
            <input
              type="password"
              value={newPassword}
              onChange={(e) => setNewPassword(e.target.value)}
              className="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-400 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-100"
              placeholder="Enter new password"
            />
          </div>
          <div>
            <label className="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1">
              Confirm New Password
            </label>
            <input
              type="password"
              value={confirmPassword}
              onChange={(e) => setConfirmPassword(e.target.value)}
              className="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-400 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-100"
              placeholder="Confirm new password"
            />
          </div>
          {error && (
            <p className="text-red-600 text-sm">{error}</p>
          )}
          {success && (
            <p className="text-green-600 text-sm">{success}</p>
          )}
        </div>

        <div className="flex justify-end mt-6 space-x-3">
          <button
            onClick={onClose}
            className="px-4 py-2 rounded-lg border border-gray-400 text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-800"
          >
            Cancel
          </button>
          <button
            onClick={handleSubmit}
            className="px-4 py-2 rounded-lg bg-sky-500 text-white hover:bg-sky-600 transition"
          >
            Update Password
          </button>
        </div>
      </div>
    </div>
  );
};

export default ChangePasswordModal;

================
File: frontend/src/components/ConfirmPopup.jsx
================
const ConfirmPopup = ({ isOpen, onClose, onConfirm, title = "Confirm", message }) => {
    if (!isOpen) return null;
  
    return (
      <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/40">
        <div className="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 w-[90%] max-w-sm">
          <h3 className="text-lg font-semibold text-gray-800 dark:text-white">{title}</h3>
          <p className="mt-2 text-sm text-gray-600 dark:text-gray-300">{message}</p>
          <div className="mt-6 flex justify-end gap-3">
            <button
              onClick={onClose}
              className="px-4 py-2 text-sm bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-white"
            >
              Cancel
            </button>
            <button
              onClick={() => {
                onConfirm();
                onClose();
              }}
              className="px-4 py-2 text-sm bg-red-600 hover:bg-red-700 text-white rounded"
            >
              Delete
            </button>
          </div>
        </div>
      </div>
    );
  };
  
  export default ConfirmPopup;

================
File: frontend/src/components/EmptyState.jsx
================
"use client"

const EmptyState = ({ onAddClick, hasAchievements, searchTerm }) => {
  if (searchTerm && hasAchievements) {
    return (
      <div className="flex flex-col items-center justify-center text-center p-12 min-h-96">
        <div className="w-32 h-32 bg-gradient-to-br from-indigo-100 to-purple-100 rounded-full flex items-center justify-center mb-6">
          <div className="text-4xl">üîç</div>
        </div>
        <h3 className="text-2xl font-bold text-gray-700 mb-3">No achievements found</h3>
        <p className="text-gray-600 text-lg max-w-md">
          We couldn't find any achievements matching your search criteria. Try adjusting your filters or search terms.
        </p>
      </div>
    )
  }

  return (
    <div className="flex flex-col items-center justify-center text-center p-12 min-h-96">
      <div className="w-32 h-32 bg-gradient-to-br from-indigo-100 to-purple-100 rounded-full flex items-center justify-center mb-6">
        <div className="text-4xl">üèÜ</div>
      </div>
      <h3 className="text-3xl font-bold text-gray-700 mb-3">Start Your Achievement Journey</h3>
      <p className="text-gray-600 text-lg mb-8 max-w-lg">
        Begin documenting your academic and extracurricular accomplishments. Every achievement, big or small, is worth
        celebrating!
      </p>
      <button
        onClick={onAddClick}
        className="group relative overflow-hidden bg-gradient-to-r from-indigo-500 to-purple-600 text-white px-8 py-4 rounded-2xl font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300"
      >
        <div className="absolute inset-0 bg-gradient-to-r from-purple-600 to-pink-600 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
        <div className="relative flex items-center gap-3">
          <div className="w-6 h-6 rounded-full bg-white/20 flex items-center justify-center">
            <span className="text-lg font-bold">+</span>
          </div>
          Add Your First Achievement
        </div>
      </button>
    </div>
  )
}

export default EmptyState

================
File: frontend/src/components/Footer.jsx
================
import { MdHome, MdLibraryBooks, MdPeople } from "react-icons/md";
import { Link } from "react-router-dom";

const Footer = () => {
  return (
    <footer className="fixed bottom-0 w-full bg-white/50 dark:bg-gray-800/50 backdrop-blur-md shadow-md flex justify-around py-4 rounded-t-2xl text-gray-800 dark:text-white">
      <Link
        to="/library"
        className="flex flex-col items-center hover:text-green-500 transition-colors duration-300"
      >
        <MdHome className="text-2xl transition-transform duration-300 hover:scale-110" />
        <span className="text-sm">Home</span>
      </Link>
      <Link
        to="/books"
        className="flex flex-col items-center hover:text-green-500 transition-colors duration-300"
      >
        <MdLibraryBooks className="text-2xl transition-transform duration-300 hover:scale-110" />
        <span className="text-sm">Books</span>
      </Link>
      <Link
        to="/users"
        className="flex flex-col items-center hover:text-green-500 transition-colors duration-300"
      >
        <MdPeople className="text-2xl transition-transform duration-300 hover:scale-110" />
        <span className="text-sm">Students</span>
      </Link>
    </footer>
  );
};

export default Footer;

================
File: frontend/src/components/LoadingSpinner.jsx
================
const LoadingSpinner = () => {
    return (
      <div className="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 flex justify-center items-center">
        <div className="flex flex-col items-center gap-6">
          <div className="relative">
            <div className="w-16 h-16 border-4 border-indigo-200 rounded-full animate-spin"></div>
            <div className="absolute top-0 left-0 w-16 h-16 border-4 border-transparent border-t-indigo-600 rounded-full animate-spin"></div>
          </div>
          <div className="text-center">
            <h3 className="text-xl font-semibold text-gray-700 mb-2">Loading Achievements</h3>
            <p className="text-gray-600">Please wait while we fetch your data...</p>
          </div>
        </div>
      </div>
    )
  }
  
  export default LoadingSpinner

================
File: frontend/src/components/ReadingEmptyState.jsx
================
"use client"

const ReadingEmptyState = ({ onAddClick, hasProgress, searchTerm }) => {
  if (searchTerm && hasProgress) {
    return (
      <div className="flex flex-col items-center justify-center text-center p-12 min-h-96">
        <div className="w-32 h-32 bg-gradient-to-br from-indigo-100 to-purple-100 dark:from-blue-900/50 dark:to-purple-900/50 rounded-full flex items-center justify-center mb-6">
          <div className="text-4xl">üîç</div>
        </div>
        <h3 className="text-2xl font-bold mb-3 text-gray-700 dark:text-white">No books found</h3>
        <p className="text-lg max-w-md text-gray-600 dark:text-gray-300">
          We couldn't find any books matching your search criteria. Try adjusting your filters or search terms.
        </p>
      </div>
    )
  }

  return (
    <div className="flex flex-col items-center justify-center text-center p-12 min-h-96">
      <div className="w-32 h-32 bg-gradient-to-br from-indigo-100 to-purple-100 dark:from-blue-900/50 dark:to-purple-900/50 rounded-full flex items-center justify-center mb-6">
        <div className="text-4xl">üìö</div>
      </div>
      <h3 className="text-3xl font-bold mb-3 text-gray-700 dark:text-white">Start Your Reading Journey</h3>
      <p className="text-lg mb-8 max-w-lg text-gray-600 dark:text-gray-300">
        Begin tracking your reading progress and build your personal library. Every book you read is a step towards
        knowledge and growth!
      </p>
      <button
        onClick={onAddClick}
        className="group relative overflow-hidden px-8 py-4 rounded-2xl font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 bg-gradient-to-r from-indigo-500 to-purple-600 dark:from-blue-600 dark:to-purple-700 text-white hover:from-purple-600 hover:to-pink-600 dark:hover:from-purple-600 dark:hover:to-pink-700"
      >
        <div className="relative flex items-center gap-3">
          <div className="w-6 h-6 rounded-full bg-white/20 flex items-center justify-center">
            <span className="text-lg font-bold">+</span>
          </div>
          Add Your First Book
        </div>
      </button>
    </div>
  )
}

export default ReadingEmptyState

================
File: frontend/src/components/ReadingProgressCard.jsx
================
"use client"

import { useState } from "react"
import { ChevronDown, ChevronUp, Calendar, BookOpen, FileText, Building2, Pencil } from "lucide-react"

const ReadingProgressCard = ({ progress, onEdit }) => {
  const [isExpanded, setIsExpanded] = useState(false)

  const toggleExpand = () => setIsExpanded(!isExpanded)

  const getStatusBadge = () => {
    return progress.approval ? (
      <div className="flex items-center gap-2 px-2 py-1 bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-300 rounded-full text-xs font-semibold">
        <div className="w-2 h-2 bg-green-500 rounded-full" />
        Approved
      </div>
    ) : (
      <div className="flex items-center gap-2 px-2 py-1 bg-amber-100 dark:bg-amber-900/40 text-amber-800 dark:text-amber-300 rounded-full text-xs font-semibold">
        <div className="w-2 h-2 bg-amber-500 rounded-full animate-pulse" />
        Pending
      </div>
    )
  }

  return (
    <div className="bg-white/80 dark:bg-gray-800/80 rounded-2xl p-4 shadow-md border border-gray-200 dark:border-gray-700 hover:shadow-lg transition-all">
      {/* Header */}
      <div className="flex justify-between items-start gap-4">
        <div className="flex-1">
          <h3 className="text-lg font-bold text-gray-800 dark:text-white">{progress.bookName}</h3>
          {progress.authorName && (
            <p className="text-sm text-gray-600 dark:text-gray-300">by {progress.authorName}</p>
          )}
        </div>
        <div className="flex flex-col items-end gap-1">
          {getStatusBadge()}
          <button
            onClick={toggleExpand}
            className="text-gray-500 hover:text-indigo-600 dark:text-gray-300 dark:hover:text-indigo-400 transition"
          >
            {isExpanded ? <ChevronUp size={18} /> : <ChevronDown size={18} />}
          </button>
        </div>
      </div>

      {/* Expandable Section */}
      {isExpanded && (
        <div className="mt-4 space-y-3 text-sm text-gray-700 dark:text-gray-300">
          {progress.publisher && (
            <div className="flex items-center gap-2">
              <Building2 size={16} className="text-purple-500 dark:text-purple-300" />
              <span className="font-medium">Publisher:</span>
              <span>{progress.publisher}</span>
            </div>
          )}
          {progress.numberOfPages && (
            <div className="flex items-center gap-2">
              <BookOpen size={16} className="text-green-500 dark:text-green-300" />
              <span className="font-medium">Pages:</span>
              <span>{progress.numberOfPages}</span>
            </div>
          )}
          {progress.monthAndYear && (
            <div className="flex items-center gap-2">
              <Calendar size={16} className="text-blue-500 dark:text-blue-300" />
              <span className="font-medium">Read on:</span>
              <span>{progress.monthAndYear}</span>
            </div>
          )}
          {progress.remarks && (
            <div className="flex items-start gap-2">
              <FileText size={16} className="mt-0.5 text-gray-500 dark:text-gray-300" />
              <div>
                <span className="font-medium block mb-1">Remarks:</span>
                <p className="text-sm">{progress.remarks}</p>
              </div>
            </div>
          )}
          <div className="flex justify-between pt-3 border-t border-gray-200 dark:border-gray-700 text-xs text-gray-500 dark:text-gray-400">
            <span>Added: {new Date(progress.createdAt).toLocaleDateString()}</span>
            {progress.updatedAt !== progress.createdAt && (
              <span>Updated: {new Date(progress.updatedAt).toLocaleDateString()}</span>
            )}
          </div>
          <div className="pt-2">
            <button
              onClick={onEdit}
              className="flex items-center gap-1 text-indigo-600 dark:text-indigo-400 text-sm hover:underline"
            >
              <Pencil size={14} />
              Edit
            </button>
          </div>
        </div>
      )}
    </div>
  )
}

export default ReadingProgressCard

================
File: frontend/src/components/ReadingStatsCards.jsx
================
const ReadingStatsCards = ({ readingProgress }) => {
    const totalBooks = readingProgress.length;
    const approvedBooks = readingProgress.filter((p) => p.approval).length;
    const pendingBooks = totalBooks - approvedBooks;
    const totalPages = readingProgress.reduce((sum, p) => sum + (p.numberOfPages || 0), 0);
  
    const stats = [
      {
        title: "Total Books",
        value: totalBooks,
        icon: "üìö",
        color: "from-blue-500 to-cyan-500",
        bgColor: "bg-blue-50 dark:bg-blue-900/30",
      },
      {
        title: "Approved",
        value: approvedBooks,
        icon: "‚úÖ",
        color: "from-green-500 to-emerald-500",
        bgColor: "bg-green-50 dark:bg-green-900/30",
      },
      {
        title: "Pending Review",
        value: pendingBooks,
        icon: "‚è≥",
        color: "from-amber-500 to-orange-500",
        bgColor: "bg-amber-50 dark:bg-amber-900/30",
      },
      {
        title: "Total Pages",
        value: totalPages.toLocaleString(),
        icon: "üìñ",
        color: "from-purple-500 to-pink-500",
        bgColor: "bg-purple-50 dark:bg-purple-900/30",
      },
    ];
  
    return (
      <div className="grid grid-cols-2 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-4">
        {stats.map((stat, index) => (
          <div
            key={index}
            className={`${stat.bgColor} rounded-2xl p-4 sm:p-5 md:p-6 shadow-sm hover:shadow-md transition-all duration-300 border border-white/50 dark:border-gray-700/50`}
          >
            <div className="flex items-center justify-between mb-2 sm:mb-3">
              <div className="text-lg sm:text-xl md:text-2xl">{stat.icon}</div>
              <div
                className={`w-8 h-8 sm:w-10 sm:h-10 rounded-xl bg-gradient-to-r ${stat.color} flex items-center justify-center shadow-lg`}
              >
                <div className="w-4 h-4 sm:w-5 sm:h-5 bg-white/30 rounded-lg"></div>
              </div>
            </div>
            <div className="text-xl sm:text-2xl font-bold mb-1 text-gray-800 dark:text-white">{stat.value}</div>
            <div className="text-xs sm:text-sm font-medium text-gray-600 dark:text-gray-300">{stat.title}</div>
          </div>
        ))}
      </div>
    );
  };
  
  export default ReadingStatsCards;

================
File: frontend/src/components/SearchBar.jsx
================
import { useState } from "react";
import { Search } from "lucide-react";

const SearchBar = ({ onSearch }) => {
  const [query, setQuery] = useState("");

  const handleSearch = (e) => {
    const value = e.target.value;
    setQuery(value);
    onSearch(value); 
  };

  return (
    <div className="flex items-center justify-center mt-10 mb-6">
      <div className="relative w-80">
        <input
          type="text"
          placeholder="Search for a book..."
          value={query}
          onChange={handleSearch}
          className="mt-10 w-full p-3 pl-10 border border-gray-300 dark:border-gray-600 rounded-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-md focus:ring-2 focus:ring-green-500 outline-none transition"
        />
        <Search className="absolute left-3 top-3 text-gray-500 dark:text-gray-400" size={18} />
      </div>
    </div>
  );
};

export default SearchBar;

================
File: frontend/src/components/Skeleten.jsx
================
import React from 'react'

const Skeleten = () => {
  return (
    <div className="flex w-52 flex-col gap-4">
  <div className="skeleton h-32 w-full"></div>
  <div className="skeleton h-4 w-28"></div>
  <div className="skeleton h-4 w-full"></div>
  <div className="skeleton h-4 w-full"></div>
</div>
  )
}

export default Skeleten

================
File: frontend/src/components/SociaIcons.jsx
================
import { FaWhatsapp, FaFacebookF, FaYoutube, FaInstagram } from 'react-icons/fa';

const icons = [
  { icon: <FaWhatsapp />, link: 'https://wa.me/' },
  { icon: <FaFacebookF />, link: 'https://facebook.com/' },
  { icon: <FaYoutube />, link: 'https://youtube.com/' },
  { icon: <FaInstagram />, link: 'https://instagram.com/' },
];

export default function SocialIcons() {
  return (
    <div className="flex justify-center items-center gap-2 p-4">
      {icons.map((item, index) => (
        <a
          key={index}
          href={item.link}
          target="_blank"
          rel="noopener noreferrer"
          className="w-6 h-6 bg-white text-black rounded-full flex justify-center items-center shadow-md hover:scale-110 transition duration-300"
        >
          {item.icon}
        </a>
      ))}
    </div>
  );
}

================
File: frontend/src/components/StatsCards.jsx
================
const StatsCards = ({ achievements }) => {
    const totalAchievements = achievements.length;
    const approvedAchievements = achievements.filter((a) => a.approval).length;
    const pendingAchievements = totalAchievements - approvedAchievements;
    const approvalRate = totalAchievements > 0 ? Math.round((approvedAchievements / totalAchievements) * 100) : 0;
  
    const stats = [
      {
        title: "Total Achievements",
        value: totalAchievements,
        icon: "üèÜ",
        color: "from-blue-500 to-cyan-500",
        bgColor: "bg-blue-100",
        darkBgColor: "dark:bg-blue-900/40",
      },
      {
        title: "Approved",
        value: approvedAchievements,
        icon: "‚úÖ",
        color: "from-green-500 to-emerald-500",
        bgColor: "bg-green-100",
        darkBgColor: "dark:bg-green-900/40",
      },
      {
        title: "Pending Review",
        value: pendingAchievements,
        icon: "‚è≥",
        color: "from-amber-500 to-orange-500",
        bgColor: "bg-amber-100",
        darkBgColor: "dark:bg-amber-900/40",
      },
      {
        title: "Approval Rate",
        value: `${approvalRate}%`,
        icon: "üìä",
        color: "from-purple-500 to-pink-500",
        bgColor: "bg-purple-100",
        darkBgColor: "dark:bg-purple-900/40",
      },
    ];
  
    return (
      <div className="grid grid-cols-2 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-3">
        {stats.map((stat, index) => (
          <div
            key={index}
            className={`${stat.bgColor} ${stat.darkBgColor} rounded-xl p-3 sm:p-4 border border-white/30 dark:border-white/10 shadow-sm hover:shadow-md transition-all duration-300 text-xs sm:text-sm`}
          >
            <div className="flex items-center justify-between mb-2">
              <div className="text-lg sm:text-xl">{stat.icon}</div>
              <div
                className={`w-8 h-8 rounded-lg bg-gradient-to-r ${stat.color} flex items-center justify-center shadow-md`}
              >
                <div className="w-3 h-3 bg-white/30 rounded"></div>
              </div>
            </div>
            <div className="text-lg sm:text-xl font-bold text-gray-800 dark:text-white mb-1">{stat.value}</div>
            <div className="text-[10px] sm:text-xs text-gray-600 dark:text-gray-300 font-medium leading-tight">
              {stat.title}
            </div>
          </div>
        ))}
      </div>
    );
  };
  
  export default StatsCards;

================
File: frontend/src/components/ThemeSwapButton.jsx
================
import { useThemeStore } from "../store/useThemeStore";
import { MdDarkMode, MdLightMode } from "react-icons/md";

const ThemeSwapButton = () => {
  const { theme, toggleTheme } = useThemeStore();

  return (
    <button
      onClick={toggleTheme}
      className="p-2 rounded-full bg-gray-200 dark:bg-gray-700 transition-colors"
    >
      {theme === "light" ? (
        <MdDarkMode className="text-xl text-gray-800 dark:text-yellow-400" />
      ) : (
        <MdLightMode className="text-xl text-gray-200 dark:text-yellow-400" />
      )}
    </button>
  );
};

export default ThemeSwapButton;

================
File: frontend/src/components/TransactionsDetails.jsx
================
import React, { useEffect, useState } from "react";
import { ChevronDown, ChevronUp, Undo2, AlertCircle } from "lucide-react";
import { useBooksStore } from "../store/useBooksStore";


const TransactionsDetails = ({ details }) => {
 const { bookReturn } = useBooksStore();
  const [expandedRows, setExpandedRows] = useState({});
  const [searchQuery, setSearchQuery] = useState("");
  const [sortOrder, setSortOrder] = useState("asc"); // "asc" or "desc"
  const [returnedBooks, setReturnedBooks] = useState([]);

  const toggleDetails = (bookNumber) => {
    setExpandedRows((prev) => ({
      ...prev,
      [bookNumber]: !prev[bookNumber],
    }));
  };

  const handleReturn = (bookNumber) => {
    if (window.confirm("Are you sure you want to return this book?")) {
      setReturnedBooks((prev) => [...prev, bookNumber]);
      bookReturn(bookNumber);
      
    
    }
  };

  
  const filteredBooks = details.filter((book) => {
    const query = searchQuery.toLowerCase();
    return (
      book.bookTitle.toLowerCase().includes(query) ||
      book.studentName.toLowerCase().includes(query) ||
      String(book.bookNumber).includes(query)
    );
  });

  const sortedBooks = filteredBooks.sort((a, b) => {
    const dateA = new Date(a.dueDate);
    const dateB = new Date(b.dueDate);
    return sortOrder === "asc" ? dateA - dateB : dateB - dateA;
  });

  const toggleSortOrder = () => {
    setSortOrder((prev) => (prev === "asc" ? "desc" : "asc"));
  };

  return (
    <div className="w-full max-w-7xl mx-auto p-4 mt-">
      <div className="flex flex-row items-center justify-between mb-4 gap-4 mt-20">
        <input
          type="text"
          placeholder="Search by Title, Student or Book No..."
          value={searchQuery}
          onChange={(e) => setSearchQuery(e.target.value)}
          className="w-full p-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-900 text-gray-900 dark:text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"
        />
        <button
  onClick={toggleSortOrder}
  className="flex items-center gap-1 p-2 bg-blue-600 dark:bg-blue-700 text-white rounded-lg hover:bg-blue-700 transition"
>
  Date <span>{sortOrder === "asc" ? "‚Üë" : "‚Üì"}</span>
</button>

      </div>

      <div className="grid gap-6 grid-cols-1 md:grid-cols-2 lg:grid-cols-3">
        {sortedBooks.map((book) => {
          const isOverdue = new Date() > new Date(book.dueDate);
          const isReturned = returnedBooks.includes(book.bookNumber);
          return (
            <div
              key={book.bookNumber}
              className={`
                bg-white dark:bg-gray-800 rounded-lg shadow border 
                ${isOverdue && !isReturned ? "border-red-500" : "border-gray-200 dark:border-gray-700"}
                hover:shadow-lg transition duration-300 relative
              `}
            >
              {isOverdue && !isReturned && (
                <div className="absolute top-2 right-2 flex items-center gap-1 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded">
                  <AlertCircle size={14} /> Overdue
                </div>
              )}
              {isReturned && (
                <div className="absolute top-2 right-2 bg-green-500 text-white text-xs font-bold px-2 py-1 rounded">
                  Returned
                </div>
              )}
              <div className="p-4 flex items-center justify-between">
                <div>
                  <h3 className="text-xl font-semibold text-gray-800 dark:text-white">
                    {book.bookTitle}
                  </h3>
                  <p className="text-sm text-gray-500 dark:text-gray-400">
                    Book No: <span className="font-medium">{book.bookNumber}</span>
                  </p>
                  <p className="text-sm text-gray-500 dark:text-gray-400">
                    Student: <span className="font-medium">{book.studentName}</span>
                  </p>
                </div>
                <div className="flex flex-col items-end">
                  <p className="text-sm text-gray-500 dark:text-gray-400">
                    {new Date(book.dueDate).toLocaleDateString()}
                  </p>
                  <div className="flex gap-2 mt-2">
                    <button
                      onClick={() => toggleDetails(book.bookNumber)}
                      className="p-2 bg-green-600 dark:bg-green-700 rounded-full text-white hover:bg-green-700 transition"
                    >
                      {expandedRows[book.bookNumber] ? (
                        <ChevronUp size={20} />
                      ) : (
                        <ChevronDown size={20} />
                      )}
                    </button>
                    {!isReturned && (
                      <button
                        onClick={() => handleReturn(book.bookNumber)}
                        className="p-2 bg-red-600 dark:bg-red-700 rounded-full text-white hover:bg-red-700 transition"
                      >
                        <Undo2 size={20} />
                      </button>
                    )}
                  </div>
                </div>
              </div>
              {expandedRows[book.bookNumber] && (
                <div className="px-4 pb-4 text-sm text-gray-700 dark:text-gray-300 border-t border-gray-200 dark:border-gray-700">
                  <p>
                    <strong>Borrow Date:</strong>{" "}
                    {new Date(book.borrowDate).toLocaleDateString()}
                  </p>
                  <p>
                    <strong>Due Date:</strong>{" "}
                    {new Date(book.dueDate).toLocaleDateString()}
                  </p>
                </div>
              )}
            </div>
          );
        })}
      </div>
    </div>
  );
};

export default TransactionsDetails;

================
File: frontend/src/constants/index.js
================
export const THEMES = [
    "light",
    "dark",
    "cupcake",
    "bumblebee",
    "emerald",
    "corporate",
    "synthwave",
    "retro",
    "cyberpunk",
    "valentine",
    "halloween",
    "garden",
    "forest",
    "aqua",
    "lofi",
    "pastel",
    "fantasy",
    "wireframe",
    "black",
    "luxury",
    "dracula",
    "cmyk",
    "autumn",
    "business",
    "acid",
    "lemonade",
    "night",
    "coffee",
    "winter",
    "dim",
    "nord",
    "sunset",
  ];

================
File: frontend/src/index.css
================
@tailwind base;
@tailwind components;
@tailwind utilities;

/* PDF Generation Safelist */
@layer utilities {
  /* Safe-list the required colors */
  .bg-pdf-gray-50 {
    @apply bg-[#f9fafb] !important;
  }
  
  .bg-pdf-indigo-100 {
    @apply bg-[#e0e7ff] !important;
  }

  .text-pdf-indigo-600 {
    @apply text-[#4f46e5] !important;
  }

  .border-pdf-gray-200 {
    @apply border-[#e5e7eb] !important;
  }
  @layer utilities {
    .pdf-bg-gray-50 { background-color: #f9fafb !important; }
    .pdf-bg-indigo-100 { background-color: #e0e7ff !important; }
    .pdf-text-indigo-600 { color: #4f46e5 !important; }
    .pdf-border-gray-200 { border-color: #e5e7eb !important; }
  }
}

================
File: frontend/src/pages/admin/AdminIshthiraq.jsx
================
import React, { useEffect, useState } from "react";
import { Eye, Pencil, Plus, Trash2 } from "lucide-react"; // or use Heroicons if preferred
import Header from "../../components/Header";
import { useNavigate } from "react-router-dom";
import { useAdminStore } from "../../store/useAdminMngStore";

const AdminIshthiraq = ({item}) => {
  const { batches, getBatches, addAcademicStatuslink, deleteAcademicStatuslink } = useAdminStore();
  const [academicStatusLink, setAcademicStatusLink] = useState("");
  const [editingBatchId, setEditingBatchId] = useState(null);

  const navigate = useNavigate();

  useEffect(() => {
    getBatches();
  }, [getBatches]);

  const handleSubmit = async (batchId) => {
    const isValidLink = academicStatusLink.includes("https://docs.google.com/spreadsheets");
    if (!isValidLink) return alert("Please enter a valid Google Sheets link.");

    try {
      await addAcademicStatuslink(academicStatusLink, batchId, item);
      await getBatches();
      setEditingBatchId(null);
      setAcademicStatusLink("");
    } catch (err) {
      console.error("Failed to update CE link", err);
    }
  };
  function onDelete(id){
    deleteAcademicStatuslink(id, item);
  }

  return (
    <>
      <Header />
      <div className="min-h-screen bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-900 dark:to-gray-800 p-6 pt-24">
        <h2 className="text-xl font-extrabold text-gray-900 dark:text-white mb-4 ml-8 font-oswald">
          {item}
        </h2>

        <div className="grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 px-2">
          {batches.map((batch, index) => (
            <div
              key={batch._id || index}
              className="bg-white dark:bg-gray-800 rounded-2xl shadow-md p-3 transition hover:shadow-xl"
            >
           <div className="flex items-center justify-between mb-1">
            <div className="flex items-center gap-3">
                <div className="w-10 h-10 rounded-full bg-sky-700 text-white flex items-center justify-center font-semibold">
                {index + 1}
                </div>
                <div className="text-lg font-semibold text-gray-800 dark:text-white">
                {batch.name}
                </div>
            </div>

            <div className="flex items-center gap-3">
                {!batch[item] ? (
                <button
                    onClick={() => {
                    setEditingBatchId(batch._id);
                    setAcademicStatusLink("");
                    }}
                    className="text-blue-600 hover:text-blue-800"
                    title="Add Link"
                >
                    <Plus size={20} />
                </button>
                ) : (
                <>
                    <button
                    onClick={() => {
                        onDelete(batch._id);
                    }}
                    className="text-red-500 hover:text-red-600"
                    title="Edit Link"
                    >
                    <Trash2 size={18} />
                    </button>
                    <button
                    onClick={() => {
                        setEditingBatchId(batch._id);
                        setAcademicStatusLink(batch[item] || "");
                    }}
                    className="text-yellow-500 hover:text-yellow-600"
                    title="Edit Link"
                    >
                    <Pencil size={18} />
                    </button>
                    <a
                    href={batch[item]}
                    target="_blank"
                    rel="noopener noreferrer"
                    className="text-green-600 hover:text-green-700"
                    title="View Link"
                    >
                    <Eye size={18} />
                    </a>
                </>
                )}
            </div>
            </div>


           

              {/* Input Field */}
              {editingBatchId === batch._id && (
                <div className="mt-4">
                  <input
                    type="text"
                    value={academicStatusLink}
                    onChange={(e) => setAcademicStatusLink(e.target.value)}
                    placeholder="Paste Google Sheet link"
                    className="w-full border rounded-lg px-3 py-2 text-sm dark:bg-gray-700 dark:text-white"
                  />
                  <div className="flex justify-end mt-2 gap-2">
                    <button
                      onClick={() => handleSubmit(batch._id)}
                      className="bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 text-sm"
                    >
                      Save
                    </button>
                    <button
                      onClick={() => {
                        setEditingBatchId(null);
                        setAcademicStatusLink("");
                      }}
                      className="text-sm text-gray-500 hover:text-gray-800"
                    >
                      Cancel
                    </button>
                  </div>
                </div>
              )}
            </div>
          ))}
        </div>
      </div>
    </>
  );
};


export default AdminIshthiraq

================
File: frontend/src/pages/admin/AdminMarkUpdate.jsx
================
import React, { useEffect, useState} from "react";
import Header from "../../components/Header";
import { useMarksStore } from "../../store/useMarksStore";
import { useNavigate } from "react-router-dom";
import { useAdminStore } from "../../store/useAdminMngStore";

const AdminMarkUpdate = () => {
  const {batches, getBatches} = useAdminStore();
  const {countToApprove, getcountToApprove} = useMarksStore()

  useEffect(() => {
    getBatches();
    
  }, [getBatches]); 

useEffect(() => {
    getcountToApprove();
}, [])

  const navigate = useNavigate();
  return (
    <>
      <Header />
      { 
        <div className="min-h-screen bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-900 dark:to-gray-800 p-6 pt-24">
          <div className="grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4">
            <h2 className="col-span-full text-2xl font-extrabold text-gray-900 dark:text-white mb-4 ml-8 font-oswald">
              Batches
            </h2>

            {batches.map((batch, index) => (
              <React.Fragment key={batch.id || index}>
               
                                <div className="relative block" onClick={() => navigate(`/dashboard/admin/batches/marklist/${batch._id}`)}>
                <div className="bg-white dark:bg-gray-700 rounded-xl shadow-lg dark:shadow-gray-900 p-6 transform transition duration-300 hover:-translate-y-2 hover:shadow-2xl cursor-pointer relative">
                    
                    {/* üîπ Badge for Pending Approvals */}
                    {countToApprove && countToApprove.find((b) => b._id === batch._id)?.count > 0 && (
                    <div className="absolute top-2 right-2 w-5 h-5 flex items-center justify-center rounded-full bg-red-600 text-white text-xs font-bold">
                        {countToApprove.find((b) => b._id === batch._id)?.count}
                    </div>
                    )}

                    <div className="flex items-center">
                    <div className="w-10 h-10 flex-shrink-0 rounded-full  bg-sky-800 dark:bg-sky-600 text-white flex items-center justify-center font-bold text-lg mr-4">
                        {index + 1}
                    </div>
                    <div className="text-gray-900 dark:text-gray-200 text-lg font-medium font-sans">
                        {batch.name}
                    </div>
                    </div>
                </div>
                </div>

              </React.Fragment>
            ))}
          </div>
        </div>
      }
    </>
  );
};


export default AdminMarkUpdate

================
File: frontend/src/pages/admin/AdmissionForm.jsx
================
import { useEffect, useState } from "react";
import { useParams } from "react-router-dom";
import toast from "react-hot-toast";
import { 
  User, Phone, Mail, MapPin, Calendar, 
  Camera, Save, Loader2, MessageCircle, FileText 
} from "lucide-react";
import Header from "../../components/Header";
import InputField from "../../components/InputField";
import SelectField from "../../components/SelectField";
import { useRegisterdStudentStore } from "../../store/useRegisterdStudentStore";
import { useAdminStore } from "../../store/useAdminMngStore";
import { useStudentStore } from "../../store/studentStore";

const AdmissionForm = () => {
  const { studentId } = useParams();
  const { newAdmission, isLoading } = useRegisterdStudentStore();
  const { batches, getBatches } = useAdminStore();
  const { student, getStudent, editStudent } = useStudentStore();

  const [formData, setFormData] = useState({
    name: "",
    cicNumber: "",
    phoneNumber: "",
    whatsupNumber: "",
    email: "",
    address: "",
    password: "",
    batchName: "",
    dateOfBirth: "",
    parentNumber: "",
    profileImage: null,
  });

  const [previewImage, setPreviewImage] = useState(null);

  useEffect(() => {
    getBatches();
  }, []);

  useEffect(() => {
    if (studentId) {
      getStudent(studentId);
    }
  }, [studentId]);

  useEffect(() => {
    if (studentId && student) {
      setFormData((prev) => ({
        ...prev,
        name: student.name || "",
        cicNumber: student.cicNumber || "",
        phoneNumber: student.phoneNumber || "",
        whatsupNumber: student.whatsupNumber || "",
        email: student.email || "",
        address: student.address || "",
        batchName: student.batchName || "",
        dateOfBirth: student.dateOfBirth ? student.dateOfBirth.slice(0, 10) : "",
        parentNumber: student.parentNumber || "",
        profileImage: student.profileImage || null,
      }));
      setPreviewImage(student.profileImage);
    }
  }, [student, studentId]);

  const validateForm = () => {
    if (!formData.name.trim()) return toast.error("Student Name is required");
    if (!formData.cicNumber) return toast.error("CIC Number is required");
    if (!formData.batchName) return toast.error("Batch is required");
    return true;
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    if (validateForm()) {
      if (studentId) {
        editStudent(formData, studentId);
      } else {
        newAdmission(formData);
      }
    }
  };

  const handleImageChange = (e) => {
    const file = e.target.files[0];
    if (file) {
      setFormData((prev) => ({ ...prev, profileImage: file }));
      setPreviewImage(URL.createObjectURL(file));
    }
  };

  // Helper to handle input changes for the new InputField component
  const handleInputChange = (field, value) => {
    setFormData(prev => ({ ...prev, [field]: value }));
  };

  return (
    <div className="min-h-screen bg-slate-50 dark:bg-surface-dark pb-20">
      <Header page={studentId ? "Edit Student" : "New Admission"} />
      
      <div className="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 mt-10">
        
        {/* Header Section */}
        <div className="mb-8">
          <h1 className="text-3xl font-display font-bold text-slate-900 dark:text-white">
            {studentId ? "Edit Student Profile" : "Student Admission"}
          </h1>
          <p className="text-slate-500 dark:text-slate-400">
            Enter the student's academic and personal details below.
          </p>
        </div>

        <form onSubmit={handleSubmit} className="grid grid-cols-1 lg:grid-cols-3 gap-8">
          
          {/* Left Column: Image Upload */}
          <div className="lg:col-span-1">
            <div className="bg-white dark:bg-slate-800 rounded-3xl shadow-sm border border-slate-200 dark:border-slate-700 p-6 flex flex-col items-center text-center">
              <div className="relative group">
                <div className="w-40 h-40 rounded-full border-4 border-slate-100 dark:border-slate-700 overflow-hidden bg-slate-50 dark:bg-slate-900">
                  {previewImage ? (
                    <img 
                      src={previewImage} 
                      alt="Preview" 
                      className="w-full h-full object-cover" 
                    />
                  ) : (
                    <div className="w-full h-full flex items-center justify-center text-slate-300">
                      <User size={64} />
                    </div>
                  )}
                </div>
                
                <label 
                  htmlFor="profileImage" 
                  className="absolute bottom-2 right-2 p-3 bg-primary-600 text-white rounded-full shadow-lg cursor-pointer hover:bg-primary-700 transition-transform hover:scale-110 active:scale-95"
                >
                  <Camera size={20} />
                  <input
                    id="profileImage"
                    type="file"
                    accept="image/*"
                    onChange={handleImageChange}
                    className="hidden"
                  />
                </label>
              </div>
              
              <h3 className="mt-4 font-bold text-slate-800 dark:text-white">Profile Photo</h3>
              <p className="text-xs text-slate-500 mt-1">Upload a clear face photo.</p>
            </div>
          </div>

          {/* Right Column: Form Fields */}
          <div className="lg:col-span-2 space-y-6">
            <div className="bg-white dark:bg-slate-800 rounded-3xl shadow-sm border border-slate-200 dark:border-slate-700 p-6 md:p-8">
              
              <h3 className="text-lg font-bold text-slate-800 dark:text-white mb-6 flex items-center gap-2">
                <FileText size={20} className="text-primary-500" /> Academic Info
              </h3>
              
              <div className="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-2">
                <InputField
                  label="Student Name"
                  name="name"
                  value={formData.name}
                  icon={<User size={18} />}
                  onChange={(val) => handleInputChange("name", val)}
                />
                <InputField
                  label="CIC Number"
                  name="cicNumber"
                  type="number"
                  value={formData.cicNumber}
                  icon={<FileText size={18} />}
                  onChange={(val) => handleInputChange("cicNumber", val)}
                />
                <SelectField
                  label="Batch"
                  name="batchName"
                  value={formData.batchName}
                  options={batches.map((c) => c.name)}
                  icon={<FileText size={18} />}
                  onChange={(val) => handleInputChange("batchName", val)}
                />
                <InputField
                  label="Date of Birth"
                  name="dateOfBirth"
                  type="date"
                  value={formData.dateOfBirth}
                  icon={<Calendar size={18} />}
                  onChange={(val) => handleInputChange("dateOfBirth", val)}
                />
              </div>

              <div className="w-full h-px bg-slate-100 dark:bg-slate-700 my-6"></div>

              <h3 className="text-lg font-bold text-slate-800 dark:text-white mb-6 flex items-center gap-2">
                <Phone size={20} className="text-primary-500" /> Contact Details
              </h3>

              <div className="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-2">
                <InputField
                  label="Email Address"
                  name="email"
                  type="email"
                  value={formData.email}
                  icon={<Mail size={18} />}
                  onChange={(val) => handleInputChange("email", val)}
                />
                <InputField
                  label="Phone Number"
                  name="phoneNumber"
                  type="tel"
                  value={formData.phoneNumber}
                  icon={<Phone size={18} />}
                  onChange={(val) => handleInputChange("phoneNumber", val)}
                />
                <InputField
                  label="WhatsApp Number"
                  name="whatsupNumber"
                  type="tel"
                  value={formData.whatsupNumber}
                  icon={<MessageCircle size={18} />}
                  onChange={(val) => handleInputChange("whatsupNumber", val)}
                />
                <InputField
                  label="Parent Contact"
                  name="parentNumber"
                  type="tel"
                  value={formData.parentNumber}
                  icon={<Phone size={18} />}
                  onChange={(val) => handleInputChange("parentNumber", val)}
                />
                <div className="md:col-span-2">
                  <InputField
                    label="Residential Address"
                    name="address"
                    value={formData.address}
                    icon={<MapPin size={18} />}
                    onChange={(val) => handleInputChange("address", val)}
                  />
                </div>
                
                {!studentId && (
                  <div className="md:col-span-2 mt-2">
                    <InputField
                      label="Set Password"
                      name="password"
                      type="password"
                      value={formData.password}
                      onChange={(val) => handleInputChange("password", val)}
                    />
                  </div>
                )}
              </div>

              <div className="mt-8 flex justify-end">
                <button
                  type="submit"
                  disabled={isLoading}
                  className="flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-primary-600 to-indigo-600 hover:from-primary-700 hover:to-indigo-700 text-white font-bold rounded-xl shadow-lg shadow-primary-500/30 transform hover:-translate-y-0.5 transition-all disabled:opacity-70 disabled:cursor-not-allowed"
                >
                  {isLoading ? <Loader2 className="animate-spin" /> : <Save size={20} />}
                  {studentId ? "Update Student" : "Submit Admission"}
                </button>
              </div>

            </div>
          </div>
        </form>
      </div>
    </div>
  );
};

export default AdmissionForm;

================
File: frontend/src/pages/admin/AssignFees.jsx
================
import React, { useState, useEffect } from "react";
import { axiosInstance } from "../../lib/axios";
import { Loader2 } from "lucide-react";
import toast from "react-hot-toast";
import { useStudentStore } from "../../store/studentStore";
import { useAdminStore } from "../../store/useAdminMngStore";
import { use } from "react";
import { useFeeStore } from "../../store/feesSrore";

const AssignFees = () => {
  const { batchStudents, getBatchStudents } = useStudentStore();
  const { batches, getBatches } = useAdminStore();
  const { assignFees } = useFeeStore()

  const [selectedBatch, setSelectedBatch] = useState(""); // ‚úÖ start empty
  const [fees, setFees] = useState({});
  const [loading, setLoading] = useState(false);
  const [saving, setSaving] = useState(false);

  useEffect(() => {
    const fetchData = async () => {
      setLoading(true);
      try {
        await getBatches();
      } catch (error) {
        console.error("Error fetching batches:", error);
      } finally {
        setLoading(false);
      }
    };
    fetchData();
  }, [getBatches]);

  useEffect(() => {
    if (batches.length > 0 && !selectedBatch) {
      const defaultBatch = batches.find((b) => b.isActive) || batches[0];
      setSelectedBatch(defaultBatch?._id || "");
    }
  }, [batches, selectedBatch]);

  useEffect(() => {
    if (selectedBatch) {
      getBatchStudents(selectedBatch);
      fetchFees(selectedBatch);
    }
  }, [selectedBatch, getBatchStudents]);

  const fetchFees = async (batchId) => {
    try {
      const { data } = await axiosInstance.get(`/fees/${batchId}`);
      setFees(data.fees || {});
    } catch (error) {
      console.error("Error fetching fees:", error);
    }
  };

  const handleFeeChange = (studentId, value) => {
    setFees((prev) => ({
      ...prev,
      [studentId]: value,
    }));
  };

  const handleSave = async () => {
    setSaving(true);
    try {
      await assignFees(batchId, fees)
    } catch (error) {
      console.error(error);
    } finally {
      setSaving(false);
    }
  };

  return (
    <div className="max-w-2xl mx-auto mt-12 bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
      <h2 className="text-2xl font-bold mb-6 text-center text-sky-800 dark:text-blue-300">
        Assign Fees
      </h2>

      <div className="mb-6 flex flex-col sm:flex-row gap-4 items-center">
        <label className="font-semibold text-gray-700 dark:text-gray-200">
          Select Batch:
        </label>
        <select
          value={selectedBatch}
          onChange={(e) => setSelectedBatch(e.target.value)}
          className="px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-100 focus:outline-none"
        >
          <option value=""> Select Batch</option>
          {batches.map((batch) => (
            <option key={batch._id} value={batch._id}>
              {batch.name}
            </option>
          ))}
        </select>
      </div>

      {loading ? (
        <div className="flex justify-center items-center py-12">
          <Loader2 className="animate-spin" size={32} />
        </div>
      ) : batchStudents.length > 0 ? (
        <div className="overflow-x-auto">
          <table className="w-full border-collapse rounded-lg shadow">
            <thead>
              <tr className="bg-slate-500 dark:bg-gray-700 text-white">
                <th className="px-6 py-3 text-left">Student Name</th>
                <th className="px-6 py-3 text-left">Assign Fee</th>
              </tr>
            </thead>
            <tbody>
              {batchStudents.map((student) => (
                <tr
                  key={student._id}
                  className="border-b border-gray-200 dark:border-gray-700"
                >
                  <td className="px-6 py-3">{student.name}</td>
                  <td className="px-6 py-3">
                    <input
                      type="number"
                      min={0}
                      value={fees[student._id] || ""}
                      onChange={(e) =>
                        handleFeeChange(student._id, e.target.value)
                      }
                      placeholder="Enter fee"
                      className="w-32 px-3 py-2 rounded border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-100 focus:outline-none"
                    />
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
          <div className="flex justify-end mt-6">
            <button
              onClick={handleSave}
              disabled={saving}
              className="px-6 py-2 bg-sky-700 hover:bg-indigo-700 text-white rounded-lg shadow font-semibold flex items-center gap-2"
            >
              {saving && <Loader2 className="animate-spin" size={18} />}
              Save Fees
            </button>
          </div>
        </div>
      ) : selectedBatch ? (
        <div className="text-center text-gray-500 dark:text-gray-400 py-8">
          No students found for this batch.
        </div>
      ) : null}
    </div>
  );
};

export default AssignFees;

================
File: frontend/src/pages/admin/CEMarkAdmin.jsx
================
import React, { useEffect, useState } from "react";
import { Eye, Pencil, Plus } from "lucide-react"; // or use Heroicons if preferred
import Header from "../../components/Header";
import { useNavigate } from "react-router-dom";
import { useAdminStore } from "../../store/useAdminMngStore";

const CEMarkAdmin = () => {
  const { batches, getBatches, addBatchCemarklink } = useAdminStore();
  const [ceMarklistLink, setCeMarklistLink] = useState("");
  const [editingBatchId, setEditingBatchId] = useState(null);

  const navigate = useNavigate();

  useEffect(() => {
    getBatches();
  }, [getBatches]);

  const handleSubmit = async (batchId) => {
    const isValidLink = ceMarklistLink.includes("https://docs.google.com/spreadsheets");
    if (!isValidLink) return alert("Please enter a valid Google Sheets link.");

    try {
      await addBatchCemarklink(ceMarklistLink, batchId);
      await getBatches();
      setEditingBatchId(null);
      setCeMarklistLink("");
    } catch (err) {
      console.error("Failed to update CE link", err);
    }
  };

  return (
    <>
      <Header />
      <div className="min-h-screen bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-900 dark:to-gray-800 p-6 pt-24">
        <h2 className="text-2xl font-extrabold text-gray-900 dark:text-white mb-4 ml-8 font-oswald">
          CE Mark Lists
        </h2>

        <div className="grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 px-2">
          {batches.map((batch, index) => (
            <div
              key={batch._id || index}
              className="bg-white dark:bg-gray-800 rounded-2xl shadow-md p-3 transition hover:shadow-xl"
            >
           <div className="flex items-center justify-between mb-1">
            <div className="flex items-center gap-3">
                <div className="w-10 h-10 rounded-full bg-sky-700 text-white flex items-center justify-center font-semibold">
                {index + 1}
                </div>
                <div className="text-lg font-semibold text-gray-800 dark:text-white">
                {batch.name}
                </div>
            </div>

            <div className="flex items-center gap-3">
                {!batch?.CEmarkList ? (
                <button
                    onClick={() => {
                    setEditingBatchId(batch._id);
                    setCeMarklistLink("");
                    }}
                    className="text-blue-600 hover:text-blue-800"
                    title="Add Link"
                >
                    <Plus size={20} />
                </button>
                ) : (
                <>
                    <button
                    onClick={() => {
                        setEditingBatchId(batch._id);
                        setCeMarklistLink(batch.CEmarkList || "");
                    }}
                    className="text-yellow-500 hover:text-yellow-600"
                    title="Edit Link"
                    >
                    <Pencil size={20} />
                    </button>
                    <a
                    href={batch.CEmarkList}
                    target="_blank"
                    rel="noopener noreferrer"
                    className="text-green-600 hover:text-green-700"
                    title="View Link"
                    >
                    <Eye size={20} />
                    </a>
                </>
                )}
            </div>
            </div>


           

              {/* Input Field */}
              {editingBatchId === batch._id && (
                <div className="mt-4">
                  <input
                    type="text"
                    value={ceMarklistLink}
                    onChange={(e) => setCeMarklistLink(e.target.value)}
                    placeholder="Paste Google Sheet link"
                    className="w-full border rounded-lg px-3 py-2 text-sm dark:bg-gray-700 dark:text-white"
                  />
                  <div className="flex justify-end mt-2 gap-2">
                    <button
                      onClick={() => handleSubmit(batch._id)}
                      className="bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 text-sm"
                    >
                      Save
                    </button>
                    <button
                      onClick={() => {
                        setEditingBatchId(null);
                        setCeMarklistLink("");
                      }}
                      className="text-sm text-gray-500 hover:text-gray-800"
                    >
                      Cancel
                    </button>
                  </div>
                </div>
              )}
            </div>
          ))}
        </div>
      </div>
    </>
  );
};

export default CEMarkAdmin;

================
File: frontend/src/pages/admin/FeesDashboardAnalytics.jsx
================
import React, { useState, useEffect } from 'react';
import {
  AreaChart, Area, BarChart, Bar, PieChart, Pie, Cell,
  XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer
} from 'recharts';
import { useFeeStore } from '../../store/feesSrore';
import { useNavigate } from 'react-router-dom';
import { TrendingUp, Users, AlertCircle, Wallet, ArrowRight } from 'lucide-react';
import { motion } from 'framer-motion';

// --- Styled Components ---

const AnalyticCard = ({ title, value, icon: Icon, color, trend }) => (
  <motion.div 
    whileHover={{ y: -5 }}
    className="relative overflow-hidden bg-white dark:bg-slate-800 p-6 rounded-3xl shadow-sm border border-slate-200 dark:border-slate-700 group"
  >
    <div className={`absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity`}>
      <Icon size={80} className={color} />
    </div>
    
    <div className="relative z-10">
      <div className={`w-12 h-12 rounded-2xl flex items-center justify-center mb-4 ${color.replace('text-', 'bg-').replace('500', '100')} dark:bg-opacity-20`}>
        <Icon size={24} className={color} />
      </div>
      
      <p className="text-sm font-medium text-slate-500 dark:text-slate-400">{title}</p>
      <h3 className="text-3xl font-display font-bold text-slate-800 dark:text-white mt-1">
        {value}
      </h3>
      
      {trend && (
        <div className="flex items-center gap-1 mt-2 text-xs font-medium text-emerald-600 dark:text-emerald-400">
          <TrendingUp size={14} />
          <span>{trend}</span>
        </div>
      )}
    </div>
  </motion.div>
);

const CustomTooltip = ({ active, payload, label }) => {
  if (active && payload && payload.length) {
    return (
      <div className="bg-white/90 dark:bg-slate-800/90 backdrop-blur-md p-4 rounded-xl shadow-xl border border-slate-200 dark:border-slate-700 text-sm">
        <p className="font-bold text-slate-800 dark:text-white mb-2">{label}</p>
        {payload.map((entry, index) => (
          <div key={index} className="flex items-center gap-2 text-xs">
            <span className="w-2 h-2 rounded-full" style={{ backgroundColor: entry.color }} />
            <span className="text-slate-600 dark:text-slate-300 capitalize">{entry.name}:</span>
            <span className="font-mono font-bold text-slate-900 dark:text-white">
              {typeof entry.value === 'number' && entry.name !== 'Students' 
                ? `‚Çπ${entry.value.toLocaleString()}` 
                : entry.value}
            </span>
          </div>
        ))}
      </div>
    );
  }
  return null;
};

const FeesDashboardAnalytics = () => {
  const { fetchDashboardAnalytics } = useFeeStore();
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);
  const navigate = useNavigate();

  useEffect(() => {
    const load = async () => {
      try {
        const res = await fetchDashboardAnalytics();
        setData(res);
      } finally {
        setLoading(false);
      }
    };
    load();
  }, []);

  if (loading) return (
    <div className="min-h-[60vh] flex items-center justify-center">
      <div className="w-16 h-16 border-4 border-primary-500/30 border-t-primary-500 rounded-full animate-spin" />
    </div>
  );

  if (!data) return <div className="p-8 text-center text-slate-500">No analytics data available.</div>;

  const { kpi, charts, tables } = data;
  const COLORS = ['#10b981', '#f43f5e', '#f59e0b', '#3b82f6'];

  return (
    <div className="space-y-8 pt-6 pb-20">
      
      {/* Header */}
      <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
        <div>
          <h1 className="text-3xl font-display font-bold text-slate-900 dark:text-white">Financial Overview</h1>
          <p className="text-slate-500 dark:text-slate-400">Track revenue, collections, and dues.</p>
        </div>
        <button 
          onClick={() => navigate("/dashboard/admin/add-fees")}
          className="flex items-center gap-2 px-6 py-3 bg-primary-600 hover:bg-primary-700 text-white rounded-xl font-bold shadow-lg shadow-primary-500/20 transition-all active:scale-95"
        >
          <Wallet size={18} /> Manage Fees
        </button>
      </div>

      {/* KPI Grid */}
      <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
        <AnalyticCard 
          title="Total Revenue" 
          value={`‚Çπ${kpi.totalRevenueDue.toLocaleString()}`} 
          icon={Wallet} 
          color="text-blue-500" 
          trend="Projected Income"
        />
        <AnalyticCard 
          title="Collected" 
          value={`‚Çπ${kpi.totalCollected.toLocaleString()}`} 
          icon={TrendingUp} 
          color="text-emerald-500"
          trend={`${((kpi.totalCollected / kpi.totalRevenueDue) * 100).toFixed(1)}% Recovered`}
        />
        <AnalyticCard 
          title="Outstanding" 
          value={`‚Çπ${kpi.totalOutstanding.toLocaleString()}`} 
          icon={AlertCircle} 
          color="text-rose-500"
          trend="Pending Dues"
        />
        <AnalyticCard 
          title="Active Students" 
          value={kpi.totalStudents} 
          icon={Users} 
          color="text-amber-500"
        />
      </div>

      {/* Charts Section */}
      <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
        
        {/* Main Trend Chart */}
        <div className="lg:col-span-2 bg-white dark:bg-slate-800 p-6 rounded-3xl shadow-sm border border-slate-200 dark:border-slate-700">
          <h3 className="text-lg font-bold text-slate-800 dark:text-white mb-6">Monthly Collection Trend</h3>
          <div className="h-[300px] w-full">
            <ResponsiveContainer width="100%" height="100%">
              <AreaChart data={charts.collectionByMonth}>
                <defs>
                  <linearGradient id="colorCollected" x1="0" y1="0" x2="0" y2="1">
                    <stop offset="5%" stopColor="#3b82f6" stopOpacity={0.3}/>
                    <stop offset="95%" stopColor="#3b82f6" stopOpacity={0}/>
                  </linearGradient>
                </defs>
                <CartesianGrid strokeDasharray="3 3" stroke="#e2e8f0" vertical={false} />
                <XAxis dataKey="month" axisLine={false} tickLine={false} tick={{fill: '#64748b', fontSize: 12}} dy={10} />
                <YAxis axisLine={false} tickLine={false} tick={{fill: '#64748b', fontSize: 12}} tickFormatter={(val) => `‚Çπ${val/1000}k`} />
                <Tooltip content={<CustomTooltip />} />
                <Area 
                  type="monotone" 
                  dataKey="collected" 
                  stroke="#3b82f6" 
                  strokeWidth={3}
                  fillOpacity={1} 
                  fill="url(#colorCollected)" 
                />
              </AreaChart>
            </ResponsiveContainer>
          </div>
        </div>

        {/* Donut Chart */}
        <div className="bg-white dark:bg-slate-800 p-6 rounded-3xl shadow-sm border border-slate-200 dark:border-slate-700 flex flex-col items-center justify-center">
          <h3 className="text-lg font-bold text-slate-800 dark:text-white mb-2 w-full text-left">Recovery Status</h3>
          <div className="h-[250px] w-full relative">
            <ResponsiveContainer width="100%" height="100%">
              <PieChart>
                <Pie
                  data={[
                    { name: 'Collected', value: kpi.totalCollected },
                    { name: 'Outstanding', value: kpi.totalOutstanding }
                  ]}
                  cx="50%"
                  cy="50%"
                  innerRadius={60}
                  outerRadius={80}
                  paddingAngle={5}
                  dataKey="value"
                >
                  <Cell fill="#10b981" />
                  <Cell fill="#f43f5e" />
                </Pie>
                <Tooltip content={<CustomTooltip />} />
              </PieChart>
            </ResponsiveContainer>
            {/* Center Text */}
            <div className="absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
              <span className="text-3xl font-bold text-slate-800 dark:text-white">
                {((kpi.totalCollected / kpi.totalRevenueDue) * 100).toFixed(0)}%
              </span>
              <span className="text-xs text-slate-500 uppercase tracking-wide">Recovered</span>
            </div>
          </div>
          
          {/* Custom Legend */}
          <div className="flex gap-4 mt-4">
            <div className="flex items-center gap-2 text-sm text-slate-600 dark:text-slate-300">
              <span className="w-3 h-3 rounded-full bg-emerald-500" /> Collected
            </div>
            <div className="flex items-center gap-2 text-sm text-slate-600 dark:text-slate-300">
              <span className="w-3 h-3 rounded-full bg-rose-500" /> Pending
            </div>
          </div>
        </div>
      </div>

      {/* Top Defaulters Table */}
      <div className="bg-white dark:bg-slate-800 rounded-3xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden">
        <div className="px-6 py-4 border-b border-slate-200 dark:border-slate-700 flex justify-between items-center">
          <h3 className="font-bold text-slate-800 dark:text-white">Pending Dues Alert</h3>
          <button className="text-sm text-primary-600 hover:text-primary-700 font-medium flex items-center gap-1">
            View All <ArrowRight size={14} />
          </button>
        </div>
        <table className="w-full text-left text-sm">
          <thead className="bg-slate-50 dark:bg-slate-900/50 text-slate-500 font-medium">
            <tr>
              <th className="px-6 py-3">Student</th>
              <th className="px-6 py-3">Batch</th>
              <th className="px-6 py-3 text-right">Pending Amount</th>
            </tr>
          </thead>
          <tbody className="divide-y divide-slate-100 dark:divide-slate-700">
            {tables.topDefaulters.map((student, i) => (
              <tr key={i} className="hover:bg-slate-50 dark:hover:bg-slate-700/30">
                <td className="px-6 py-3 font-medium text-slate-900 dark:text-white">{student.name}</td>
                <td className="px-6 py-3 text-slate-500">{student.batchName}</td>
                <td className="px-6 py-3 text-right font-bold text-rose-500">‚Çπ{student.balance.toLocaleString()}</td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>

    </div>
  );
};

export default FeesDashboardAnalytics;

================
File: frontend/src/pages/admin/FeesRegister.jsx
================
import React, { useState, useMemo, useEffect } from 'react';
import { useFeeStore } from '../../store/feesSrore'; // Ensure this path is correct
import Header from '../../components/Header';

// --- Helper Functions ---
const formatCurrency = (value) => {
    const numValue = parseFloat(value);
    if (isNaN(numValue)) return '';
    return new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR', minimumFractionDigits: 0 }).format(numValue);
};

// --- SVG Icons ---
const EditIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>);
const SaveIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline></svg>);
const CancelIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>);
const ChevronDownIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>);
const SpinnerIcon = () => (<svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle><path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>);


// --- Reusable Child Components ---

const StudentCard = ({ student, onUpdate, monthNames }) => {
    const [isEditing, setIsEditing] = useState(false);
    const [editedData, setEditedData] = useState(student);

    const perYear = parseFloat(student.subscription.perYear) || 0;
    const balance = parseFloat(editedData.subscription.balance) || 0; // Use editedData for live balance
    const paid = perYear > 0 ? perYear - balance : 0;
    const progress = perYear > 0 ? (paid / perYear) * 100 : (balance === 0 ? 100 : 0);

    useEffect(() => { setEditedData(student); }, [student]);

    const handleEditToggle = () => { setIsEditing(!isEditing); setEditedData(student); };

    const handleInputChange = (e) => {
        const { name, value } = e.target;
        const [field, subField] = name.split('.');
        setEditedData(prev => {
            let newEditedData = { ...prev };
            if (subField) {
                newEditedData = { ...prev, [field]: { ...prev[field], [subField]: value } };
            } else {
                newEditedData = { ...prev, [name]: value };
            }
            if (name === 'subscription.perYear') {
                const totalPaid = Object.values(newEditedData.payments).reduce((sum, amount) => !isNaN(parseFloat(amount)) ? sum + parseFloat(amount) : sum, 0);
                newEditedData.subscription.balance = String((parseFloat(value) || 0) - totalPaid);
            }
            return newEditedData;
        });
    };

    const handlePaymentChange = (month, value) => {
        setEditedData(prev => {
            const newPayments = { ...prev.payments, [month]: value };
            const totalPaid = Object.values(newPayments).reduce((sum, amount) => !isNaN(parseFloat(amount)) ? sum + parseFloat(amount) : sum, 0);
            const newBalance = (parseFloat(prev.subscription.perYear) || 0) - totalPaid;
            return { ...prev, payments: newPayments, subscription: { ...prev.subscription, balance: String(newBalance) } };
        });
    };

    const handleSave = () => {
        onUpdate(student.cicNumber, editedData);
        setIsEditing(false);
    };

    return (
        <div className="bg-white dark:bg-gray-800 rounded-2xl shadow-lg hover:shadow-xl transition-shadow duration-300 ease-in-out overflow-hidden flex flex-col">
            <div className="p-6 flex-grow">
                <div className="flex justify-between items-start mb-4">
                    <div>
                        <h2 className="text-2xl font-bold text-gray-800 dark:text-gray-100">{student.name}</h2>
                        <p className="text-sm text-gray-500 dark:text-gray-400">CIC: {student.cicNumber}</p>
                    </div>
                    <div className="flex space-x-2">
                        {isEditing ? (
                            <>
                                <button onClick={handleSave} className="p-2 text-green-600 hover:bg-green-100 dark:hover:bg-green-900 rounded-full transition-colors"><SaveIcon /></button>
                                <button onClick={handleEditToggle} className="p-2 text-red-600 hover:bg-red-100 dark:hover:bg-red-900 rounded-full transition-colors"><CancelIcon /></button>
                            </>
                        ) : (
                            <button onClick={handleEditToggle} className="p-2 text-indigo-600 dark:text-indigo-400 hover:bg-indigo-100 dark:hover:bg-gray-700 rounded-full transition-colors"><EditIcon /></button>
                        )}
                    </div>
                </div>
                <div className="mb-4">
                    {isEditing ? <input type="text" name="contact" value={editedData.contact || ''} onChange={handleInputChange} className="text-gray-700 dark:text-gray-300 dark:bg-gray-700 p-2 border dark:border-gray-600 rounded-md w-full" placeholder="Contact number" /> : <p className="text-gray-700 dark:text-gray-300">{student.contact || 'No contact info'}</p>}
                </div>
                <div className="bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg mb-4">
                    <h3 className="font-semibold text-gray-700 dark:text-gray-300 mb-3">Fee Status</h3>
                    <div className="grid grid-cols-2 gap-4 text-center">
                        <div>
                            <p className="text-xs text-gray-500 dark:text-gray-400">Total Fee</p>
                            {isEditing ? <input type="number" name="subscription.perYear" value={editedData.subscription.perYear} onChange={handleInputChange} className="font-bold text-indigo-600 dark:text-indigo-400 dark:bg-gray-600 text-lg p-1 border dark:border-gray-500 rounded-md w-full text-center" /> : <p className="font-bold text-indigo-600 dark:text-indigo-400 text-lg">{formatCurrency(student.subscription.perYear)}</p>}
                        </div>
                        <div>
                            <p className="text-xs text-gray-500 dark:text-gray-400">Balance Due</p>
                            <p className="font-bold text-red-500 dark:text-red-400 text-lg">{formatCurrency(editedData.subscription.balance)}</p>
                        </div>
                    </div>
                    <div className="mt-4">
                        <div className="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5"><div className="bg-gradient-to-r from-green-400 to-blue-500 h-2.5 rounded-full" style={{ width: `${progress}%` }}></div></div>
                        <p className="text-right text-xs mt-1 text-gray-600 dark:text-gray-400">{formatCurrency(paid)} Paid</p>
                    </div>
                </div>
                <div>
                    <h3 className="font-semibold text-gray-700 dark:text-gray-300 mb-3">Monthly Payments</h3>
                    <div className="grid grid-cols-3 sm:grid-cols-4 gap-2 text-sm">
                        {Object.keys(student.payments).map((month) => {
                            const paymentValue = editedData.payments[month];
                            return (
                                <div key={month} className="p-2 bg-gray-50 dark:bg-gray-700 rounded-md text-center">
                                    <p className="font-medium text-gray-500 dark:text-gray-400 text-xs truncate" title={monthNames[month]}>{month}</p>
                                    {isEditing ? (
                                        <input type="text" value={paymentValue || ''} onChange={(e) => handlePaymentChange(month, e.target.value)} className="font-semibold mt-1 p-1 border dark:border-gray-600 dark:bg-gray-600 dark:text-gray-100 rounded-md w-full text-center text-xs" />
                                    ) : (
                                        <>
                                            {paymentValue === 'FULL PAID' ? <span className="inline-block bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 text-xs font-semibold px-2.5 py-0.5 rounded-full mt-1">Paid</span> : paymentValue ? <p className="font-semibold text-gray-800 dark:text-gray-100 mt-1">{formatCurrency(paymentValue)}</p> : <p className="font-semibold text-gray-400 dark:text-gray-500 mt-1">-</p>}
                                        </>
                                    )}
                                </div>
                            );
                        })}
                    </div>
                </div>
            </div>
        </div>
    );
};

const StudentTableRow = ({ student, onUpdate, monthNames }) => {
    const [isEditing, setIsEditing] = useState(false);
    const [isExpanded, setIsExpanded] = useState(false);
    const [editedData, setEditedData] = useState(student);

    const perYear = parseFloat(student.subscription.perYear) || 0;
    const balance = parseFloat(editedData.subscription.balance) || 0;
    const paid = perYear - balance;
    const progress = perYear > 0 ? (paid / perYear) * 100 : (balance === 0 ? 100 : 0);

    useEffect(() => { setEditedData(student); }, [student]);

    const handleEditToggle = () => { setIsEditing(!isEditing); setEditedData(student); };
    
    const handleInputChange = (e) => {
        const { name, value } = e.target;
        const [field, subField] = name.split('.');
        setEditedData(prev => {
            let newEditedData = { ...prev };
            if (subField) {
                newEditedData = { ...prev, [field]: { ...prev[field], [subField]: value } };
            } else {
                newEditedData = { ...prev, [name]: value };
            }
            if (name === 'subscription.perYear') {
                const totalPaid = Object.values(newEditedData.payments).reduce((sum, amount) => !isNaN(parseFloat(amount)) ? sum + parseFloat(amount) : sum, 0);
                newEditedData.subscription.balance = String((parseFloat(value) || 0) - totalPaid);
            }
            return newEditedData;
        });
    };
    
    const handlePaymentChange = (month, value) => {
        setEditedData(prev => {
            const newPayments = { ...prev.payments, [month]: value };
            const totalPaid = Object.values(newPayments).reduce((sum, amount) => !isNaN(parseFloat(amount)) ? sum + parseFloat(amount) : sum, 0);
            const newBalance = (parseFloat(prev.subscription.perYear) || 0) - totalPaid;
            return { ...prev, payments: newPayments, subscription: { ...prev.subscription, balance: String(newBalance) }};
        });
    };
    
    const handleSave = () => {
        onUpdate(student.cicNumber, editedData);
        setIsEditing(false);
    };

    return (
        <>
            <tr className="border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700/50">
                <td className="px-5 py-4 text-sm">
                    <p className="text-gray-900 dark:text-gray-100 whitespace-no-wrap">{student.name}</p>
                    <p className="text-gray-600 dark:text-gray-400 whitespace-no-wrap text-xs">CIC: {student.cicNumber}</p>
                </td>
                <td className="px-5 py-4 text-sm text-gray-900 dark:text-gray-300">{isEditing ? <input type="text" name="contact" value={editedData.contact || ''} onChange={handleInputChange} className="p-2 border dark:border-gray-600 rounded-md w-full dark:bg-gray-700 dark:text-gray-100" /> : student.contact || '-'}</td>
                <td className="px-5 py-4 text-sm text-gray-900 dark:text-gray-300">{isEditing ? <input type="number" name="subscription.perYear" value={editedData.subscription.perYear} onChange={handleInputChange} className="p-2 border dark:border-gray-600 rounded-md w-24 text-right dark:bg-gray-700 dark:text-gray-100" /> : formatCurrency(student.subscription.perYear)}</td>
                <td className="px-5 py-4 text-sm font-semibold text-red-600 dark:text-red-400">{formatCurrency(editedData.subscription.balance)}</td>
                <td className="px-5 py-4 text-sm">
                    <div className="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2.5"><div className="bg-gradient-to-r from-green-400 to-blue-500 h-2.5 rounded-full" style={{ width: `${progress}%` }}></div></div>
                    <p className="text-right text-xs mt-1 text-gray-600 dark:text-gray-400">{Math.round(progress)}% Paid</p>
                </td>
                <td className="px-5 py-4 text-sm text-center">
                    <div className="flex items-center justify-center space-x-2">
                        {isEditing ? (
                            <>
                                <button onClick={handleSave} className="p-2 text-green-600 hover:bg-green-100 dark:hover:bg-green-900 rounded-full"><SaveIcon /></button>
                                <button onClick={handleEditToggle} className="p-2 text-red-600 hover:bg-red-100 dark:hover:bg-red-900 rounded-full"><CancelIcon /></button>
                            </>
                        ) : (
                            <button onClick={handleEditToggle} className="p-2 text-indigo-600 dark:text-indigo-400 hover:bg-indigo-100 dark:hover:bg-gray-700 rounded-full"><EditIcon /></button>
                        )}
                        <button onClick={() => setIsExpanded(!isExpanded)} className={`p-2 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-full transition-transform duration-300 ${isExpanded ? 'rotate-180' : ''}`}><ChevronDownIcon /></button>
                    </div>
                </td>
            </tr>
            {isExpanded && (
                <tr className="bg-gray-50 dark:bg-gray-800/50">
                    <td colSpan="7" className="p-4 border-t border-gray-200 dark:border-gray-700">
                        <h4 className="font-semibold text-gray-700 dark:text-gray-300 mb-3 text-sm">Monthly Payments</h4>
                        <div className="grid grid-cols-4 lg:grid-cols-6 gap-2 text-sm">
                            {Object.keys(student.payments).map((month) => {
                                const paymentValue = editedData.payments[month];
                                return (
                                    <div key={month} className="p-2 bg-white dark:bg-gray-700 border dark:border-gray-600 rounded-md text-center">
                                        <p className="font-medium text-gray-500 dark:text-gray-400 text-xs truncate" title={monthNames[month]}>{month}</p>
                                        {isEditing ? (
                                            <input type="text" value={paymentValue || ''} onChange={(e) => handlePaymentChange(month, e.target.value)} className="font-semibold mt-1 p-1 border dark:border-gray-500 rounded-md w-full text-center text-xs dark:bg-gray-600 dark:text-gray-100" />
                                        ) : (
                                            <>
                                                {paymentValue === 'FULL PAID' ? <span className="inline-block bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 text-xs font-semibold px-2 py-0.5 rounded-full mt-1">Paid</span> : paymentValue ? <p className="font-semibold text-gray-800 dark:text-gray-100 mt-1">{formatCurrency(paymentValue)}</p> : <p className="font-semibold text-gray-400 dark:text-gray-500 mt-1">-</p>}
                                            </>
                                        )}
                                    </div>
                                );
                            })}
                        </div>
                    </td>
                </tr>
            )}
        </>
    );
};

const StudentTable = ({ students, onUpdate, monthNames }) => (
    <div className="bg-white dark:bg-gray-800 shadow-md rounded-lg overflow-x-auto">
        <table className="min-w-full leading-normal">
            <thead>
                <tr className="bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 uppercase text-sm">
                    <th className="px-5 py-3 border-b-2 border-gray-200 dark:border-gray-700 text-left">Student</th>
                    <th className="px-5 py-3 border-b-2 border-gray-200 dark:border-gray-700 text-left">Contact</th>
                    <th className="px-5 py-3 border-b-2 border-gray-200 dark:border-gray-700 text-left">Total Fee</th>
                    <th className="px-5 py-3 border-b-2 border-gray-200 dark:border-gray-700 text-left">Balance</th>
                    <th className="px-5 py-3 border-b-2 border-gray-200 dark:border-gray-700 text-left">Progress</th>
                    <th className="px-5 py-3 border-b-2 border-gray-200 dark:border-gray-700 text-center">Actions</th>
                </tr>
            </thead>
            <tbody>{students.map(student => <StudentTableRow key={student.cicNumber} student={student} onUpdate={onUpdate} monthNames={monthNames}/>)}</tbody>
        </table>
    </div>
);

const AppLoader = () => (
    <div className="text-center py-16 bg-white dark:bg-gray-800 rounded-lg shadow-md flex justify-center items-center">
        <SpinnerIcon />
        <p className="text-gray-500 dark:text-gray-400 text-lg ml-2">Loading Students...</p>
    </div>
);


export default function FeesRegister() {
    const { fees, selectedBatch, isLoading, error, monthNames, batchNames, setSelectedBatch, fetchFees, updateFee } = useFeeStore();
    const [searchTerm, setSearchTerm] = useState('');
    const [isMobileView, setIsMobileView] = useState(window.innerWidth < 768);

    useEffect(() => {
        if (selectedBatch) {
            fetchFees(selectedBatch);
        }
    }, [selectedBatch, fetchFees]);

    useEffect(() => {
        const handleResize = () => setIsMobileView(window.innerWidth < 768);
        window.addEventListener('resize', handleResize);
        return () => window.removeEventListener('resize', handleResize);
    }, []);

    const filteredStudents = useMemo(() => {
        const currentBatchStudents = fees[selectedBatch] || [];
        if (!searchTerm) return currentBatchStudents;
        const lowerCaseSearchTerm = searchTerm.toLowerCase();
        return currentBatchStudents.filter(student =>
            student.name.toLowerCase().includes(lowerCaseSearchTerm) ||
            student.cicNumber.includes(searchTerm)
        )
    }, [fees, selectedBatch, searchTerm]);

    const handleBatchChange = (e) => {
        setSelectedBatch(e.target.value);
    };
    
    const renderContent = () => {
        const currentData = fees[selectedBatch];
        if (isLoading && !currentData) return <AppLoader />;
        if (error) return <div className="text-center py-16 bg-red-100 dark:bg-red-900/50 text-red-600 dark:text-red-300 rounded-lg shadow-md"><p>{error}</p></div>;
        if (filteredStudents.length === 0 && !isLoading) return <div className="text-center py-16 bg-white dark:bg-gray-800 rounded-lg shadow-md"><p className="text-gray-500 dark:text-gray-400 text-lg">No students found.</p></div>;

        return isMobileView ? (
            <div className="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8">
                {filteredStudents.map(student => <StudentCard key={student.cicNumber} student={student} onUpdate={updateFee} monthNames={monthNames}/>)}
            </div>
        ) : (
            <StudentTable students={filteredStudents} onUpdate={updateFee} monthNames={monthNames}/>
        );
    }

    return (
        <div className="bg-gray-100 dark:bg-gray-900 min-h-screen font-sans">
            <Header />
            <main className="p-4 sm:p-6 lg:p-8 mt-10">
            <div className="max-w-7xl mx-auto">
                <header className="mb-8 text-center">
                    <p className="text-gray-600 dark:text-gray-400 mt-2">Manage and track student fee payments.</p>
                </header>

                <div className="mb-8 max-w-2xl mx-auto flex flex-col sm:flex-row gap-4">
                    <div className="flex-shrink-0">
                        <select
                            value={selectedBatch}
                            onChange={handleBatchChange}
                            className="w-full sm:w-auto px-4 py-3 text-gray-700 bg-white border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-shadow dark:bg-gray-700 dark:text-gray-200 dark:border-gray-600"
                        >
                            {batchNames.map(batchName => <option key={batchName} value={batchName}>{batchName}</option>)}
                        </select>
                    </div>
                    <input
                        type="text"
                        placeholder="Search by name or CIC number..."
                        value={searchTerm}
                        onChange={(e) => setSearchTerm(e.target.value)}
                        className="w-full px-4 py-3 text-gray-700 bg-white border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-shadow dark:bg-gray-700 dark:text-gray-200 dark:border-gray-600"
                    />
                </div>
                
                {renderContent()}
                
            </div>
            </main>
        </div>
    );
}

================
File: frontend/src/pages/admin/InactiveStdList.jsx
================
import React, { useEffect, useState } from "react";
import Header from "../../components/Header";
import Footer from "../../components/Footer";
import StudentTable from "../../components/StudentTable";
import { AlertCircle, RefreshCw } from "lucide-react";
import { useStudentStore } from "../../store/studentStore";

const InactiveStdList = () => {
  const { getInactiveStudents, studentsInactive, isLoading } = useStudentStore();
  const [error, setError] = useState(null);

  useEffect(() => {
    const fetchStudents = async () => {
      try {
        await getInactiveStudents();
      } catch (err) {
        setError("Failed to fetch Books. Please try again.");
      }
    };
    fetchStudents();
  }, []);



  return (
    <div className="min-h-screen flex flex-col items-center bg-white dark:bg-gray-900 text-gray-900 dark:text-white">
      <Header user={true} />

      {isLoading ? (
        <div className="mt-10 text-center">
          <p className="text-gray-600 dark:text-gray-400">Loading...</p>
          <div className="animate-spin rounded-full h-8 w-8 border-t-2 border-gray-500"></div>
        </div>
      ) : error ? (
        <div className="flex flex-col items-center mt-10">
          <AlertCircle className="text-red-500 dark:text-red-400" size={48} />
          <p className="text-red-500 dark:text-red-400 mt-2">{error}</p>
          <button
            onClick={() => window.location.reload()}
            className="mt-4 px-4 py-2 bg-red-500 dark:bg-red-600 text-white rounded-lg flex items-center gap-2 hover:bg-red-600 dark:hover:bg-red-700 transition"
          >
            <RefreshCw size={16} />
            Retry
          </button>
        </div>
      ) : (
        <StudentTable students={studentsInactive} inactive={true} />
      )}

    </div>
  );
};


export default InactiveStdList;

================
File: frontend/src/pages/admin/IRMarkAdmin.jsx
================
import React, { useEffect, useState } from "react";
import { Eye, Pencil, Plus } from "lucide-react"; // or use Heroicons if preferred
import Header from "../../components/Header";
import { useNavigate } from "react-router-dom";
import { useAdminStore } from "../../store/useAdminMngStore";

const IRMarkAdmin = () => {
  const { batches, getBatches, addBatchIRmarklink } = useAdminStore();
  const [IRMarklistLink, setCeMarklistLink] = useState("");
  const [editingBatchId, setEditingBatchId] = useState(null);

  const navigate = useNavigate();

  useEffect(() => {
    getBatches();
  }, [getBatches]);

  const handleSubmit = async (batchId) => {
    const isValidLink = IRMarklistLink.includes("https://docs.google.com/spreadsheets");
    if (!isValidLink) return alert("Please enter a valid Google Sheets link.");

    try {
      await addBatchIRmarklink(IRMarklistLink, batchId);
      await getBatches();
      setEditingBatchId(null);
      setCeMarklistLink("");
    } catch (err) {
      console.error("Failed to update CE link", err);
    }
  };

  return (
    <>
      <Header />
      <div className="min-h-screen bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-900 dark:to-gray-800 p-6 pt-24">
        <h2 className="text-2xl font-extrabold text-gray-900 dark:text-white mb-4 ml-8 font-oswald">
          IR Mark Lists
        </h2>

        <div className="grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 px-2">
          {batches.map((batch, index) => (
            <div
              key={batch._id || index}
              className="bg-white dark:bg-gray-800 rounded-2xl shadow-md p-3 transition hover:shadow-xl"
            >
           <div className="flex items-center justify-between mb-1">
            <div className="flex items-center gap-3">
                <div className="w-10 h-10 rounded-full bg-sky-700 text-white flex items-center justify-center font-semibold">
                {index + 1}
                </div>
                <div className="text-lg font-semibold text-gray-800 dark:text-white">
                {batch.name}
                </div>
            </div>

            <div className="flex items-center gap-3">
                {!batch?.IRmarkList ? (
                <button
                    onClick={() => {
                    setEditingBatchId(batch._id);
                    setCeMarklistLink("");
                    }}
                    className="text-blue-600 hover:text-blue-800"
                    title="Add Link"
                >
                    <Plus size={20} />
                </button>
                ) : (
                <>
                    <button
                    onClick={() => {
                        setEditingBatchId(batch._id);
                        setCeMarklistLink(batch.IRmarkList || "");
                    }}
                    className="text-yellow-500 hover:text-yellow-600"
                    title="Edit Link"
                    >
                    <Pencil size={20} />
                    </button>
                    <a
                    href={batch.IRmarkList}
                    target="_blank"
                    rel="noopener noreferrer"
                    className="text-green-600 hover:text-green-700"
                    title="View Link"
                    >
                    <Eye size={20} />
                    </a>
                </>
                )}
            </div>
            </div>


           

              {/* Input Field */}
              {editingBatchId === batch._id && (
                <div className="mt-4">
                  <input
                    type="text"
                    value={IRMarklistLink}
                    onChange={(e) => setCeMarklistLink(e.target.value)}
                    placeholder="Paste Google Sheet link"
                    className="w-full border rounded-lg px-3 py-2 text-sm dark:bg-gray-700 dark:text-white"
                  />
                  <div className="flex justify-end mt-2 gap-2">
                    <button
                      onClick={() => handleSubmit(batch._id)}
                      className="bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 text-sm"
                    >
                      Save
                    </button>
                    <button
                      onClick={() => {
                        setEditingBatchId(null);
                        setCeMarklistLink("");
                      }}
                      className="text-sm text-gray-500 hover:text-gray-800"
                    >
                      Cancel
                    </button>
                  </div>
                </div>
              )}
            </div>
          ))}
        </div>
      </div>
    </>
  );
};

export default IRMarkAdmin;

================
File: frontend/src/pages/admin/RegisterdStudents.jsx
================
import React, { useEffect, useState } from "react";
import { useRegisterdStudentStore } from "../../store/useRegisterdStudentStore";
import Header from "../../components/Header";

const RegisterdStudents = () => {
  const [openDetails, setOpenDetails] = useState({});
  const { getRegisteredStudents, filteredStudents: students, isLoading, selectStudent, filteringBatch } = useRegisterdStudentStore();

    const [selectedBatch, setSelectedBatch] = useState("All Batch");

    const handleChange = (event) => {
      const value = event.target.value;
      setSelectedBatch(value);
      filteringBatch(value); 
    };
  useEffect(() => {
    getRegisteredStudents();
  }, [getRegisteredStudents]);

  const toggleDetails = (index) => {
    setOpenDetails((prev) => ({ ...prev, [index]: !prev[index] }));
  };

  const handleSelect = async (studentId, isSelected) => {
    await selectStudent(studentId, isSelected);
    getRegisteredStudents(); 
  };
  

  return (
    <div className="min-h-screen overflow-x-auto bg-white dark:bg-gray-900 text-gray-900 dark:text-white p-4">
      <Header page={"Registered Students"} />
      <select value={selectedBatch} onChange={handleChange} className="select select-md mt-14  bg-white dark:bg-gray-900 text-gray-900 dark:text-white ">
      <option>All Batch</option>
      <option>1</option>
      <option>2</option>
      <option>3</option>
      <option>4</option>
      <option>5</option>
      <option>6</option>
      <option>7</option>
      <option>8</option>
      <option>9</option>
      <option>10</option>
    </select>
      <table className="table w-full border border-gray-300 dark:border-gray-700 mt-2 ">
        {/* Table Head */}
        <thead className="bg-gray-100 dark:bg-gray-800">
          <tr>
            <th className="hidden md:table-cell">Profile</th>
            <th>Name</th>
            <th className="hidden md:table-cell">Phone</th>
            <th>Batch</th>
            <th className="hidden md:table-cell">Gender</th>
            <th className="hidden md:table-cell">DOB</th>
            <th>Details</th>
            <th>Action</th> {/* New Action Column */}
          </tr>
        </thead>

        {/* Table Body */}
        <tbody>
          {students && students.length > 0 ? (
            students.map((student, index) => (
              <React.Fragment key={student._id}>
                {/* Main Row */}
                <tr
                  className={`border-b dark:border-gray-700 ${
                    student.selected ? "bg-green-100 dark:bg-green-900" : ""
                  }`} // Highlight selected students
                >
                  <td className="hidden md:table-cell">
                    <img
                      src={student.profileImage || "https://img.daisyui.com/images/profile/demo/placeholder.webp"}
                      alt="Profile"
                      className="w-10 h-10 rounded-full"
                    />
                  </td>
                  <td>
                    <div className="flex items-center gap-3">
                      <div>
                        <div className="font-bold">{student.studentName}</div>
                      </div>
                    </div>
                  </td>
                  <td className="hidden md:table-cell">{student.phoneNumber}</td>
                  <td>{student.selectedBatch}</td>
                  <td className="hidden md:table-cell">{student.gender}</td>
                  <td className="hidden md:table-cell">{student.dateOfBirth}</td>
                  <td>
                    <button
                      className="btn btn-ghost btn-xs dark:text-gray-200"
                      onClick={() => toggleDetails(index)}
                    >
                      Details
                    </button>
                  </td>
                  {/* Action Column */}
                  <td>
                    {student.isSelected ? (
                      <button className="btn btn-xs btn-active text-white bg-green-500 dark:bg-green-700">
                        Selected
                      </button>
                    ) : (
                      <button
                        className="btn btn-xs btn-outline dark:border-gray-400 dark:text-gray-200"
                        onClick={() => handleSelect(student._id, true)}
                      >
                        Select
                      </button>
                    )}
                  </td>
                </tr>

                {/* Collapsible Details Row for Mobile */}
                {openDetails[index] && (
                  <tr className="md:hidden">
                    <td colSpan="9">
                      <div className="p-4 border rounded-lg bg-gray-50 dark:bg-gray-800 dark:text-white">
                        <p>
                          <span className="font-bold">Phone: </span>
                          {student.phoneNumber}
                        </p>
                        <p>
                          <span className="font-bold">Gender: </span>
                          {student.gender}
                        </p>
                        <p>
                          <span className="font-bold">DOB: </span>
                          {student.dateOfBirth}
                        </p>
                        <p>
                          <span className="font-bold">Profile: </span>
                          <img
                            src={student.profileImage || "https://img.daisyui.com/images/profile/demo/placeholder.webp"}
                            alt="Profile"
                            className="w-10 h-10 rounded-full inline"
                          />
                        </p>
                      </div>
                    </td>
                  </tr>
                )}
              </React.Fragment>
            ))
          ) : (
            <tr>
              <td colSpan="9" className="text-center p-4">
                No students registered.
              </td>
            </tr>
          )}
        </tbody>
      </table>
    </div>
  );
};

export default RegisterdStudents;

================
File: frontend/src/pages/admin/StudentForm.jsx
================
import { useEffect, useState } from "react";
import { useStudentStore } from "../../store/studentStore";
import { Loader2, User, Layers, Hash, CheckCircle2 } from "lucide-react";
import { useParams } from "react-router-dom";
import toast from "react-hot-toast";
import Header from "../../components/Header";
import InputField from "../../components/InputField";
import SelectField from "../../components/SelectField";
import axios from "axios";

const StudentForm = (props) => {
  const { id } = useParams();
  const { registerStudent, isRegistering, editStudent } = useStudentStore();
  const [formData, setFormData] = useState({
    studentName: "",
    selectedBatch: "",
    rollNumber: "",
    gender: "",
    studentId: ""
  });

  // Fetch logic remains same
  useEffect(() => {
    const fetchUser = async (id) => {
      try {
        const hostname = window.location.hostname;
        const response = await axios.get(`http://${hostname}:5000/api/users/${id}`);
        setFormData({ ...response.data.user });
      } catch (error) {
        console.error("Error fetching user:", error);
      }
    };
    if (id) fetchUser(id);
  }, [id]);

  const validateForm = () => {
    if (!formData.studentName.trim()) return toast.error("Student name is required");
    if (!formData.selectedBatch) return toast.error("Batch is required");
    if (!formData.rollNumber) return toast.error("Roll number is required");
    if (!formData.gender) return toast.error("Gender is required");
    return true;
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    if (validateForm()) {
      const classMap = {
        1: "A", 2: "B", 3: "C", 4: "D", 5: "E",
        6: "F", 7: "G", 8: "H", 9: "I", 10: "J"
      };
      const classPrefix = classMap[Number(formData.selectedBatch)] || "X";
      const genderPrefix = formData.gender === "Male" ? "B" : "G";
      const studentId = `${classPrefix}${genderPrefix}${formData.rollNumber}`;
  
      const updatedFormData = { ...formData, studentId };
      
      if (props.edit) {
        editStudent(updatedFormData);
      } else {
        registerStudent(updatedFormData); 
      }
    }
  };

  const handleInputChange = (field, value) => {
    setFormData(prev => ({ ...prev, [field]: value }));
  };

  return (
    <div className="min-h-screen bg-slate-50 dark:bg-surface-dark pb-20">
      <Header page={props.edit ? "Edit Registration" : "Quick Register"} />
      
      <div className="flex items-center justify-center min-h-[80vh] px-4">
        <div className="w-full max-w-md">
          
          <div className="text-center mb-8">
            <h1 className="text-2xl font-bold text-slate-800 dark:text-white">
              {props.edit ? "Update Student" : "Quick Registration"}
            </h1>
            <p className="text-slate-500 dark:text-slate-400">
              Basic student details entry.
            </p>
          </div>

          <div className="bg-white dark:bg-slate-800 rounded-3xl shadow-xl border border-slate-200 dark:border-slate-700 p-8">
            <form onSubmit={handleSubmit} className="space-y-6">
              
              <InputField 
                label="Student Name" 
                name="studentName" 
                value={formData.studentName} 
                icon={<User size={18} />} 
                onChange={(val) => handleInputChange("studentName", val)} 
              />
              
              <div className="grid grid-cols-2 gap-4">
                <SelectField 
                  label="Batch" 
                  name="selectedBatch" 
                  value={formData.selectedBatch} 
                  options={[1,2,3,4,5,6,7,8,9,10]} 
                  icon={<Layers size={18} />} 
                  onChange={(val) => handleInputChange("selectedBatch", val)} 
                />
                <SelectField 
                  label="Roll No" 
                  name="rollNumber" 
                  value={formData.rollNumber} 
                  options={Array.from({length: 60}, (_, i) => i + 1)} 
                  icon={<Hash size={18} />} 
                  onChange={(val) => handleInputChange("rollNumber", val)} 
                />
              </div>
              
              {/* Gender Selection */}
              <div>
                <label className="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">Gender</label>
                <div className="flex gap-4">
                  {["Male", "Female"].map((gender) => (
                    <button
                      key={gender}
                      type="button"
                      className={`flex-1 py-3 rounded-xl border font-medium transition-all ${
                        formData.gender === gender 
                          ? "bg-primary-50 border-primary-500 text-primary-700 dark:bg-primary-900/20 dark:text-primary-300" 
                          : "border-slate-200 dark:border-slate-600 text-slate-500 hover:bg-slate-50 dark:hover:bg-slate-700"
                      }`}
                      onClick={() => setFormData({ ...formData, gender })}
                    >
                      {gender}
                    </button>
                  ))}
                </div>
              </div>

              <button 
                type="submit" 
                className="w-full btn py-3.5 rounded-xl bg-primary-600 hover:bg-primary-700 text-white font-semibold shadow-lg shadow-primary-500/20 flex items-center justify-center gap-2"
                disabled={isRegistering}
              >
                {isRegistering ? <Loader2 className="animate-spin" /> : <CheckCircle2 size={20} />}
                {props.edit ? "Update" : "Register"}
              </button>
            </form>
          </div>

        </div>
      </div>
    </div>
  );
};

export default StudentForm;

================
File: frontend/src/pages/admin/TimetableAsigment.jsx
================
import React, { useEffect, useState } from "react";
import { DndProvider, useDrag, useDrop } from "react-dnd";
import { HTML5Backend } from "react-dnd-html5-backend";
import { useStaffStore } from "../../store/useStaffStore";
import { useAdminStore } from "../../store/useAdminMngStore";
import { axiosInstance } from "../../lib/axios.js";
import { Loader2, Calendar, GripVertical, Save, Trash2 } from "lucide-react";
import toast from "react-hot-toast";

const weekdays = ["Monday", "Tuesday", "Wednesday", "Thursday", "Saturday", "Sunday"];

// --- Styled Draggable Component ---
const DraggableTeacher = ({ name }) => {
  const [{ isDragging }, drag] = useDrag(() => ({
    type: "teacher",
    item: { name },
    collect: (monitor) => ({
      isDragging: !!monitor.isDragging(),
    }),
  }));

  return (
    <div
      ref={drag}
      className={`
        flex items-center gap-2 p-3 bg-white dark:bg-slate-700 rounded-xl shadow-sm border border-slate-200 dark:border-slate-600 
        cursor-grab active:cursor-grabbing hover:border-primary-500 hover:shadow-md transition-all
        ${isDragging ? "opacity-50 scale-95" : "opacity-100"}
      `}
    >
      <div className="p-1.5 bg-indigo-50 dark:bg-indigo-900/30 rounded-lg text-indigo-600 dark:text-indigo-400">
        <GripVertical size={16} />
      </div>
      <span className="font-medium text-sm text-slate-700 dark:text-slate-200">{name}</span>
    </div>
  );
};

// --- Styled Drop Zone ---
const DroppableBox = ({ onDrop, assignedTeacher, onClear }) => {
  const [{ isOver }, drop] = useDrop(() => ({
    accept: "teacher",
    drop: (item) => onDrop(item.name),
    collect: (monitor) => ({
      isOver: !!monitor.isOver(),
    }),
  }));

  return (
    <div
      ref={drop}
      className={`
        relative h-20 rounded-xl border-2 border-dashed flex items-center justify-center transition-all duration-200
        ${isOver 
          ? "border-emerald-500 bg-emerald-50 dark:bg-emerald-900/20 scale-105 shadow-lg z-10" 
          : assignedTeacher 
            ? "border-primary-200 dark:border-slate-600 bg-primary-50 dark:bg-slate-800" 
            : "border-slate-200 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-800/30"}
      `}
    >
      {assignedTeacher ? (
        <div className="flex flex-col items-center group w-full h-full justify-center">
          <span className="text-xs font-bold text-primary-700 dark:text-primary-300 bg-white dark:bg-slate-700 px-3 py-1 rounded-full shadow-sm">
            {assignedTeacher}
          </span>
          <button 
            onClick={(e) => { e.stopPropagation(); onClear(); }}
            className="absolute top-1 right-1 p-1 text-rose-400 hover:text-rose-600 opacity-0 group-hover:opacity-100 transition-opacity"
          >
            <Trash2 size={14} />
          </button>
        </div>
      ) : (
        <span className="text-xs text-slate-400 font-medium">Drop Here</span>
      )}
    </div>
  );
};

const TimetableAssignment = () => {
  const { getTeachers, teachers } = useStaffStore();
  const { getBatches, batches } = useAdminStore();
  const [day, setDay] = useState("Monday");
  const [grid, setGrid] = useState({});
  const [isLoading, setIsLoading] = useState(true);
  const [saving, setSaving] = useState(false);
  const [periods] = useState(3); 

  useEffect(() => {
    const init = async () => {
      await Promise.all([getTeachers(), getBatches()]);
      await fetchTimetable();
    };
    init();
  }, []);

  useEffect(() => {
    if (batches.length > 0 && !grid[day]) {
      const defaultDayGrid = Array.from({ length: periods }, () =>
        Object.fromEntries(batches.map((b) => [b.name, null]))
      );
      setGrid((prev) => ({ ...prev, [day]: defaultDayGrid }));
    }
  }, [day, batches]);

  const fetchTimetable = async () => {
    try {
      const res = await axiosInstance.get("/mng/timetable");
      if (res.data.grid) setGrid(res.data.grid);
    } catch (error) {
      console.error(error);
      toast.error("Failed to load timetable");
    } finally {
      setIsLoading(false);
    }
  };

  const handleSave = async () => {
    setSaving(true);
    try {
      await axiosInstance.post("/mng/timetable", { grid });
      toast.success("Timetable saved successfully!");
    } catch (error) {
      toast.error("Save failed");
    } finally {
      setSaving(false);
    }
  };

  const handleDrop = (targetDay, periodIndex, batchName, teacher) => {
    setGrid((prevGrid) => {
      const dayGrid = [...(prevGrid[targetDay] || [])];
      const periodRow = { ...dayGrid[periodIndex] };

      // Conflict Check: Is teacher already in this row?
      const isBusy = Object.values(periodRow).includes(teacher);
      if (isBusy) {
        toast.error(`${teacher} is already assigned in this period!`);
        return prevGrid;
      }

      periodRow[batchName] = teacher;
      dayGrid[periodIndex] = periodRow;
      return { ...prevGrid, [targetDay]: dayGrid };
    });
  };

  const handleClear = (targetDay, periodIndex, batchName) => {
    setGrid((prevGrid) => {
      const dayGrid = [...(prevGrid[targetDay] || [])];
      const periodRow = { ...dayGrid[periodIndex] };
      periodRow[batchName] = null;
      dayGrid[periodIndex] = periodRow;
      return { ...prevGrid, [targetDay]: dayGrid };
    });
  };

  if (isLoading) return <div className="flex justify-center py-20"><Loader2 className="animate-spin" /></div>;

  const currentGrid = grid[day] || [];

  return (
    <DndProvider backend={HTML5Backend}>
      <div className="bg-slate-50 dark:bg-slate-900/50 rounded-3xl p-6 border border-slate-200 dark:border-slate-700">
        
        {/* Header Control */}
        <div className="flex flex-col md:flex-row justify-between items-center gap-6 mb-8">
          <div>
            <h2 className="text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2">
              <Calendar className="text-primary-500" /> Timetable Scheduler
            </h2>
            <p className="text-sm text-slate-500">Drag teachers to assign periods.</p>
          </div>

          <div className="flex bg-white dark:bg-slate-800 p-1 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-x-auto max-w-full">
            {weekdays.map((d) => (
              <button
                key={d}
                onClick={() => setDay(d)}
                className={`px-4 py-2 rounded-lg text-sm font-medium transition-all whitespace-nowrap
                  ${day === d 
                    ? "bg-primary-600 text-white shadow-md" 
                    : "text-slate-500 hover:text-slate-900 dark:hover:text-white hover:bg-slate-100 dark:hover:bg-slate-700"}
                `}
              >
                {d}
              </button>
            ))}
          </div>

          <button
            onClick={handleSave}
            disabled={saving}
            className="flex items-center gap-2 px-5 py-2.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-bold shadow-lg shadow-emerald-500/20 transition-all disabled:opacity-70"
          >
            {saving ? <Loader2 className="animate-spin" size={18} /> : <Save size={18} />}
            Save Changes
          </button>
        </div>

        <div className="grid grid-cols-1 lg:grid-cols-4 gap-8">
          
          {/* Teachers Sidebar */}
          <div className="lg:col-span-1 bg-white dark:bg-slate-800 p-4 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700 h-fit max-h-[600px] overflow-y-auto">
            <h3 className="font-bold text-slate-700 dark:text-slate-300 mb-4 px-2">Available Teachers</h3>
            <div className="space-y-2">
              {teachers.map((teacher) => (
                <DraggableTeacher key={teacher._id} name={teacher.name} />
              ))}
            </div>
          </div>

          {/* Grid Area */}
          <div className="lg:col-span-3 overflow-x-auto">
            <div className="min-w-[600px]">
              {/* Grid Header */}
              <div className="grid grid-flow-col auto-cols-fr gap-4 mb-4">
                <div className="w-16 flex items-center justify-center font-bold text-slate-400">#</div>
                {batches.map((batch) => (
                  <div key={batch.name} className="bg-slate-100 dark:bg-slate-800 p-3 rounded-xl text-center font-bold text-slate-700 dark:text-slate-200 shadow-sm border border-slate-200 dark:border-slate-700">
                    {batch.name}
                  </div>
                ))}
              </div>

              {/* Grid Rows */}
              <div className="space-y-4">
                {currentGrid.map((periodRow, periodIndex) => (
                  <div key={periodIndex} className="grid grid-flow-col auto-cols-fr gap-4 items-center">
                    {/* Period Label */}
                    <div className="w-16 h-12 flex items-center justify-center bg-white dark:bg-slate-800 rounded-full font-display font-bold text-lg text-primary-500 shadow-sm border border-slate-200 dark:border-slate-700">
                      {periodIndex + 1}
                    </div>

                    {/* Drop Slots */}
                    {batches.map((batch) => (
                      <DroppableBox
                        key={batch.name}
                        assignedTeacher={periodRow[batch.name]}
                        onDrop={(teacher) => handleDrop(day, periodIndex, batch.name, teacher)}
                        onClear={() => handleClear(day, periodIndex, batch.name)}
                      />
                    ))}
                  </div>
                ))}
              </div>
            </div>
          </div>

        </div>
      </div>
    </DndProvider>
  );
};

export default TimetableAssignment;

================
File: frontend/src/pages/NotFound.jsx
================
import { Link } from "react-router-dom";

const NotFound = () => {
  return (
    <div className="flex flex-col items-center justify-center h-screen text-center">
      <h1 className="text-5xl font-bold text-red-600">404</h1>
      <h2 className="text-2xl font-semibold mt-2">Page Not Found</h2>
      <p className="text-gray-500 mt-2">
        The page you are looking for does not exist.
      </p>
      <Link
        to="/"
        className="mt-4 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition"
      >
        Go Back Home
      </Link>
    </div>
  );
};

export default NotFound;

================
File: frontend/src/pages/staff/AttendancePage.jsx
================
import React, { useEffect, useState } from "react";
import { motion, AnimatePresence } from "framer-motion";
import { useStudentStore } from "../../store/studentStore";
import { useStaffStore } from "../../store/useStaffStore";
import Header from "../../components/Header";
import { useParams } from "react-router-dom";
import { Calendar, Save, CheckCircle, XCircle, Search, Loader2 } from "lucide-react";
import toast from "react-hot-toast";

const AttendancePage = () => {
  let { classname } = useParams();
  classname = decodeURIComponent(classname);
  const [selectedTab, setSelectedTab] = useState("take");

  return (
    <div className="min-h-screen bg-slate-50 dark:bg-surface-dark pb-20">
      <Header page={"Attendance Register"} />
      
      <div className="max-w-7xl mx-auto px-4 mt-8">
        <div className="flex flex-col sm:flex-row justify-between items-center mb-8 gap-4">
          <div>
            <h1 className="text-3xl font-display font-bold text-slate-900 dark:text-white">
              Attendance: <span className="text-primary-600">{classname}</span>
            </h1>
            <p className="text-slate-500 dark:text-slate-400">Manage daily logs and view monthly reports.</p>
          </div>

          <div className="flex bg-white dark:bg-slate-800 p-1.5 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm">
            {["take", "history"].map((tab) => (
              <button
                key={tab}
                onClick={() => setSelectedTab(tab)}
                className={`px-6 py-2 rounded-lg text-sm font-bold transition-all ${
                  selectedTab === tab
                    ? "bg-primary-600 text-white shadow-md"
                    : "text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"
                }`}
              >
                {tab === "take" ? "Mark Today" : "View History"}
              </button>
            ))}
          </div>
        </div>

        <AnimatePresence mode="wait">
          {selectedTab === "take" ? (
            <motion.div 
              key="take"
              initial={{ opacity: 0, y: 10 }}
              animate={{ opacity: 1, y: 0 }}
              exit={{ opacity: 0, y: -10 }}
            >
              <DayAttendance classname={classname} />
            </motion.div>
          ) : (
            <motion.div 
              key="history"
              initial={{ opacity: 0, y: 10 }}
              animate={{ opacity: 1, y: 0 }}
              exit={{ opacity: 0, y: -10 }}
            >
              <MonthAttendance classname={classname} />
            </motion.div>
          )}
        </AnimatePresence>
      </div>
    </div>
  );
};

// --- Sub-Component: Mark Daily Attendance ---
const DayAttendance = ({ classname }) => {
  const { getStudents, students } = useStudentStore();
  const { getBatch, batches, isLoading, submitAttendance } = useStaffStore();
  const [attendance, setAttendance] = useState([]);
  const [date, setDate] = useState(new Date().toISOString().split("T")[0]);
  const [searchTerm, setSearchTerm] = useState("");
  const [isSubmitting, setIsSubmitting] = useState(false);

  useEffect(() => { if (!batches.length) getBatch(); }, []);
  useEffect(() => { if (!students.length) getStudents(); }, []);

  useEffect(() => {
    if (classname && batches.length > 0 && students.length > 0) {
      const classData = batches.find((c) => c.name === classname);
      if (classData) {
        const studentDetails = students.filter((student) =>
          classData.students.includes(student._id)
        );
        // Default to Absent (false) or Present (true)? Usually Present is better UX.
        // Let's stick to your logic (false default) or switch to true.
        setAttendance(studentDetails.map((s) => ({ ...s, present: true }))); 
      }
    }
  }, [classname, batches, students]);

  const togglePresence = (id) => {
    setAttendance(prev => prev.map(s => s.studentId === id ? { ...s, present: !s.present } : s));
  };

  const handleSubmit = async () => {
    setIsSubmitting(true);
    let obj = {};
    attendance.forEach((s) => { obj[s.studentId] = s.present; });
    
    if (Object.keys(obj).length > 0) {
      // Find class ID again
      const classData = batches.find((c) => c.name === classname);
      await submitAttendance(classData._id, obj, date);
      toast.success("Attendance submitted successfully");
    }
    setIsSubmitting(false);
  };

  const filtered = attendance.filter(s => s.studentName.toLowerCase().includes(searchTerm.toLowerCase()));
  const presentCount = attendance.filter(s => s.present).length;

  if (isLoading) return <div className="flex justify-center py-20"><Loader2 className="animate-spin text-primary-600" size={32} /></div>;

  return (
    <div className="space-y-6">
      {/* Controls */}
      <div className="flex flex-col sm:flex-row gap-4 justify-between bg-white dark:bg-slate-800 p-4 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700">
        <div className="flex items-center gap-4">
          <div className="relative">
            <input 
              type="date" 
              value={date} 
              onChange={(e) => setDate(e.target.value)}
              className="pl-10 pr-4 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-primary-500 outline-none"
            />
            <Calendar className="absolute left-3 top-2.5 text-slate-400" size={18} />
          </div>
          <div className="text-sm font-medium">
            <span className="text-emerald-600">Present: {presentCount}</span>
            <span className="mx-2 text-slate-300">|</span>
            <span className="text-rose-600">Absent: {attendance.length - presentCount}</span>
          </div>
        </div>

        <div className="relative w-full sm:w-64">
          <Search className="absolute left-3 top-2.5 text-slate-400" size={18} />
          <input 
            placeholder="Search student..." 
            value={searchTerm}
            onChange={e => setSearchTerm(e.target.value)}
            className="w-full pl-10 pr-4 py-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl outline-none focus:ring-2 focus:ring-primary-500"
          />
        </div>
      </div>

      {/* Grid */}
      <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
        {filtered.map((student) => (
          <motion.div
            key={student.studentId}
            layout
            initial={{ opacity: 0, scale: 0.9 }}
            animate={{ opacity: 1, scale: 1 }}
            onClick={() => togglePresence(student.studentId)}
            className={`cursor-pointer p-4 rounded-2xl border-2 transition-all duration-200 flex flex-col items-center justify-center text-center gap-2 relative overflow-hidden group
              ${student.present 
                ? "bg-white dark:bg-slate-800 border-emerald-500/50 shadow-sm hover:border-emerald-500" 
                : "bg-rose-50 dark:bg-rose-900/20 border-rose-500 shadow-md"}
            `}
          >
            <div className={`absolute top-2 right-2 transition-colors ${student.present ? "text-emerald-500" : "text-rose-500"}`}>
              {student.present ? <CheckCircle size={20} /> : <XCircle size={20} />}
            </div>
            
            <div className={`w-16 h-16 rounded-full border-2 p-0.5 ${student.present ? "border-emerald-200" : "border-rose-200"}`}>
               <img 
                 src={student.profileImage || `https://api.dicebear.com/7.x/initials/svg?seed=${student.studentName}`} 
                 className="w-full h-full rounded-full object-cover" 
                 alt=""
               />
            </div>
            
            <div>
              <h3 className="font-bold text-slate-900 dark:text-white text-sm line-clamp-1">{student.studentName}</h3>
              <p className="text-xs text-slate-500">Roll: {student.rollNumber}</p>
            </div>
          </motion.div>
        ))}
      </div>

      {/* Footer */}
      <div className="fixed bottom-6 right-6 z-30">
        <button
          onClick={handleSubmit}
          disabled={isSubmitting}
          className="flex items-center gap-2 px-8 py-4 bg-slate-900 dark:bg-white text-white dark:text-slate-900 rounded-full font-bold shadow-2xl hover:scale-105 active:scale-95 transition-all disabled:opacity-70"
        >
          {isSubmitting ? <Loader2 className="animate-spin" /> : <Save size={20} />}
          Submit Attendance
        </button>
      </div>
    </div>
  );
};

// --- Sub-Component: History View ---
const MonthAttendance = ({ classname }) => {
  const [month, setMonth] = useState(new Date().toLocaleString('default', { month: 'long' }));
  const { getBatch, batches } = useStaffStore();
  const [selectedBatch, setSelectedBatch] = useState({});
  const [monthData, setMonthData] = useState({});
  const [students, setStudents] = useState([]);

  useEffect(() => {
    getBatch();
  }, []);

  useEffect(() => {
    const found = batches.find((c) => c.name === classname);
    setSelectedBatch(found || {});
  }, [batches, classname]);

  useEffect(() => {
    if (selectedBatch?.attendance) {
      const data = selectedBatch.attendance[month] || {};
      setMonthData(data);
      // Extract student names from the first day found (assuming consistent)
      const firstDay = Object.keys(data)[0];
      if (firstDay) {
        setStudents(Object.keys(data[firstDay]));
      }
    }
  }, [selectedBatch, month]);

  const days = Object.keys(monthData).sort((a,b) => Number(a) - Number(b));

  return (
    <div className="bg-white dark:bg-slate-800 rounded-3xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden">
      <div className="p-6 border-b border-slate-200 dark:border-slate-700 flex justify-between items-center bg-slate-50 dark:bg-slate-900/50">
        <h3 className="font-bold text-lg text-slate-800 dark:text-white">Monthly Report</h3>
        <select 
          value={month} 
          onChange={(e) => setMonth(e.target.value)}
          className="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg px-4 py-2 text-sm focus:ring-2 focus:ring-primary-500 outline-none"
        >
          {selectedBatch?.attendance && Object.keys(selectedBatch.attendance).map(m => (
            <option key={m} value={m}>{m}</option>
          ))}
        </select>
      </div>

      <div className="overflow-x-auto">
        <table className="w-full text-sm text-left">
          <thead>
            <tr className="bg-white dark:bg-slate-800 border-b border-slate-100 dark:border-slate-700">
              <th className="px-4 py-3 min-w-[150px] font-bold text-slate-900 dark:text-white sticky left-0 bg-white dark:bg-slate-800 z-10">
                Student Name
              </th>
              {days.map(day => (
                <th key={day} className="px-2 py-3 text-center min-w-[40px] text-slate-500">
                  {day}
                </th>
              ))}
              <th className="px-4 py-3 text-center font-bold text-primary-600">%</th>
            </tr>
          </thead>
          <tbody className="divide-y divide-slate-100 dark:divide-slate-700">
            {students.map(studentName => {
              let presentCount = 0;
              return (
                <tr key={studentName} className="hover:bg-slate-50 dark:hover:bg-slate-700/30">
                  <td className="px-4 py-3 font-medium text-slate-800 dark:text-slate-200 sticky left-0 bg-white dark:bg-slate-800 z-10 shadow-sm md:shadow-none">
                    {studentName}
                  </td>
                  {days.map(day => {
                    const isPresent = monthData[day][studentName];
                    if (isPresent) presentCount++;
                    return (
                      <td key={day} className="px-2 py-3 text-center">
                        <div className={`w-2 h-2 mx-auto rounded-full ${isPresent ? "bg-emerald-500" : "bg-rose-500"}`}></div>
                      </td>
                    );
                  })}
                  <td className="px-4 py-3 text-center font-bold text-slate-700 dark:text-slate-300">
                    {days.length > 0 ? Math.round((presentCount / days.length) * 100) : 0}%
                  </td>
                </tr>
              );
            })}
          </tbody>
        </table>
      </div>
    </div>
  );
};

export default AttendancePage;

================
File: frontend/src/pages/staff/StaffAcademicRegister.jsx
================
import React from 'react';
import { motion } from 'framer-motion';
import Header from "../../components/Header";
import Card from "../../components/Card";
import { Users, GraduationCap, Settings2Icon, LineChart, MousePointer2, ListTodo, LucideCopySlash, ArchiveIcon, ClipboardList, Award, ClipboardCheck, HandCoins, Medal,  } from "lucide-react";

const AcademicRegister = () => {
  const cards = [
    { title: "Students' Leave Status", icon: ClipboardList , route: "/dashboard/teacher/std-attendance-register" },
    { title: "Teachers' Attendance Register", icon: ListTodo, route: "/dashboard/teacher/staff-attendance-register" },
    { title: "Quarterly Subject Status", icon: GraduationCap, route: "/dashboard/teacher/subject-status" },
    { title: "CE Status", icon: Award, route: "/dashboard/teacher/ce-status" }
  ];

  return (
    <div className="min-h-screen flex flex-col items-center bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-900 dark:to-gray-800">
      <Header />
      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-20 w-full max-w-4xl p-4">
        {cards.map((card, index) => (
          <motion.div
          key={index}
            initial={{ opacity: 0, y: 50 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ type: "spring", stiffness: 100, damping: 10, delay: index * 0.1 }}
          >
            <Card title={card.title} icon={card.icon} route={card.route} />
          </motion.div>


    
      

        ))}
      </div>
    </div>
  );
};

export default AcademicRegister

================
File: frontend/src/pages/staff/TeacherAddGraceMark.jsx
================
import React from 'react'

const TeacherAddGraceMark = () => {
  return (
    <div>TeacherAddGraceMark</div>
  )
}

export default TeacherAddGraceMark

================
File: frontend/src/pages/student/AchivementPage.jsx
================
"use client"

import { useState, useEffect } from "react"
import { useAchievement } from "../../store/achivemnetStore"
import LoadingSpinner from "../../components/LoadingSpinner"
import StatsCards from "../../components/StatsCards"
import AchievementForm from "../../components/AchievementForm"
import EmptyState from "../../components/EmptyState"
import AchievementCard from "../../components/AchievementCard"
import Header from "../../components/Header"


const AchievementPage = () => {
  const { achievements, isLoading, getStdAchievements, addAchievement, updateAchievement } = useAchievement()
  const [showForm, setShowForm] = useState(false)
  const [editingAchievement, setEditingAchievement] = useState(null)
  const [searchTerm, setSearchTerm] = useState("")
  const [filterStatus, setFilterStatus] = useState("all")
  const [sortBy, setSortBy] = useState("newest")

  useEffect(() => {
    getStdAchievements()
  }, [getStdAchievements])

  const handleAddAchievement = async (achievementData) => {
    try {
      await addAchievement(achievementData)
      setShowForm(false)
    } catch (error) {
      console.error("Error adding achievement:", error)
    }
  }

  const handleUpdateAchievement = async (achievementData) => {
    try {
      await updateAchievement(editingAchievement._id, achievementData)
      setEditingAchievement(null)
    } catch (error) {
      console.error("Error updating achievement:", error)
    }
  }

  const handleEditClick = (achievement) => {
    setEditingAchievement(achievement)
    setShowForm(true)
  }

  const handleCancelEdit = () => {
    setEditingAchievement(null)
    setShowForm(false)
  }

  const filteredAndSortedAchievements =
    achievements
      ?.filter((achievement) => {
        const matchesSearch =
          achievement.achievedItem?.toLowerCase().includes(searchTerm.toLowerCase()) ||
          achievement.agencyLevel?.toLowerCase().includes(searchTerm.toLowerCase()) ||
          achievement.placeOrRank?.toLowerCase().includes(searchTerm.toLowerCase())

        const matchesStatus =
          filterStatus === "all" ||
          (filterStatus === "approved" && achievement.approval) ||
          (filterStatus === "pending" && !achievement.approval)

        return matchesSearch && matchesStatus
      })
      ?.sort((a, b) => {
        switch (sortBy) {
          case "newest":
            return new Date(b.createdAt) - new Date(a.createdAt)
          case "oldest":
            return new Date(a.createdAt) - new Date(b.createdAt)
          case "achievement":
            return a.achievedItem.localeCompare(b.achievedItem)
          default:
            return 0
        }
      }) || []

  if (isLoading) {
    return <LoadingSpinner />
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-sky-100 dark:from-gray-900 dark:to-gray-800">
        <Header />
      <div className="max-w-7xl mx-auto p-4 md:p-8 mt-16">
        {/* Header Section */}
        <div className="mb-8">
        <div className="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 sm:gap-6 mb-6">
  <div className="w-full sm:w-auto">
    <h1 className="text-2xl sm:text-3xl md:text-4xl font-bold bg-gradient-to-r from-sky-700 via-sky-600 to-sky-500 bg-clip-text text-transparent mb-1 sm:mb-2">
      My Achievements
    </h1>
    <p className="text-gray-600 dark:text-gray-400 text-sm sm:text-base">
      Track your academic and extracurricular accomplishments
    </p>
  </div>

  <button
    onClick={() => setShowForm(true)}
    className="w-full sm:w-auto group relative overflow-hidden bg-gradient-to-r from-sky-700 to-sky-600 text-white px-6 py-3 sm:px-8 sm:py-4 rounded-2xl font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300"
  >
    <div className="absolute inset-0 bg-gradient-to-r from-sky-600 to-pink-600 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
    <div className="relative flex items-center justify-center gap-2">
      <div className="w-6 h-6 rounded-full bg-white/20 flex items-center justify-center">
        <span className="text-lg font-bold">+</span>
      </div>
      <span className="text-sm sm:text-base">Add Achievement</span>
    </div>
  </button>
</div>


          {/* Stats Cards */}
          <StatsCards achievements={achievements || []} />
        </div>

        {/* Controls Section */}
        {/* <div className="bg-white/70 backdrop-blur-sm rounded-2xl p-6 mb-8 shadow-lg border border-white/20">
          <div className="flex flex-col lg:flex-row gap-4"> */}
            {/* Search */}
            {/* <div className="flex-1">
              <div className="relative">
                <div className="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                  <svg className="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path
                      strokeLinecap="round"
                      strokeLinejoin="round"
                      strokeWidth={2}
                      d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                    />
                  </svg>
                </div>
                <input
                  type="text"
                  placeholder="Search achievements, agency, or rank..."
                  value={searchTerm}
                  onChange={(e) => setSearchTerm(e.target.value)}
                  className="w-full pl-12 pr-4 py-3 bg-white border-2 border-gray-200 rounded-xl text-base focus:outline-none focus:border-sky-500 focus:ring-4 focus:ring-sky-100 transition-all duration-200"
                />
              </div>
            </div> */}

            {/* Filters */}
            {/* <div className="flex gap-4">
              <select
                value={filterStatus}
                onChange={(e) => setFilterStatus(e.target.value)}
                className="px-4 py-3 bg-white border-2 border-gray-200 rounded-xl text-base focus:outline-none focus:border-sky-500 focus:ring-4 focus:ring-sky-100 transition-all duration-200 min-w-32"
              >
                <option value="all">All Status</option>
                <option value="approved">Approved</option>
                <option value="pending">Pending</option>
              </select>

              <select
                value={sortBy}
                onChange={(e) => setSortBy(e.target.value)}
                className="px-4 py-3 bg-white border-2 border-gray-200 rounded-xl text-base focus:outline-none focus:border-sky-500 focus:ring-4 focus:ring-sky-100 transition-all duration-200 min-w-32"
              >
                <option value="newest">Newest First</option>
                <option value="oldest">Oldest First</option>
                <option value="achievement">By Achievement</option>
              </select>
            </div>
          </div>
        </div> */}

        {/* Modal */}
        {showForm && (
          <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4">
            <div className="bg-white rounded-3xl max-w-3xl w-full max-h-[90vh] overflow-y-auto shadow-2xl">
              <AchievementForm
                onSubmit={editingAchievement ? handleUpdateAchievement : handleAddAchievement}
                onCancel={handleCancelEdit}
                initialData={editingAchievement}
                isEditing={!!editingAchievement}
              />
            </div>
          </div>
        )}

        {/* Achievements Grid */}
        <div className="min-h-96">
          {filteredAndSortedAchievements.length === 0 ? (
            <EmptyState
              onAddClick={() => setShowForm(true)}
              hasAchievements={achievements?.length > 0}
              searchTerm={searchTerm}
            />
          ) : (
            <div className="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
              {filteredAndSortedAchievements.map((achievement) => (
                <AchievementCard
                  key={achievement._id}
                  achievement={achievement}
                  onEdit={() => handleEditClick(achievement)}
                />
              ))}
            </div>
          )}
        </div>
      </div>
    </div>
  )
}

export default AchievementPage

================
File: frontend/src/pages/student/readingProgressPage.jsx
================
"use client"

import { useState, useEffect } from "react"
import { useReadingProgress } from "../../store/readingProgressStore"
import LoadingSpinner from "../../components/LoadingSpinner"
import ReadingStatsCards from "../../components/ReadingStatsCards"
import ReadingProgressForm from "../../components/ReadingProgressForm"
import ReadingEmptyState from "../../components/ReadingEmptyState"
import ReadingProgressCard from "../../components/ReadingProgressCard"
import Header from "../../components/Header"


const ReadingProgressPage = () => {
  const { readingProgress, isLoading, getStdReadingProgress, addReadingProgress, updateReadingProgress } =
    useReadingProgress()
  const [showForm, setShowForm] = useState(false)
  const [editingProgress, setEditingProgress] = useState(null)
  const [searchTerm, setSearchTerm] = useState("")
  const [filterStatus, setFilterStatus] = useState("all")
  const [sortBy, setSortBy] = useState("newest")

  useEffect(() => {
    getStdReadingProgress()
  }, [getStdReadingProgress])

  const handleAddProgress = async (progressData) => {
    try {
      await addReadingProgress(progressData)
      setShowForm(false)
    } catch (error) {
      console.error("Error adding reading progress:", error)
    }
  }

  const handleUpdateProgress = async (progressData) => {
    try {
      await updateReadingProgress(editingProgress._id, progressData)
      setEditingProgress(null)
    } catch (error) {
      console.error("Error updating reading progress:", error)
    }
  }

  const handleEditClick = (progress) => {
    setEditingProgress(progress)
    setShowForm(true)
  }

  const handleCancelEdit = () => {
    setEditingProgress(null)
    setShowForm(false)
  }

  const filteredAndSortedProgress =
    readingProgress
      ?.filter((progress) => {
        const matchesSearch =
          progress.bookName?.toLowerCase().includes(searchTerm.toLowerCase()) ||
          progress.authorName?.toLowerCase().includes(searchTerm.toLowerCase()) ||
          progress.publisher?.toLowerCase().includes(searchTerm.toLowerCase())

        const matchesStatus =
          filterStatus === "all" ||
          (filterStatus === "approved" && progress.approval) ||
          (filterStatus === "pending" && !progress.approval)

        return matchesSearch && matchesStatus
      })
      ?.sort((a, b) => {
        switch (sortBy) {
          case "newest":
            return new Date(b.createdAt) - new Date(a.createdAt)
          case "oldest":
            return new Date(a.createdAt) - new Date(b.createdAt)
          case "bookName":
            return a.bookName.localeCompare(b.bookName)
          case "pages":
            return (b.numberOfPages || 0) - (a.numberOfPages || 0)
          default:
            return 0
        }
      }) || []

  if (isLoading) {
    return <LoadingSpinner />
  }

  return (
    <div
      className={`min-h-screen transition-colors duration-300 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:bg-gradient-to-br  dark:from-gray-900 dark:to-gray-800 `}
    >
        <Header />
      <div className="max-w-7xl mx-auto p-4 md:p-8 mt-16">
        {/* Header Section */}
        <div className="mb-8">
        <div className="flex flex-col sm:flex-row sm:justify-between items-start sm:items-center gap-4 sm:gap-6 mb-6">
        <div className="w-full sm:w-auto">
            <h1 className="text-2xl sm:text-2xl md:text-4xl lg:text-4xl font-bold mb-2 bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 dark:from-blue-400 dark:via-purple-400 dark:to-pink-400 bg-clip-text text-transparent">
            Reading Progress
            </h1>
            <p className="text-sm sm:text-base md:text-lg text-gray-600 dark:text-gray-300">
            Track your reading journey and literary achievements
            </p>
        </div>

        <div className="w-full sm:w-auto flex justify-end sm:justify-center items-center gap-3 flex-wrap">
            <button
            onClick={() => setShowForm(true)}
            className="group relative w-full sm:w-auto px-5 py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 bg-gradient-to-r from-indigo-500 to-purple-600 dark:from-blue-600 dark:to-purple-700 text-white hover:from-purple-600 hover:to-pink-600 dark:hover:from-purple-600 dark:hover:to-pink-700"
            >
            <div className="flex items-center justify-center gap-2">
                <div className="w-5 h-5 rounded-full bg-white/20 flex items-center justify-center">
                <span className="text-base font-bold">+</span>
                </div>
                <span className="text-sm sm:text-base">Add Book</span>
            </div>
            </button>
        </div>
        </div>


          {/* Stats Cards */}
          <ReadingStatsCards readingProgress={readingProgress || []} />
        </div>

        {/* Controls Section */}
        {/* <div className="bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm rounded-2xl p-6 mb-8 shadow-lg border border-white/20 dark:border-gray-700/50 transition-colors duration-300">
          <div className="flex flex-col lg:flex-row gap-4">
            <div className="flex-1">
              <div className="relative">
                <div className="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                  <svg
                    className="h-5 w-5 text-gray-400 dark:text-gray-400"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      strokeLinecap="round"
                      strokeLinejoin="round"
                      strokeWidth={2}
                      d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                    />
                  </svg>
                </div>
                <input
                  type="text"
                  placeholder="Search books, authors, or publishers..."
                  value={searchTerm}
                  onChange={(e) => setSearchTerm(e.target.value)}
                  className="w-full pl-12 pr-4 py-3 bg-white dark:bg-gray-700 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200"
                />
              </div>
            </div>

            <div className="flex gap-4">
              <select
                value={filterStatus}
                onChange={(e) => setFilterStatus(e.target.value)}
                className="px-4 py-3 bg-white dark:bg-gray-700 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base text-gray-900 dark:text-white focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200 min-w-32"
              >
                <option value="all">All Status</option>
                <option value="approved">Approved</option>
                <option value="pending">Pending</option>
              </select>

              <select
                value={sortBy}
                onChange={(e) => setSortBy(e.target.value)}
                className="px-4 py-3 bg-white dark:bg-gray-700 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base text-gray-900 dark:text-white focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200 min-w-32"
              >
                <option value="newest">Newest First</option>
                <option value="oldest">Oldest First</option>
                <option value="bookName">By Book Name</option>
                <option value="pages">By Pages</option>
              </select>
            </div>
          </div>
        </div> */}

        {/* Modal */}
        {showForm && (
          <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4">
            <div className="bg-white dark:bg-gray-800 rounded-3xl max-w-3xl w-full max-h-[90vh] overflow-y-auto shadow-2xl">
              <ReadingProgressForm
                onSubmit={editingProgress ? handleUpdateProgress : handleAddProgress}
                onCancel={handleCancelEdit}
                initialData={editingProgress}
                isEditing={!!editingProgress}
              />
            </div>
          </div>
        )}

        {/* Reading Progress Grid */}
        <div className="min-h-96">
          {filteredAndSortedProgress.length === 0 ? (
            <ReadingEmptyState
              onAddClick={() => setShowForm(true)}
              hasProgress={readingProgress?.length > 0}
              searchTerm={searchTerm}
            />
          ) : (
            <div className="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
              {filteredAndSortedProgress.map((progress) => (
                <ReadingProgressCard key={progress._id} progress={progress} onEdit={() => handleEditClick(progress)} />
              ))}
            </div>
          )}
        </div>
      </div>
    </div>
  )
}

export default ReadingProgressPage

================
File: frontend/src/pdf-overrides.css
================
@layer utilities {
    .pdf-bg-gray-50 { background-color: #f9fafb !important; }
    .pdf-bg-indigo-100 { background-color: #e0e7ff !important; }
    .pdf-text-indigo-600 { color: #4f46e5 !important; }
    .pdf-border-gray-200 { border-color: #e5e7eb !important; }
    .pdf-bg-white { background-color: #ffffff !important; }
    .pdf-text-gray-900 { color: #111827 !important; }
    .pdf-bg-indigo-600 { background-color: #4f46e5 !important; }
  }

================
File: frontend/src/routes/AppRoutes.jsx
================
import { Routes, Route } from "react-router-dom";
import PublicRoutes from "./PublicRoutes";
import PrivateRoutes from "./PrivateRoutes";
import RoleBasedRoutes from "./RoleBasedRoutes";
import NotFound from "../pages/NotFound"; 

const AppRoutes = () => {
  return (
    <Routes>
      <Route path="/" element={<RoleBasedRoutes />} />

      <Route path="/auth/*" element={<PublicRoutes />} />

      <Route path="/dashboard/*" element={<PrivateRoutes />} />

      <Route path="*" element={<NotFound />} />
    </Routes>
  );
};

export default AppRoutes;

================
File: frontend/src/routes/PublicRoutes.jsx
================
import { Routes, Route, Outlet, Navigate } from "react-router-dom";
import { useAuthStore } from "../store/useAuthStore";
import LoginPage from "../pages/LoginPage";

const PublicRoutes = () => {
  const { authUser } = useAuthStore();

  if (authUser) {
    return <Navigate to="/" replace />;
  }

  return (
    <Routes>
      <Route element={<Outlet />}>
        <Route path="login" element={<LoginPage />} />
        <Route path="*" element={<Navigate to="login" replace />} />
      </Route>
    </Routes>
  );
};

export default PublicRoutes;

================
File: frontend/src/routes/RoleBasedRoutes.jsx
================
import { Navigate } from "react-router-dom";
import { useAuthStore } from "../store/useAuthStore";

const RoleBasedRoutes = () => {
  const { authUser } = useAuthStore();

  if (!authUser) return <Navigate to="/auth/login" replace />;

  switch (authUser.role.toLowerCase()) {
    case "admin":
      return <Navigate to="/dashboard/admin" replace />;
    case "teacher":
      return <Navigate to="/dashboard/teacher" replace />;
    case "student":
      return <Navigate to="/dashboard/student" replace />;
    default:
      return <Navigate to="/dashboard" replace />;
  }
};

export default RoleBasedRoutes;

================
File: frontend/src/store/useBooksStore.js
================
import { create } from "zustand";
import { axiosInstance } from "../lib/axios";

export const useBooksStore = create((set,get) => ({
    books: [],
    booksLoading: false,
    isRegistering: false,
    getBooks: async () => {
        set({ booksLoading: true });
        try {
            const res = await axiosInstance.get('/books');
            set({books: res.data.books});
            
        } catch (error) {
          console.error(error.response?.data?.message || "An error occurred");
            toast.error(error.response?.data?.message || "An error occurred");
        }finally{
            set({ booksLoading: false });
        }
    },
    bookBorrow: async (data) => {
        
        try {
          const response = await axiosInstance.post("/transactions/borrow", data, {
            headers: { "Content-Type": "application/json" },
          });
      
          toast.success(response.data.message);
      
        } catch (error) {
          console.error(error.response?.data?.message || "An error occurred");
          toast.error(error.response?.data?.message || "An error occurred");
        }
      },
      
      bookReturn: async (bookNumber) => {
        try {
          const response = await axiosInstance.post(
            "/transactions/return",
            { bookNumber },  
            {
              headers: { "Content-Type": "application/json" },
            }
          );
      
          toast.success(response.data.message);
        } catch (error) {
          console.log(error.response?.data?.message || "An error occurred");
          toast.error(error.response?.data?.message || "An error occurred");
        }
      }

}))

================
File: frontend/src/store/useRegisterdStudentStore.js
================
import { create } from "zustand";
import toast from "react-hot-toast";
import { axiosInstance } from "../lib/axios";


export const useRegisterdStudentStore = create((set, get) => ({
  Registeredstudents: [],
  filteredStudents: [],
  isLoading: false,
 
  newAdmission: async (data) => {
    set({ isLoading: true }); 

      try {
        const response = await axiosInstance.post("/admission", data, {
          headers: { "Content-Type": "application/json" },
        });
        
        toast.success(response.data.message);
    
      } catch (error) {
        console.log(error);
        
        toast.error(error.response?.data?.message || "An error occurred");
      } finally {
        set({ isLoading: false });
      }
    },
    
    getRegisteredStudents: async () => {
      set({ isLoading: true }); 
    
      try {
        const res = await axiosInstance.get("/admission");
    
        if (res.data && res.data.students) {
          set({ Registeredstudents: res.data.students });
          set({ filteredStudents: res.data.students });
        } else {
          console.warn("Unexpected response format:", res.data);
        }
      } catch (error) {
        console.error("Error fetching students:", error);
      } finally {
        set({ isLoading: false });
      }
    },
    filteringBatch: (selectedBatch) => {
      const { Registeredstudents } = get(); 
      let filteredStudents = null;
      if(selectedBatch === "All Batch"){
        filteredStudents = Registeredstudents;
      }else{
        filteredStudents = Registeredstudents.filter((student) => student.selectedBatch === selectedBatch);
      }
      set({ filteredStudents }); 
    },
    
    selectStudent : async (id, isSelected) => {
      try {
        
          const response = await axiosInstance.post('/admission/selected', {id, isSelected});
        
        toast.success(response.data.message);

      } catch (error) {
        console.error(error);
        toast.error(error.response?.data?.message || "An error occurred");
      }
    }
    
    // editStudent : async (data) => {
    //   try {
    //     const response = await axiosInstance.post(`/users/edit`, data, {
    //       headers: { "Content-Type": "application/json" },
    //     });
         
    //     toast.success("Account updated successfully");
    //   } catch (error) {
    //     console.error(error.response?.data?.message || "An error occurred");
    //     toast.error(error.response?.data?.message || "An error occurred");
    //   }
    // },
    
    
}));

================
File: frontend/src/store/useThemeStore.js
================
import { create } from "zustand";

export const useThemeStore = create((set) => ({
  theme: "light", // default theme
  initializeTheme: () => {
    const savedTheme = localStorage.getItem("theme") || "light";
    document.documentElement.classList.remove("light", "dark");
    document.documentElement.classList.add(savedTheme);
    set({ theme: savedTheme });
  },
  toggleTheme: () =>
    set((state) => {
      const newTheme = state.theme === "light" ? "dark" : "light";
      document.documentElement.classList.remove("light", "dark");
      document.documentElement.classList.add(newTheme);
      localStorage.setItem("theme", newTheme);
      return { theme: newTheme };
    }),
}));

================
File: frontend/tailwind.config.js
================
import daisyui from 'daisyui'
import typography from '@tailwindcss/typography'

/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  darkMode: "class",
  theme: {
    extend: {
      fontFamily: {
        sans: ['Inter', 'sans-serif'], // Recommend installing Google Font 'Inter'
        display: ['Oswald', 'sans-serif'],
      },
      colors: {
        // "Neo-Academic" Palette
        primary: {
          50: '#eff6ff',
          100: '#dbeafe',
          200: '#bfdbfe',
          300: '#93c5fd',
          400: '#60a5fa',
          500: '#3b82f6', // Bright Blue
          600: '#2563eb', // Royal Blue (Main)
          700: '#1d4ed8',
          800: '#1e40af',
          900: '#1e3a8a', // Deep Navy
        },
        surface: {
          light: '#ffffff',
          dark: '#0f172a', // Slate 900
          glass: 'rgba(255, 255, 255, 0.7)',
          glassDark: 'rgba(15, 23, 42, 0.6)',
        }
      },
      boxShadow: {
        'glass': '0 8px 32px 0 rgba(31, 38, 135, 0.07)',
        'glass-hover': '0 8px 32px 0 rgba(31, 38, 135, 0.15)',
        'neon': '0 0 10px rgba(59, 130, 246, 0.5), 0 0 20px rgba(59, 130, 246, 0.3)',
      },
      backdropBlur: {
        xs: '2px',
      },
      animation: {
        'float': 'float 6s ease-in-out infinite',
        'fade-in-up': 'fadeInUp 0.5s ease-out',
        'slide-in-right': 'slideInRight 0.4s ease-out',
      },
      keyframes: {
        float: {
          '0%, 100%': { transform: 'translateY(0)' },
          '50%': { transform: 'translateY(-10px)' },
        },
        fadeInUp: {
          '0%': { opacity: '0', transform: 'translateY(20px)' },
          '100%': { opacity: '1', transform: 'translateY(0)' },
        },
        slideInRight: {
          '0%': { transform: 'translateX(100%)', opacity: '0' },
          '100%': { transform: 'translateX(0)', opacity: '1' },
        }
      },
    },
  },
  plugins: [daisyui, typography],
  daisyui: {
    themes: ["light", "dark"], // Keeping it simple to control overrides manually
  },
}

================
File: frontend/vercel.json
================
{
    "rewrites": [
      { "source": "/(.*)", "destination": "/" }
    ]
  }

================
File: backend/src/controllers/bookController.js
================
import Book from "../models/book.model.js";

export const getBooks = async (req, res) => {
    try {
      const books = await Book.find().sort({ bookNumber: 1 });
  
      if (!books || books.length === 0) {
        return res.status(404).json({ success: false, message: "No books found" });
      }
  
      res.status(200).json({ success: true, books });
    } catch (error) {
      res.status(500).json({ success: false, error: error.message });
    }
  };

export const addBook = async (req, res) => {
    try {
      let { title, bookNumber, author } = req.body;
  
      if (!title || !bookNumber || !author) {
        return res.status(400).json({ success: false, message: "Missing required fields: title, author, or bookNumber" });
      }
  
      bookNumber = parseInt(bookNumber, 10);
  
      const existingBook = await Book.findOne({ bookNumber });
      if (existingBook) {
        return res.status(400).json({ success: false, message: "This bookNumber is already registered" });
      }
  
      const newBook = new Book({
        title,
        bookNumber,
        author,
        status: "available"
      });
  
      const savedBook = await newBook.save();
  
      res.status(201).json({ 
        success: true, 
        message: "Book added successfully", 
        book: savedBook 
      });
  
    } catch (error) {
      res.status(500).json({ success: false, error: error.message });
    }
};

export const updateBook = async (req, res) => {
    try {
      const { bookId } = req.params; // Get book ID from URL params
      const updateData = req.body; // Get updated fields from request body
  
      const updatedBook = await Book.findByIdAndUpdate(bookId, updateData, { new: true, runValidators: true });
  
      if (!updatedBook) {
        return res.status(404).json({ success: false, message: "Book not found" });
      }
  
      res.status(200).json({ success: true, message: "Book updated successfully", book: updatedBook });
    } catch (error) {
      res.status(500).json({ success: false, error: error.message });
    }
};

export const deleteBook = async (req, res) => {
    try {
      const { bookId } = req.params; // Get book ID from URL params
  
      const deletedBook = await Book.findByIdAndDelete(bookId);
  
      if (!deletedBook) {
        return res.status(404).json({ success: false, message: "Book not found" });
      }
  
      res.status(200).json({ success: true, message: "Book deleted successfully" });
    } catch (error) {
      res.status(500).json({ success: false, error: error.message });
    }
};

================
File: backend/src/controllers/recordController.js
================
import Record from "../models/records.model.js";

export const addRecord = async (req, res) => {
  try {
    const { name, description, folder, link } = req.body;
    
    const newRecord = new Record({ name, description, folder, link });
    const savedRecord = await newRecord.save();
    res.status(201).json(savedRecord);
  } catch (error) {
    res.status(500).json({ error: "Failed to add record", details: error.message });
  }
};

export const getRecords = async (req, res) => {
  try {
    const records = await Record.find().sort({ createdAt: -1 });
    res.status(200).json(records);
  } catch (error) {
    res.status(500).json({ error: "Failed to fetch records", details: error.message });
  }
};

export const editRecord = async (req, res) => {
  try {
    const { id } = req.params;
    const { name, description, folder, link } = req.body;

    const updatedRecord = await Record.findByIdAndUpdate(
      id,
      { name, description, folder, link },
      { new: true, runValidators: true }
    );

    if (!updatedRecord) {
      return res.status(404).json({ error: "Record not found" });
    }

    res.status(200).json(updatedRecord);
  } catch (error) {
    res.status(500).json({ error: "Failed to update record", details: error.message });
  }
};

export const deleteRecord = async (req, res) => {
  try {
    const { id } = req.params;
    const deletedRecord = await Record.findByIdAndDelete(id);

    if (!deletedRecord) {
      return res.status(404).json({ error: "Record not found" });
    }

    res.status(200).json({ message: "Record deleted successfully" });
  } catch (error) {
    res.status(500).json({ error: "Failed to delete record", details: error.message });
  }
};

================
File: backend/src/controllers/transactionController.js
================
import Book from "../models/book.model.js";
import User from "../models/student.model.js";
import Transaction from "../models/transaction.model.js";

export const borrowBook = async (req, res) => {
  try {
    const { bookNumber, studentId } = req.body;

    const book = await Book.findOne({ bookNumber });

    if (!book) {
      return res.status(404).json({ success: false, message: "Book not found" });
    }

    if (book.status !== "available") {
      return res.status(400).json({ success: false, message: "Book is not available for borrowing" });
    }

    const student = await User.findOne({ studentId });

    if (!student) {
      return res.status(404).json({ success: false, message: "Student not registered" });
    }

    const dueDate = new Date();
    dueDate.setDate(dueDate.getDate() + 7);

    book.status = "borrowed";
    book.borrowedBy = studentId;
    book.studentName = student.studentName;
    book.dueDate = dueDate;

    await book.save(); 

    const transaction = new Transaction({
      bookId: book._id,
      bookNumber: book.bookNumber,
      borrowDate: new Date(),
      dueDate: dueDate,
      studentId: studentId,
      returned: false,
    });

    await transaction.save();

    res.status(200).json({ success: true, message: "Book borrowed successfully", transaction });
  } catch (error) {
    res.status(500).json({ success: false, error: `Error borrowing book: ${error.message}` });
  }
};

export const returnBook = async (req, res) => {
  try {
    let { bookNumber } = req.body;

    bookNumber = parseInt(bookNumber, 10);

    const book = await Book.findOne({ bookNumber });

    if (!book) {
      return res.status(404).json({ success: false, message: "Book not found" });
    }

    if (book.status === "available") {
      return res.status(400).json({ success: false, message: "This book is already available in the library" });
    }

    book.status = "available";
    book.borrowedBy = null;
    book.studentName = null;
    book.dueDate = null;

    await book.save(); 

    const transaction = await Transaction.findOneAndUpdate(
      { bookNumber: bookNumber, returned: false },
      { $set: { returned: true, returnDate: new Date() } },
      { new: true }
    );

    if (!transaction) {
      return res.status(400).json({ success: false, message: "No active borrow record found for this book" });
    }

    res.status(200).json({ success: true, message: "Book returned successfully", transaction });
  } catch (error) {
    res.status(500).json({ success: false, error: `Error while returning book: ${error.message}` });
  }
};

export const borrowedBooks = async (req, res) => {
  try {
    const borrowedBooks = await Transaction.aggregate([
      {
        $match: {
          returned: false, 
        },
      },
      {
        $lookup: {
          from: "users", 
          localField: "studentId",
          foreignField: "studentId", 
          as: "userInfo",
        },
      },
      {
        $lookup: {
          from: "books", 
          localField: "bookId", 
          foreignField: "_id", 
          as: "bookInfo", 
        },
      },
      {
        $unwind: {
          path: "$userInfo",
          preserveNullAndEmptyArrays: true, 
        },
      },
      {
        $unwind: {
          path: "$bookInfo",
          preserveNullAndEmptyArrays: true,
        },
      },
      {
        $project: {
          _id: 1,
          studentName: "$userInfo.studentName",
          studentId: "$userInfo.studentId",
          bookTitle: "$bookInfo.title",
          bookNumber: 1,
          borrowDate: 1,
          dueDate: 1,
        },
      },
      { $sort: { borrowDate: -1 } },
    ]);

    if (!borrowedBooks || borrowedBooks.length === 0) {
      return res.status(404).json({ success: false, message: "No borrowed books found" });
    }

    res.status(200).json({ success: true, borrowedBooks });
  } catch (error) {
    res.status(500).json({ success: false, error: `Error fetching borrowed books: ${error.message}` });
  }
};

================
File: backend/src/helper/bookHelper.js
================
const  db = require('../config/connection');
const collections = require('../config/collection');
const axios = require('axios');
const xlsx = require('xlsx');
const fs = require('fs');

const fileUrl = 'https://docs.google.com/spreadsheets/d/1clbXTFNsHLEy4MR9MDgi-9MQiS88Fh9S7M0dHFaJsYA/export?format=xlsx';
const filePath = 'yourfile.xlsx';


module.exports = {
   
    getBooks:function(){
        return new Promise(async(resolve,reject)=>{
            try {
               let books = await db.get().collection(collections.BOOK_COLLECTION).find().sort({bookNumber: 1}).toArray()
               resolve(books);
            } catch (error) {
                reject(error);
            }
        })
    },
    addBook: async (data) => {
        return new Promise(async (resolve, reject) => {
            try {
                if (!data.title || !data.bookNumber) {
                    throw new Error("Missing required fields: title, author, or bookNumber");
                } 
                data.bookNumber = parseInt(data.bookNumber, 10)
                let book = await db.get().collection(collections.BOOK_COLLECTION).findOne({bookNumber:data.bookNumber})
                if(book){
                    throw new Error(" This  bookNumber is already registered");
                }
                data.status = 'available';
    
                const result = await db.get().collection(collections.BOOK_COLLECTION).insertOne(data);
    
                resolve({ success: true, message: "Book added successfully", insertedId: result.insertedId });
            } catch (error) {
                reject({ success: false, error: error.message });
            }
        });
    },
    
    
    updateBook:()=>{
        return new Promise((resolve,reject)=>{
            
        })
    },
    deleteBook:()=>{
        return new Promise((resolve,reject)=>{
            
        })
    },
    exeldata:function(){
axios({
    method: 'get',
    url: fileUrl,
    responseType: 'stream',
  })
    .then((response) => {
      const writer = fs.createWriteStream(filePath);
      response.data.pipe(writer);
  
      writer.on('finish', async() => {
        const workbook = xlsx.readFile(filePath);
        const sheet_name_list = workbook.SheetNames;
        const data = xlsx.utils.sheet_to_json(workbook.Sheets[sheet_name_list[0]]);
        
        const transformedData = data.map((item) => ({
            bookNumber: item['ASS. NO'],
            title: item['NAME OF BOOKS'],
            author: item['NAME OF AUTHOR'],
            status: 'available'
          }));
        await db.get().collection(collections.BOOK_COLLECTION).insertMany(transformedData);
      });
  
      writer.on('error', (err) => {
        console.log('Error downloading file: ', err);
      });
    })
    .catch((error) => {
      console.error('Error downloading the Excel file: ', error);
    });
    },
}

================
File: backend/src/lib/googleSheet.js
================
import { google } from "googleapis";

// --- Configuration ---
const spreadsheetId = process.env.SPREADSHEET_ID;
const rawCredentials = process.env.GOOGLE_CREDENTIALS_JSON;

if (!spreadsheetId) {
  console.error("Error: SPREADSHEET_ID environment variable is not set.");
  process.exit(1);
}

if (!rawCredentials) {
  console.error("Error: GOOGLE_CREDENTIALS_JSON environment variable is not set.");
  process.exit(1);
}

let credentials;
try {
  credentials = JSON.parse(rawCredentials);
} catch (error) {
  console.error("Failed to parse GOOGLE_CREDENTIALS_JSON:", error.message);
  process.exit(1);
}

/**
 * Creates and returns an authenticated Google Auth client.
 */
async function getAuth() {
  try {
    const auth = new google.auth.GoogleAuth({
      credentials,
      scopes: ["https://www.googleapis.com/auth/spreadsheets"],
    });
    return auth;
  } catch (error) {
    console.error("Authentication failed:", error.message);
    throw error;
  }
}

/**
 * A class to interact with a Google Sheet as a simple database.
 * Provides methods for Create, Read, Update, and Delete (CRUD) operations.
 */
class SheetsDB {
  async readAll(sheetName) {
    try {
      console.log(`Reading all rows from sheet: ${sheetName}`);
      const auth = await getAuth();
      const sheets = google.sheets({ version: "v4", auth });

      const res = await sheets.spreadsheets.values.get({
        spreadsheetId,
        range: `${sheetName}!A:T`,
      });

      const rows = res.data.values || [];
      if (rows.length < 3) {
        console.warn("No data found or sheet format is incorrect (expected headers on row 2).");
        return [];
      }

      const headers = rows[1];
      const dataRows = rows.slice(2);

      const data = dataRows
        .map((row, index) => {
          if (!row[0] || row[0].toString().toUpperCase().includes("TOTAL")) {
            return null;
          }

          const rowData = {
            rowIndex: index + 3,
          };

          headers.forEach((header, i) => {
            if (header) {
              rowData[header] = row[i] || "";
            }
          });
          return rowData;
        })
        .filter((row) => row !== null);

      return data;
    } catch (error) {
      console.error(`Error reading data from sheet "${sheetName}":`, error.message);
      throw error;
    }
  }

  async updateRow(sheetName, rowIndex, dataToUpdate) {
    try {
      console.log(`Updating row index ${rowIndex} in sheet: ${sheetName}`);
      const auth = await getAuth();
      const sheets = google.sheets({ version: "v4", auth });

      const headerRes = await sheets.spreadsheets.values.get({
        spreadsheetId,
        range: `${sheetName}!A2:T2`,
      });

      const headers = headerRes.data.values?.[0];
      if (!headers) throw new Error(`Could not retrieve headers from sheet "${sheetName}".`);

      const values = headers.map((header) => dataToUpdate[header] ?? "");
      const range = `${sheetName}!A${rowIndex}:T${rowIndex}`;

      await sheets.spreadsheets.values.update({
        spreadsheetId,
        range,
        valueInputOption: "USER_ENTERED",
        requestBody: { values: [values] },
      });

      console.log(`Successfully updated row ${rowIndex} in ${sheetName}.`);
      return { success: true };
    } catch (error) {
      console.error(`Error updating row ${rowIndex} in sheet "${sheetName}":`, error.message);
      throw error;
    }
  }

  async insert(sheetName, data) {
    try {
      console.log(`Inserting row into sheet: ${sheetName}`, data);
      const auth = await getAuth();
      const sheets = google.sheets({ version: "v4", auth });

      const headerRes = await sheets.spreadsheets.values.get({
        spreadsheetId,
        range: `${sheetName}!A2:T2`,
      });

      const headers = headerRes.data.values?.[0];
      if (!headers) throw new Error(`Could not retrieve headers from sheet "${sheetName}".`);

      const values = headers.map((header) => data[header] || "");

      await sheets.spreadsheets.values.append({
        spreadsheetId,
        range: `${sheetName}!A:T`,
        valueInputOption: "USER_ENTERED",
        insertDataOption: "INSERT_ROWS",
        requestBody: { values: [values] },
      });

      return { success: true };
    } catch (error) {
      console.error(`Error inserting into sheet "${sheetName}":`, error.message);
      throw error;
    }
  }

  async update(sheetName, uniqueKey, uniqueValue, dataToUpdate) {
    try {
      console.log(`Updating row where ${uniqueKey}=${uniqueValue} in sheet: ${sheetName}`);
      const allData = await this.readAll(sheetName);
      const rowToUpdate = allData.find((row) => row[uniqueKey] == uniqueValue);

      if (!rowToUpdate) throw new Error(`Row with ${uniqueKey} = ${uniqueValue} not found.`);

      const auth = await getAuth();
      const sheets = google.sheets({ version: "v4", auth });

      const headerRes = await sheets.spreadsheets.values.get({
        spreadsheetId,
        range: `${sheetName}!A2:T2`,
      });

      const headers = headerRes.data.values?.[0];
      if (!headers) throw new Error(`Could not retrieve headers from sheet "${sheetName}".`);

      const updatedRowData = { ...rowToUpdate, ...dataToUpdate };
      const values = headers.map((header) => updatedRowData[header] || "");
      const range = `${sheetName}!A${rowToUpdate.rowIndex}:T${rowToUpdate.rowIndex}`;

      await sheets.spreadsheets.values.update({
        spreadsheetId,
        range,
        valueInputOption: "USER_ENTERED",
        requestBody: { values: [values] },
      });

      return { success: true };
    } catch (error) {
      console.error(`Error updating row in sheet "${sheetName}":`, error.message);
      throw error;
    }
  }

  async delete(sheetName, uniqueKey, uniqueValue) {
    try {
      console.log(`Deleting row where ${uniqueKey}=${uniqueValue} from sheet: ${sheetName}`);
      const allData = await this.readAll(sheetName);
      const rowToDelete = allData.find((row) => row[uniqueKey] == uniqueValue);

      if (!rowToDelete) throw new Error(`Row with ${uniqueKey} = ${uniqueValue} not found.`);

      const auth = await getAuth();
      const sheets = google.sheets({ version: "v4", auth });

      const spreadsheetMeta = await sheets.spreadsheets.get({ spreadsheetId });
      const sheet = spreadsheetMeta.data.sheets.find((s) => s.properties.title === sheetName);
      if (!sheet) throw new Error(`Sheet with name "${sheetName}" not found.`);

      const sheetId = sheet.properties.sheetId;

      await sheets.spreadsheets.batchUpdate({
        spreadsheetId,
        requestBody: {
          requests: [
            {
              deleteDimension: {
                range: {
                  sheetId: sheetId,
                  dimension: "ROWS",
                  startIndex: rowToDelete.rowIndex - 1,
                  endIndex: rowToDelete.rowIndex,
                },
              },
            },
          ],
        },
      });

      return { success: true };
    } catch (error) {
      console.error(`Error deleting row from sheet "${sheetName}":`, error.message);
      throw error;
    }
  }

  async find(sheetName, query) {
    try {
      console.log(`Finding rows in sheet "${sheetName}" matching:`, query);
      const allRows = await this.readAll(sheetName);
      return allRows.filter((row) =>
        Object.entries(query).every(([key, value]) => row[key] == value)
      );
    } catch (error) {
      console.error(`Error finding in sheet "${sheetName}":`, error.message);
      throw error;
    }
  }

  async findOne(sheetName, query) {
    try {
      console.log(`Finding one row in sheet "${sheetName}" matching:`, query);
      const results = await this.find(sheetName, query);
      return results.length > 0 ? results[0] : null;
    } catch (error) {
      console.error(`Error finding one in sheet "${sheetName}":`, error.message);
      throw error;
    }
  }
}

export default SheetsDB;

================
File: backend/src/models/records.model.js
================
import mongoose from 'mongoose';

const recordSchema = new mongoose.Schema(
  {
    name: {
      type: String,
      required: true,
      trim: true,
    },
    description: {
      type: String,
    },
    folder: {
      type: String,
    },
    link: {
      type: String,
      default: null,
    },
  },
  { timestamps: true }
);

export default mongoose.model('Record', recordSchema);

================
File: backend/src/models/timetable.model.js
================
import mongoose from "mongoose";

const slotSchema = new mongoose.Schema(
  {},
  { strict: false, _id: false } // Allow dynamic keys like batch names
);

const timetableSchema = new mongoose.Schema({
  grid: {
    Monday: [slotSchema],
    Tuesday: [slotSchema],
    Wednesday: [slotSchema],
    Thursday: [slotSchema],
    Friday: [slotSchema],
    Saturday: [slotSchema],
  },
});

export default mongoose.model("Timetable", timetableSchema);

================
File: backend/src/routes/marks.route.js
================
import express from "express";
import { addMarkList, allowEditAccess, editAceesRequst, getCountToApproveByBatch, getCountToApproveByStd, getMarkList, updateStatus } from "../controllers/marksComtroller.js";


const router = express.Router();

router.get("/count", getCountToApproveByBatch)

router.get("/count/:batchId", getCountToApproveByStd)

router.post('/', addMarkList);

router.get('/', getMarkList);

router.patch('/:marklistId/status', updateStatus);

router.patch('/:marklistId/request-edit', editAceesRequst);

router.patch('/:marklistId/allow-edit', allowEditAccess);




export default router;

================
File: backend/src/routes/transaction.route.js
================
import express from "express";
import { borrowBook, borrowedBooks, returnBook } from "../controllers/transactionController.js";

const router = express.Router();

router.post("/borrow", borrowBook);

router.post("/return", returnBook);

router.get("/borrowed", borrowedBooks);

export default router;

================
File: frontend/public/site.webmanifest
================
{
  "name": "UIA ACADEMICS",
  "short_name": "UIA",
  "icons": [
    {
      "src": "/web-app-manifest-192x192.png",
      "sizes": "192x192",
      "type": "image/png",
      "purpose": "maskable"
    },
    {
      "src": "/web-app-manifest-512x512.png",
      "sizes": "512x512",
      "type": "image/png",
      "purpose": "maskable"
    }
  ],
  "theme_color": "#ffffff",
  "background_color": "#ffffff",
  "display": "standalone"
}

================
File: frontend/src/components/AchievementCard.jsx
================
"use client"

import { useState } from "react"
import { ChevronDown, ChevronUp, Calendar, FileText, Medal, Percent } from "lucide-react"

const AchievementCard = ({ achievement, onEdit }) => {
  const [isExpanded, setIsExpanded] = useState(false)

  const toggleExpand = () => setIsExpanded(!isExpanded)

  const getStatusBadge = () => {
    return achievement.approval ? (
      <div className="flex items-center gap-2 px-3 py-1 bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-200 rounded-full text-xs font-semibold">
        <div className="w-2 h-2 bg-green-500 rounded-full" />
        Approved
      </div>
    ) : (
      <div className="flex items-center gap-2 px-3 py-1 bg-amber-100 dark:bg-amber-900/40 text-amber-800 dark:text-amber-200 rounded-full text-xs font-semibold">
        <div className="w-2 h-2 bg-amber-500 rounded-full animate-pulse" />
        Pending
      </div>
    )
  }

  const getRankIcon = (rank) => {
    if (!rank) return "üèÖ"
    const r = rank.toLowerCase()
    if (r.includes("1st") || r.includes("first") || r.includes("winner")) return "ü•á"
    if (r.includes("2nd") || r.includes("second")) return "ü•à"
    if (r.includes("3rd") || r.includes("third")) return "ü•â"
    return "üèÖ"
  }

  const getLevelColor = (level) => {
    const colors = {
      School: "bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-200",
      District: "bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-200",
      State: "bg-purple-100 dark:bg-purple-900/40 text-purple-800 dark:text-purple-200",
      National: "bg-red-100 dark:bg-red-900/40 text-red-800 dark:text-red-200",
      International: "bg-indigo-100 dark:bg-indigo-900/40 text-indigo-800 dark:text-indigo-200",
      University: "bg-cyan-100 dark:bg-cyan-900/40 text-cyan-800 dark:text-cyan-200",
      College: "bg-pink-100 dark:bg-pink-900/40 text-pink-800 dark:text-pink-200",
    }
    return colors[level] || "bg-gray-100 dark:bg-gray-900/40 text-gray-800 dark:text-gray-200"
  }

  return (
    <div className="group bg-white dark:bg-gray-800/60 rounded-3xl p-6 shadow-lg border border-white/30 dark:border-gray-700 transition-all duration-300 overflow-hidden">
      <div className="flex justify-between items-start mb-4">
        <div className="flex items-center gap-3">
          <div className="text-3xl">{getRankIcon(achievement.placeOrRank)}</div>
          {getStatusBadge()}
        </div>
        {achievement.approval === false &&
         <button
          onClick={onEdit}
          className="p-2 hover:bg-indigo-100 dark:hover:bg-indigo-900/30 rounded-xl text-indigo-600 dark:text-indigo-300"
          title="Edit"
        >
          ‚úèÔ∏è
        </button> }
       
      </div>

      <h3 className="text-xl font-bold text-gray-800 dark:text-white leading-tight mb-1">{achievement.achievedItem}</h3>
      {achievement.agencyLevel && (
        <span className={`inline-block px-3 py-1 rounded-full text-xs font-semibold mb-2 ${getLevelColor(achievement.agencyLevel)}`}>
          {achievement.agencyLevel} Level
        </span>
      )}

      <div className="text-end">
        <button
          onClick={toggleExpand}
          className="text-sm text-gray-600 dark:text-gray-300 flex items-center gap-1 ml-auto hover:underline"
        >
          {isExpanded ? <>Hide Details <ChevronUp size={16} /></> : <>View Details <ChevronDown size={16} /></>}
        </button>
      </div>

      {/* Expanded Section */}
      {isExpanded && (
        <div className="mt-4 space-y-3 text-sm text-gray-700 dark:text-gray-300 transition-all duration-300">
          {achievement.placeOrRank && (
            <div className="flex items-center gap-2">
              <Medal size={16} className="text-yellow-500 dark:text-yellow-300" />
              <span className="font-medium">Position:</span>
              <span>{achievement.placeOrRank}</span>
            </div>
          )}

          {achievement.gradeOrPercentage && (
            <div className="flex items-center gap-2">
              <Percent size={16} className="text-green-500 dark:text-green-300" />
              <span className="font-medium">Grade/Score:</span>
              <span>{achievement.gradeOrPercentage}</span>
            </div>
          )}

          {achievement.monthAndYear && (
            <div className="flex items-center gap-2">
              <Calendar size={16} className="text-blue-500 dark:text-blue-300" />
              <span className="font-medium">Date:</span>
              <span>{achievement.monthAndYear}</span>
            </div>
          )}

          {achievement.remarks && (
            <div className="flex items-start gap-2">
              <FileText size={16} className="mt-1 text-gray-500 dark:text-gray-400" />
              <div>
                <span className="font-medium block mb-1">Remarks:</span>
                <p className="text-sm">{achievement.remarks}</p>
              </div>
            </div>
          )}

          <div className="flex justify-between pt-3 border-t border-gray-200 dark:border-gray-700 text-xs text-gray-500 dark:text-gray-400">
            <span>Added: {new Date(achievement.createdAt).toLocaleDateString()}</span>
            {achievement.updatedAt !== achievement.createdAt && (
              <span>Updated: {new Date(achievement.updatedAt).toLocaleDateString()}</span>
            )}
          </div>
        </div>
      )}
    </div>
  )
}

export default AchievementCard

================
File: frontend/src/components/AchievementDetailsModal.jsx
================
"use client"

const AchievementDetailsModal = ({ achievement, onClose, onApprove, onReject, onDelete }) => {
  const getRankIcon = (rank) => {
    if (!rank) return "üèÖ"
    const lowerRank = rank.toLowerCase()
    if (lowerRank.includes("1st") || lowerRank.includes("first") || lowerRank.includes("winner")) return "ü•á"
    if (lowerRank.includes("2nd") || lowerRank.includes("second")) return "ü•à"
    if (lowerRank.includes("3rd") || lowerRank.includes("third")) return "ü•â"
    return "üèÖ"
  }

  return (
    <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4">
      <div className="bg-white dark:bg-gray-800 rounded-3xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl">
        <div className="p-8">
          {/* Header */}
          <div className="flex justify-between items-start mb-6 pb-4 border-b border-gray-200 dark:border-gray-700">
            <div className="flex items-center gap-4">
              <div className="text-4xl">{getRankIcon(achievement.placeOrRank)}</div>
              <div>
                <h2 className="text-2xl font-bold text-gray-800 dark:text-white">Achievement Details</h2>
                <p className="text-gray-600 dark:text-gray-300">Review and manage this achievement</p>
              </div>
            </div>
            <button
              onClick={onClose}
              className="w-10 h-10 flex items-center justify-center text-2xl text-gray-400 hover:text-red-500 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-full transition-all duration-200"
            >
              √ó
            </button>
          </div>

     

          {/* Achievement Details */}
          <div className="space-y-4 mb-6">
            <div>
              <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                Achievement Item
              </label>
              <div className="text-lg font-semibold text-gray-900 dark:text-white">{achievement.achievedItem}</div>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              {achievement.agencyLevel && (
                <div>
                  <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                    Agency Level
                  </label>
                  <span className="inline-block px-3 py-1 bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-300 rounded-full text-sm font-medium">
                    {achievement.agencyLevel}
                  </span>
                </div>
              )}

              {achievement.placeOrRank && (
                <div>
                  <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Place/Rank</label>
                  <div className="text-gray-900 dark:text-white font-medium">{achievement.placeOrRank}</div>
                </div>
              )}

              {achievement.gradeOrPercentage && (
                <div>
                  <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                    Grade/Percentage
                  </label>
                  <div className="text-gray-900 dark:text-white font-medium">{achievement.gradeOrPercentage}</div>
                </div>
              )}

              {achievement.monthAndYear && (
                <div>
                  <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                    Month & Year
                  </label>
                  <div className="text-gray-900 dark:text-white font-medium">{achievement.monthAndYear}</div>
                </div>
              )}
            </div>

            {achievement.remarks && (
              <div>
                <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Remarks</label>
                <div className="p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg text-gray-900 dark:text-white">
                  {achievement.remarks}
                </div>
              </div>
            )}

            {/* Status */}
            <div>
              <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
              {achievement.approval ? (
                <span className="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300">
                  ‚úì Approved
                </span>
              ) : (
                <span className="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300">
                  ‚è≥ Pending Review
                </span>
              )}
            </div>

          
          </div>

          {/* Actions */}
          <div className="flex flex-col md:flex-row gap-3 pt-4 border-t border-gray-200 dark:border-gray-700">
            <button
              onClick={onClose}
              className="px-6 py-3 border-2 border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl font-medium hover:border-gray-400 dark:hover:border-gray-500 hover:bg-gray-50 dark:hover:bg-gray-600 transition-all duration-200"
            >
              Close
            </button>
            {!achievement.approval ? (
              <button
                onClick={() => {
                  onApprove(achievement._id)
                  onClose()
                }}
                className="px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-xl font-medium transition-colors duration-200"
              >
                Approve Achievement
              </button>
            ) : (
              <button
                onClick={() => {
                  onReject(achievement._id)
                  onClose()
                }}
                className="px-6 py-3 bg-yellow-600 hover:bg-yellow-700 text-white rounded-xl font-medium transition-colors duration-200"
              >
                Revoke Approval
              </button>
            )}
            <button
              onClick={() => {
                onDelete(achievement._id)
                onClose()
              }}
              className="px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-medium transition-colors duration-200"
            >
              Delete Achievement
            </button>
          </div>
        </div>
      </div>
    </div>
  )
}

export default AchievementDetailsModal

================
File: frontend/src/components/AchievementForm.jsx
================
"use client"

import { useState, useEffect } from "react"

const AchievementForm = ({ onSubmit, onCancel, initialData, isEditing }) => {
  const [formData, setFormData] = useState({
    achievedItem: "",
    agencyLevel: "",
    placeOrRank: "",
    gradeOrPercentage: "",
    monthAndYear: "",
    remarks: "",
  })
  const [errors, setErrors] = useState({})
  const [isSubmitting, setIsSubmitting] = useState(false)

  useEffect(() => {
    if (initialData) {
      setFormData({
        achievedItem: initialData.achievedItem || "",
        agencyLevel: initialData.agencyLevel || "",
        placeOrRank: initialData.placeOrRank || "",
        gradeOrPercentage: initialData.gradeOrPercentage || "",
        monthAndYear: initialData.monthAndYear || "",
        remarks: initialData.remarks || "",
      })
    }
  }, [initialData])

  const validateForm = () => {
    const newErrors = {}

    if (!formData.achievedItem.trim()) {
      newErrors.achievedItem = "Achievement item is required"
    }

    if (!formData.monthAndYear.trim()) {
      newErrors.monthAndYear = "Month and year is required"
    }

    setErrors(newErrors)
    return Object.keys(newErrors).length === 0
  }

  const handleChange = (e) => {
    const { name, value } = e.target
    setFormData((prev) => ({
      ...prev,
      [name]: value,
    }))

    if (errors[name]) {
      setErrors((prev) => ({
        ...prev,
        [name]: "",
      }))
    }
  }

  const handleSubmit = async (e) => {
    e.preventDefault()

    if (!validateForm()) {
      return
    }

    setIsSubmitting(true)
    try {
      await onSubmit(formData)
    } catch (error) {
      console.error("Error submitting form:", error)
    } finally {
      setIsSubmitting(false)
    }
  }

  return (
    <div className="p-8 bg-white dark:bg-gray-800">
      {/* Header */}
      <div className="flex justify-between items-center mb-8 pb-6 border-b border-gray-200">
        <div>
          <h2 className="text-3xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">
            {isEditing ? "Edit Achievement" : "Add New Achievement"}
          </h2>
          <p className="text-gray-600 mt-2">Fill in the details of your achievement</p>
        </div>
        <button
          onClick={onCancel}
          className="w-10 h-10 flex items-center justify-center text-2xl text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-all duration-200"
        >
          √ó
        </button>
      </div>

      <form onSubmit={handleSubmit} className="space-y-6">
        {/* Achievement Item */}
        <div className="space-y-2">
          <label htmlFor="achievedItem" className="block text-sm font-semibold text-gray-700">
            Achievement Item *
          </label>
          <input
            type="text"
            id="achievedItem"
            name="achievedItem"
            value={formData.achievedItem}
            onChange={handleChange}
            className="w-full px-4 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200"
            placeholder="Arabic Speech/Paper presentation"
          />
          {errors.achievedItem && <span className="text-red-500 text-sm font-medium">{errors.achievedItem}</span>}
        </div>

        {/* Agency Level and Place/Rank Row */}
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div className="space-y-2">
            <label htmlFor="agencyLevel" className="block text-sm font-semibold text-gray-700">
              Agency/Level
            </label>
            <select
              id="agencyLevel"
              name="agencyLevel"
              value={formData.agencyLevel}
              onChange={handleChange}
              className="w-full px-4 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200"
            >
              <option value="">Select Level</option>
              <option value="School">School Level</option>
              <option value="District">District Level</option>
              <option value="State">State Level</option>
              <option value="National">National Level</option>
              <option value="International">International Level</option>
              <option value="University">University Level</option>
              <option value="College">College Level</option>
            </select>
          </div>

          <div className="space-y-2">
            <label htmlFor="placeOrRank" className="block text-sm font-semibold text-gray-700">
              Place/Rank
            </label>
            <input
              type="text"
              id="placeOrRank"
              name="placeOrRank"
              value={formData.placeOrRank}
              onChange={handleChange}
              className="w-full px-4 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200"
              placeholder="e.g., 1st Place, 2nd Position, Winner"
            />
          </div>
        </div>

        {/* Grade/Percentage and Month/Year Row */}
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div className="space-y-2">
            <label htmlFor="gradeOrPercentage" className="block text-sm font-semibold text-gray-700">
              Grade/Percentage
            </label>
            <input
              type="text"
              id="gradeOrPercentage"
              name="gradeOrPercentage"
              value={formData.gradeOrPercentage}
              onChange={handleChange}
               className="w-full px-4 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200"
              placeholder="e.g., A+, 95%, 9.5 CGPA"
            />
          </div>

          <div className="space-y-2">
            <label htmlFor="monthAndYear" className="block text-sm font-semibold text-gray-700">
              Date
            </label>
          <input
              type="date"
              id="monthAndYear"
              name="monthAndYear"
              value={formData.monthAndYear}
              onChange={handleChange}
              className="w-full px-4 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200"
            />

            {errors.monthAndYear && <span className="text-red-500 text-sm font-medium">{errors.monthAndYear}</span>}
          </div>
        </div>

        {/* Remarks */}
        <div className="space-y-2">
          <label htmlFor="remarks" className="block text-sm font-semibold text-gray-700">
            Remarks/Additional Details
          </label>
          <textarea
            id="remarks"
            name="remarks"
            value={formData.remarks}
            onChange={handleChange}
            rows="4"
            className="w-full px-4 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200"
            placeholder="Any additional information about your achievement..."
          />
        </div>

        {/* Form Actions */}
        <div className="flex flex-col md:flex-row gap-4 justify-end pt-6 border-t border-gray-200">
          <button
            type="button"
            onClick={onCancel}
            className="px-8 py-4 border-2 border-gray-300 bg-white text-gray-700 rounded-xl font-semibold hover:border-gray-400 hover:bg-gray-50 transition-all duration-200"
          >
            Cancel
          </button>
          <button
            type="submit"
            disabled={isSubmitting}
            className="px-8 py-4 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl font-semibold hover:shadow-lg hover:-translate-y-0.5 transition-all duration-200 disabled:opacity-60 disabled:cursor-not-allowed disabled:transform-none disabled:shadow-none"
          >
            {isSubmitting ? (
              <div className="flex items-center gap-2">
                <div className="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div>
                Saving...
              </div>
            ) : isEditing ? (
              "Update Achievement"
            ) : (
              "Add Achievement"
            )}
          </button>
        </div>
      </form>
    </div>
  )
}

export default AchievementForm

================
File: frontend/src/components/InputField.jsx
================
import { Eye, EyeOff } from 'lucide-react';
import React, { useState } from 'react';

const InputField = ({ label, name, value, icon, onChange, type = "text", placeholder }) => {
  const [showPassword, setShowPassword] = useState(false);
  const [isFocused, setIsFocused] = useState(false);

  const isPassword = name === "password" || type === "password";
  const inputType = isPassword && showPassword ? "text" : (isPassword ? "password" : type);

  return (
    <div className="relative group mb-4">
      {/* Icon Wrapper */}
      {icon && (
        <div className={`absolute left-4 top-1/2 -translate-y-1/2 transition-colors duration-300 ${isFocused ? 'text-primary-500' : 'text-slate-400'}`}>
          {icon}
        </div>
      )}

      {/* Input */}
      <input
        type={inputType}
        name={name}
        id={name}
        value={value}
        onChange={(e) => onChange(e.target.value)} // Adapting to your store's "onChange" pattern (value only vs event)
        onFocus={() => setIsFocused(true)}
        onBlur={() => setIsFocused(false)}
        placeholder=" " // Important for floating label css trick
        className={`peer w-full bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3.5 
          ${icon ? 'pl-12' : 'pl-4'} 
          outline-none transition-all duration-300
          focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500
          text-slate-800 dark:text-white placeholder-transparent
        `}
        {...(typeof onChange === 'function' && { onChange: (e) => {
            // Handle both event object and direct setters logic from your legacy code
            if(onChange.length === 1) onChange(e); // likely a setter
            else onChange(prev => ({...prev, [name]: e.target.value})); // likely form state setter
        }})} 
      />

      {/* Floating Label */}
      <label
        htmlFor={name}
        className={`absolute left-4 top-1/2 -translate-y-1/2 text-slate-500 dark:text-slate-400 text-sm transition-all duration-200 pointer-events-none
          ${icon ? 'peer-placeholder-shown:left-12' : 'peer-placeholder-shown:left-4'}
          peer-focus:-top-2 peer-focus:left-3 peer-focus:text-xs peer-focus:text-primary-500 peer-focus:bg-white peer-focus:dark:bg-slate-900 peer-focus:px-1
          ${value ? '-top-2 left-3 text-xs bg-white dark:bg-slate-900 px-1' : ''}
        `}
      >
        {label}
      </label>

      {/* Password Toggle */}
      {isPassword && (
        <button
          type="button"
          onClick={() => setShowPassword(!showPassword)}
          className="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 transition-colors"
        >
          {showPassword ? <EyeOff size={18} /> : <Eye size={18} />}
        </button>
      )}
    </div>
  );
};

export default InputField;

================
File: frontend/src/components/ReadingProgressDetailsModal.jsx
================
"use client"

const ReadingProgressDetailsModal = ({ progress, onClose, onApprove, onReject, onDelete }) => {
  const getBookIcon = () => {
    const icons = ["üìö", "üìñ", "üìï", "üìó", "üìò", "üìô"]
    return icons[Math.floor(Math.random() * icons.length)]
  }

  return (
    <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4">
      <div className="bg-white dark:bg-gray-800 rounded-3xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl">
        <div className="p-8">
          {/* Header */}
          <div className="flex justify-between items-start mb-6 pb-4 border-b border-gray-200 dark:border-gray-700">
            <div className="flex items-center gap-4">
              <div className="text-4xl">{getBookIcon()}</div>
              <div>
                <h2 className="text-2xl font-bold text-gray-800 dark:text-white">Reading Progress Details</h2>
                <p className="text-gray-600 dark:text-gray-300">Review and manage this reading progress</p>
              </div>
            </div>
            <button
              onClick={onClose}
              className="w-10 h-10 flex items-center justify-center text-2xl text-gray-400 hover:text-red-500 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-full transition-all duration-200"
            >
              √ó
            </button>
          </div>

         

          {/* Book Details */}
          <div className="space-y-4 mb-6">
            <div>
              <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Book Name</label>
              <div className="text-lg font-semibold text-gray-900 dark:text-white">{progress.bookName}</div>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              {progress.authorName && (
                <div>
                  <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Author</label>
                  <div className="text-gray-900 dark:text-white font-medium">{progress.authorName}</div>
                </div>
              )}

              {progress.publisher && (
                <div>
                  <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Publisher</label>
                  <div className="text-gray-900 dark:text-white font-medium">{progress.publisher}</div>
                </div>
              )}

              {progress.numberOfPages && (
                <div>
                  <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                    Number of Pages
                  </label>
                  <div className="text-gray-900 dark:text-white font-medium">
                    {progress.numberOfPages.toLocaleString()}
                  </div>
                </div>
              )}

              {progress.monthAndYear && (
                <div>
                  <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                    Month & Year
                  </label>
                  <div className="text-gray-900 dark:text-white font-medium">{progress.monthAndYear}</div>
                </div>
              )}
            </div>

            {progress.remarks && (
              <div>
                <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                  Review/Remarks
                </label>
                <div className="p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg text-gray-900 dark:text-white">
                  {progress.remarks}
                </div>
              </div>
            )}

            {/* Status */}
            <div>
              <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
              {progress.approval ? (
                <span className="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300">
                  ‚úì Approved
                </span>
              ) : (
                <span className="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300">
                  ‚è≥ Pending Review
                </span>
              )}
            </div>

        
          </div>

          {/* Actions */}
          <div className="flex flex-col md:flex-row gap-3 pt-4 border-t border-gray-200 dark:border-gray-700">
            <button
              onClick={onClose}
              className="px-6 py-3 border-2 border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl font-medium hover:border-gray-400 dark:hover:border-gray-500 hover:bg-gray-50 dark:hover:bg-gray-600 transition-all duration-200"
            >
              Close
            </button>
            {!progress.approval ? (
              <button
                onClick={() => {
                  onApprove(progress._id)
                  onClose()
                }}
                className="px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-xl font-medium transition-colors duration-200"
              >
                Approve Reading Progress
              </button>
            ) : (
              <button
                onClick={() => {
                  onReject(progress._id)
                  onClose()
                }}
                className="px-6 py-3 bg-yellow-600 hover:bg-yellow-700 text-white rounded-xl font-medium transition-colors duration-200"
              >
                Revoke Approval
              </button>
            )}
            <button
              onClick={() => {
                onDelete(progress._id)
                onClose()
              }}
              className="px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-medium transition-colors duration-200"
            >
              Delete Progress
            </button>
          </div>
        </div>
      </div>
    </div>
  )
}

export default ReadingProgressDetailsModal

================
File: frontend/src/components/ReadingProgressForm.jsx
================
"use client"

import { useState, useEffect } from "react"

const ReadingProgressForm = ({ onSubmit, onCancel, initialData, isEditing }) => {
  const [formData, setFormData] = useState({
    bookName: "",
    authorName: "",
    publisher: "",
    numberOfPages: "",
    monthAndYear: "",
    remarks: "",
  })
  const [errors, setErrors] = useState({})
  const [isSubmitting, setIsSubmitting] = useState(false)

  useEffect(() => {
    if (initialData) {
      setFormData({
        bookName: initialData.bookName || "",
        authorName: initialData.authorName || "",
        publisher: initialData.publisher || "",
        numberOfPages: initialData.numberOfPages || "",
        monthAndYear: initialData.monthAndYear || "",
        remarks: initialData.remarks || "",
      })
    }
  }, [initialData])

  const validateForm = () => {
    const newErrors = {}

    if (!formData.bookName.trim()) {
      newErrors.bookName = "Book name is required"
    }

    if (formData.numberOfPages && (isNaN(formData.numberOfPages) || formData.numberOfPages <= 0)) {
      newErrors.numberOfPages = "Please enter a valid number of pages"
    }

    setErrors(newErrors)
    return Object.keys(newErrors).length === 0
  }

  const handleChange = (e) => {
    const { name, value } = e.target
    setFormData((prev) => ({
      ...prev,
      [name]: value,
    }))

    if (errors[name]) {
      setErrors((prev) => ({
        ...prev,
        [name]: "",
      }))
    }
  }

  const handleSubmit = async (e) => {
    e.preventDefault()

    if (!validateForm()) {
      return
    }

    setIsSubmitting(true)
    try {
      const submitData = {
        ...formData,
        numberOfPages: formData.numberOfPages ? Number.parseInt(formData.numberOfPages) : null,
      }
      await onSubmit(submitData)
    } catch (error) {
      console.error("Error submitting form:", error)
    } finally {
      setIsSubmitting(false)
    }
  }

  return (
    <div className="p-8">
      {/* Header */}
      <div className="flex justify-between items-center mb-8 pb-6 border-b border-gray-200 dark:border-gray-700">
        <div>
          <h2 className="text-3xl font-bold mb-2 bg-gradient-to-r from-indigo-600 to-purple-600 dark:from-blue-400 dark:to-purple-400 bg-clip-text text-transparent">
            {isEditing ? "Edit Reading Progress" : "Add New Book"}
          </h2>
          <p className="text-gray-600 dark:text-gray-300 mt-2">Record your reading journey and track your progress</p>
        </div>
        <button
          onClick={onCancel}
          className="w-10 h-10 flex items-center justify-center text-2xl text-gray-400 hover:text-red-500 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-full transition-all duration-200"
        >
          √ó
        </button>
      </div>

      <form onSubmit={handleSubmit} className="space-y-6">
        {/* Book Name */}
        <div className="space-y-2">
          <label htmlFor="bookName" className="block text-sm font-semibold text-gray-700 dark:text-gray-200">
            Book Name *
          </label>
          <input
            type="text"
            id="bookName"
            name="bookName"
            value={formData.bookName}
            onChange={handleChange}
            className={`w-full px-4 py-4 border-2 rounded-xl text-base transition-all duration-200 focus:outline-none focus:ring-4 ${
              errors.bookName
                ? "border-red-500 focus:border-red-500 focus:ring-red-100 dark:focus:ring-red-500/20"
                : "border-gray-200 dark:border-gray-600 focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-indigo-100 dark:focus:ring-blue-500/20"
            } bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400`}
            placeholder="e.g., ‡¥Ü‡¥ü‡µÅ ‡¥ú‡µÄ‡¥µ‡¥ø‡¥§‡¥Ç"
          />
          {errors.bookName && <span className="text-red-500 text-sm font-medium">{errors.bookName}</span>}
        </div>

        {/* Author and Publisher Row */}
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div className="space-y-2">
            <label htmlFor="authorName" className="block text-sm font-semibold text-gray-700 dark:text-gray-200">
              Author Name
            </label>
            <input
              type="text"
              id="authorName"
              name="authorName"
              value={formData.authorName}
              onChange={handleChange}
              className="w-full px-4 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200"
              placeholder=""
            />
          </div>

          <div className="space-y-2">
            <label htmlFor="publisher" className="block text-sm font-semibold text-gray-700 dark:text-gray-200">
              Publisher
            </label>
            <input
              type="text"
              id="publisher"
              name="publisher"
              value={formData.publisher}
              onChange={handleChange}
              className="w-full px-4 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200"
              placeholder=""
            />
          </div>
        </div>

        {/* Pages and Date Row */}
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div className="space-y-2">
            <label htmlFor="numberOfPages" className="block text-sm font-semibold text-gray-700 dark:text-gray-200">
              Number of Pages
            </label>
            <input
              type="number"
              id="numberOfPages"
              name="numberOfPages"
              value={formData.numberOfPages}
              onChange={handleChange}
              className={`w-full px-4 py-4 border-2 rounded-xl text-base transition-all duration-200 focus:outline-none focus:ring-4 ${
                errors.numberOfPages
                  ? "border-red-500 focus:border-red-500 focus:ring-red-100 dark:focus:ring-red-500/20"
                  : "border-gray-200 dark:border-gray-600 focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-indigo-100 dark:focus:ring-blue-500/20"
              } bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400`}
              placeholder=""
              min="1"
            />
            {errors.numberOfPages && <span className="text-red-500 text-sm font-medium">{errors.numberOfPages}</span>}
          </div>

          <div className="space-y-2">
            <label htmlFor="monthAndYear" className="block text-sm font-semibold text-gray-700 dark:text-gray-200">
              Month & Year
            </label>
            <input
              type="date"
              id="monthAndYear"
              name="monthAndYear"
              value={formData.monthAndYear}
              onChange={handleChange}
              className="w-full px-4 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200"
            />
          </div>
        </div>

        {/* Remarks */}
        <div className="space-y-2">
          <label htmlFor="remarks" className="block text-sm font-semibold text-gray-700 dark:text-gray-200">
            Remarks/Review
          </label>
          <textarea
            id="remarks"
            name="remarks"
            value={formData.remarks}
            onChange={handleChange}
            rows="4"
            className="w-full px-4 py-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base resize-y min-h-24 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200"
            placeholder="Share your thoughts about the book, key learnings, or personal review..."
          />
        </div>

        {/* Form Actions */}
        <div className="flex flex-col md:flex-row gap-4 justify-end pt-6 border-t border-gray-200 dark:border-gray-700">
          <button
            type="button"
            onClick={onCancel}
            className="px-8 py-4 border-2 border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl font-semibold hover:border-gray-400 dark:hover:border-gray-500 hover:bg-gray-50 dark:hover:bg-gray-600 transition-all duration-200"
          >
            Cancel
          </button>
          <button
            type="submit"
            disabled={isSubmitting}
            className="px-8 py-4 bg-gradient-to-r from-indigo-500 to-purple-600 dark:from-blue-600 dark:to-purple-700 text-white rounded-xl font-semibold hover:shadow-lg hover:-translate-y-0.5 transition-all duration-200 disabled:opacity-60 disabled:cursor-not-allowed disabled:transform-none disabled:shadow-none"
          >
            {isSubmitting ? (
              <div className="flex items-center gap-2">
                <div className="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div>
                Saving...
              </div>
            ) : isEditing ? (
              "Update Progress"
            ) : (
              "Add Book"
            )}
          </button>
        </div>
      </form>
    </div>
  )
}

export default ReadingProgressForm

================
File: frontend/src/components/SelectField.jsx
================
import React from 'react';
import { ChevronDown } from 'lucide-react';

const SelectField = ({ label, name, value, options, icon, onChange }) => {
  return (
    <div className="relative group mb-4">
      {icon && (
        <div className="absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none z-10">
          {icon}
        </div>
      )}

      <select
        className={`w-full appearance-none bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3.5
          ${icon ? 'pl-12' : 'pl-4'}
          outline-none transition-all duration-300
          focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500
          text-slate-800 dark:text-white cursor-pointer
        `}
        value={value}
        onChange={(e) => {
             // Handle both state setters logic
             if(typeof onChange === 'function') onChange(prev => ({...prev, [name]: e.target.value}));
        }}
      >
        <option value="" disabled className="text-slate-400">Select {label}</option>
        {options.map((option) => (
          <option key={option} value={option}>
            {option.charAt(0).toUpperCase() + option.slice(1)}
          </option>
        ))}
      </select>

      <div className="absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-slate-400">
        <ChevronDown size={16} />
      </div>

      {/* Static Label (Selects are harder to float effectively) */}
      <label className="absolute -top-2 left-3 text-xs text-primary-600 dark:text-primary-400 bg-white dark:bg-slate-900 px-1 font-medium">
        {label}
      </label>
    </div>
  );
};

export default SelectField;

================
File: frontend/src/main.jsx
================
import { Buffer } from 'buffer';
window.Buffer = Buffer;
import { StrictMode } from 'react'
import { createRoot } from 'react-dom/client'
import './index.css'
import App from './App.jsx'


import { BrowserRouter } from 'react-router-dom'

createRoot(document.getElementById('root')).render(
  <StrictMode>
    <BrowserRouter>
      <App />
    </BrowserRouter>
  </StrictMode>,
)

================
File: frontend/src/pages/admin/AcademicRegister.jsx
================
import React from 'react';
import { motion } from 'framer-motion';
import Header from "../../components/Header";
import Card from "../../components/Card";
import { Users, GraduationCap, Settings2Icon, LineChart, MousePointer2, ListTodo, LucideCopySlash, ArchiveIcon, ClipboardList, Award, ClipboardCheck, HandCoins, Medal,  } from "lucide-react";

const AcademicRegister = () => {
  const cards = [
    { title: "Students' Leave Status", icon: ClipboardList , route: "/dashboard/admin/std-attendance-register" },
    { title: "Teachers' Attendance Register", icon: ListTodo, route: "/dashboard/admin/staff-attendance-register" },
    { title: "Quarterly Subject Status", icon: GraduationCap, route: "/dashboard/admin/subject-status" },
    { title: "CE Status", icon: Award, route: "/dashboard/admin/ce-status" }
  ];

  return (
    <div className="min-h-screen flex flex-col items-center bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-900 dark:to-gray-800">
      <Header />
      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-20 w-full max-w-4xl p-4">
        {cards.map((card, index) => (
          <motion.div
          key={index}
            initial={{ opacity: 0, y: 50 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ type: "spring", stiffness: 100, damping: 10, delay: index * 0.1 }}
          >
            <Card title={card.title} icon={card.icon} route={card.route} />
          </motion.div>


    
      

        ))}
      </div>
    </div>
  );
};

export default AcademicRegister

================
File: frontend/src/pages/admin/BatchAcademicStatus.jsx
================
import React, { useEffect, useState } from "react";
import { Eye, Pencil, Plus, Trash2 } from "lucide-react"; // or use Heroicons if preferred
import Header from "../../components/Header";
import { useNavigate } from "react-router-dom";
import { useAdminStore } from "../../store/useAdminMngStore";
import { useAuthStore } from "../../store/useAuthStore";

const BatchAcademicStatus = ({item}) => {
  const { batches, getBatches, addAcademicStatuslink, deleteAcademicStatuslink } = useAdminStore();
  const {authUser} = useAuthStore()
  const [academicStatusLink, setAcademicStatusLink] = useState("");
  const [editingBatchId, setEditingBatchId] = useState(null);

  const navigate = useNavigate();

  useEffect(() => {
    getBatches();
  }, [getBatches]);

  const handleSubmit = async (batchId) => {
    const isValidLink = academicStatusLink.includes("https://docs.google.com/spreadsheets");
    if (!isValidLink) return alert("Please enter a valid Google Sheets link.");

    try {
      await addAcademicStatuslink(academicStatusLink, batchId, item);
      await getBatches();
      setEditingBatchId(null);
      setAcademicStatusLink("");
    } catch (err) {
      console.error("Failed to update CE link", err);
    }
  };
  function onDelete(id){
    deleteAcademicStatuslink(id, item);
  }

  return (
    <>
      <Header />
      <div className="min-h-screen bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-900 dark:to-gray-800 p-6 pt-24">
        <h2 className="text-xl font-extrabold text-gray-900 dark:text-white mb-4 ml-8 font-oswald">
          {item}
        </h2>

        <div className="grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 px-2">
          {batches.map((batch, index) => (
            <div
              key={batch._id || index}
              className="bg-white dark:bg-gray-800 rounded-2xl shadow-md p-3 transition hover:shadow-xl"
            >
           <div className="flex items-center justify-between mb-1">
            <div className="flex items-center gap-3">
                <div className="w-10 h-10 rounded-full bg-sky-700 text-white flex items-center justify-center font-semibold">
                {index + 1}
                </div>
                <div className="text-lg font-semibold text-gray-800 dark:text-white">
                {batch.name}
                </div>
            </div>

            <div className="flex items-center gap-3">
                {authUser?.role === "admin" && !batch[item] && (
                  <button
                    onClick={() => {
                      setEditingBatchId(batch._id);
                      setAcademicStatusLink("");
                    }}
                    className="text-blue-600 hover:text-blue-800"
                    title="Add Link"
                  >
                    <Plus size={20} />
                  </button>
                )}

                {batch[item] && (
                  <>
                    {authUser?.role === "admin" && (
                      <>
                        <button
                          onClick={() => onDelete(batch._id)}
                          className="text-red-500 hover:text-red-600"
                          title="Delete Link"
                        >
                          <Trash2 size={18} />
                        </button>
                        <button
                          onClick={() => {
                            setEditingBatchId(batch._id);
                            setAcademicStatusLink(batch[item] || "");
                          }}
                          className="text-yellow-500 hover:text-yellow-600"
                          title="Edit Link"
                        >
                          <Pencil size={18} />
                        </button>
                      </>
                    )}
                    <a
                      href={batch[item]}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="text-green-600 hover:text-green-700"
                      title="View Link"
                    >
                      <Eye size={18} />
                    </a>
                  </>
                )}
              </div>

            </div>


           

              {/* Input Field */}
              {editingBatchId === batch._id && (
                <div className="mt-4">
                  <input
                    type="text"
                    value={academicStatusLink}
                    onChange={(e) => setAcademicStatusLink(e.target.value)}
                    placeholder="Paste Google Sheet link"
                    className="w-full border rounded-lg px-3 py-2 text-sm dark:bg-gray-700 dark:text-white"
                  />
                  <div className="flex justify-end mt-2 gap-2">
                    <button
                      onClick={() => handleSubmit(batch._id)}
                      className="bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 text-sm"
                    >
                      Save
                    </button>
                    <button
                      onClick={() => {
                        setEditingBatchId(null);
                        setAcademicStatusLink("");
                      }}
                      className="text-sm text-gray-500 hover:text-gray-800"
                    >
                      Cancel
                    </button>
                  </div>
                </div>
              )}
            </div>
          ))}
        </div>
      </div>
    </>
  );
};


export default BatchAcademicStatus

================
File: frontend/src/pages/admin/RecordPage.jsx
================
import React, { useState, useEffect } from "react";
import { 
  Folder, FileText, Search, Plus, MoreVertical, 
  ExternalLink, Edit3, Trash2, X, Save, File, 
  LayoutGrid, List as ListIcon, FolderOpen 
} from "lucide-react";
import { useRecordStore } from "../../store/useRecordStore";
import Header from "../../components/Header";
import { motion, AnimatePresence } from "framer-motion";
import { useAuthStore } from "../../store/useAuthStore";

const RecordPage = () => {
  const { authUser } = useAuthStore();
  const {
    records,
    fetchRecords,
    addRecord,
    updateRecord,
    deleteRecord,
    isLoading,
  } = useRecordStore();

  const [activeFolder, setActiveFolder] = useState("All");
  const [searchQuery, setSearchQuery] = useState("");
  const [viewMode, setViewMode] = useState("grid"); // 'grid' or 'list'
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [editingRecord, setEditingRecord] = useState(null);

  useEffect(() => {
    fetchRecords();
  }, [fetchRecords]);

  // Extract unique folders
  const folders = ["All", ...new Set(records.map(r => r.folder).filter(Boolean))];

  // Filter logic
  const filteredRecords = records.filter(record => {
    const matchesFolder = activeFolder === "All" || record.folder === activeFolder;
    const matchesSearch = record.name.toLowerCase().includes(searchQuery.toLowerCase());
    return matchesFolder && matchesSearch;
  });

  const handleEdit = (record) => {
    setEditingRecord(record);
    setIsModalOpen(true);
  };

  const handleDelete = async (id) => {
    if (window.confirm("Are you sure you want to delete this file?")) {
      await deleteRecord(id);
    }
  };

  return (
    <div className="min-h-screen bg-slate-50 dark:bg-surface-dark pb-20">
      <Header page="Academic Repository" />
      
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-8">
        
        {/* 1. Top Toolbar */}
        <div className="flex flex-col md:flex-row justify-between items-end md:items-center gap-4 mb-8">
          <div>
            <h1 className="text-3xl font-display font-bold text-slate-900 dark:text-white">
              Documents & Records
            </h1>
            <p className="text-slate-500 dark:text-slate-400">
              Manage syllabus, circulars, and academic resources.
            </p>
          </div>

          <div className="flex items-center gap-3 w-full md:w-auto">
            {/* Search */}
            <div className="relative flex-1 md:w-64">
              <Search className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400" size={18} />
              <input
                type="text"
                placeholder="Search files..."
                value={searchQuery}
                onChange={(e) => setSearchQuery(e.target.value)}
                className="w-full pl-10 pr-4 py-2.5 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-primary-500 outline-none transition-all shadow-sm"
              />
            </div>

            {/* View Toggle */}
            <div className="flex bg-white dark:bg-slate-800 p-1 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm">
              <button 
                onClick={() => setViewMode("grid")}
                className={`p-2 rounded-lg transition-all ${viewMode === "grid" ? "bg-slate-100 dark:bg-slate-700 text-primary-600" : "text-slate-400"}`}
              >
                <LayoutGrid size={18} />
              </button>
              <button 
                onClick={() => setViewMode("list")}
                className={`p-2 rounded-lg transition-all ${viewMode === "list" ? "bg-slate-100 dark:bg-slate-700 text-primary-600" : "text-slate-400"}`}
              >
                <ListIcon size={18} />
              </button>
            </div>

            {/* Add Button (Admin Only) */}
            {authUser?.role === "admin" && (
              <button
                onClick={() => { setEditingRecord(null); setIsModalOpen(true); }}
                className="flex items-center gap-2 px-5 py-2.5 bg-primary-600 hover:bg-primary-700 text-white rounded-xl font-bold shadow-lg shadow-primary-500/20 transition-all active:scale-95"
              >
                <Plus size={20} />
                <span className="hidden sm:inline">Upload</span>
              </button>
            )}
          </div>
        </div>

        {/* 2. Folder Navigation */}
        <div className="flex overflow-x-auto pb-4 gap-3 scrollbar-hide mb-6">
          {folders.map(folder => (
            <button
              key={folder}
              onClick={() => setActiveFolder(folder)}
              className={`flex items-center gap-2 px-4 py-2.5 rounded-xl border transition-all whitespace-nowrap
                ${activeFolder === folder 
                  ? "bg-white dark:bg-slate-800 border-primary-500 text-primary-600 shadow-md ring-1 ring-primary-500/20" 
                  : "bg-slate-100 dark:bg-slate-800/50 border-transparent text-slate-500 hover:bg-white dark:hover:bg-slate-800 hover:shadow-sm"}
              `}
            >
              {activeFolder === folder ? <FolderOpen size={18} /> : <Folder size={18} />}
              <span className="font-medium text-sm">{folder}</span>
            </button>
          ))}
        </div>

        {/* 3. File Display Area */}
        {filteredRecords.length === 0 ? (
          <div className="flex flex-col items-center justify-center py-20 text-slate-400">
            <div className="w-20 h-20 bg-slate-100 dark:bg-slate-800 rounded-full flex items-center justify-center mb-4">
              <FolderOpen size={32} />
            </div>
            <p>No records found in this folder.</p>
          </div>
        ) : (
          <motion.div 
            layout
            className={
              viewMode === "grid" 
                ? "grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" 
                : "flex flex-col gap-3"
            }
          >
            <AnimatePresence>
              {filteredRecords.map((record) => (
                <FileCard 
                  key={record._id} 
                  record={record} 
                  viewMode={viewMode}
                  onEdit={() => handleEdit(record)}
                  onDelete={() => handleDelete(record._id)}
                  isAdmin={authUser?.role === "admin"}
                />
              ))}
            </AnimatePresence>
          </motion.div>
        )}

      </div>

      {/* 4. Add/Edit Modal */}
      {isModalOpen && (
        <RecordModal 
          isOpen={isModalOpen} 
          onClose={() => setIsModalOpen(false)} 
          initialData={editingRecord}
          folders={folders}
          onSubmit={editingRecord ? updateRecord : addRecord}
        />
      )}
    </div>
  );
};

// --- Sub-Component: File Card ---
const FileCard = ({ record, viewMode, onEdit, onDelete, isAdmin }) => {
  const isGrid = viewMode === "grid";

  return (
    <motion.div
      layout
      initial={{ opacity: 0, scale: 0.95 }}
      animate={{ opacity: 1, scale: 1 }}
      exit={{ opacity: 0, scale: 0.95 }}
      className={`group relative bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-2xl hover:shadow-lg transition-all duration-300 overflow-hidden
        ${isGrid ? "p-5 flex flex-col h-full" : "p-4 flex items-center justify-between"}
      `}
    >
      {/* Icon & Decor */}
      <div className={`flex items-start gap-4 ${isGrid ? "mb-4" : ""}`}>
        <div className={`shrink-0 flex items-center justify-center rounded-2xl bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-slate-700 dark:to-slate-800 text-blue-600 dark:text-blue-400
          ${isGrid ? "w-14 h-14" : "w-12 h-12"}
        `}>
          <FileText size={isGrid ? 28 : 24} />
        </div>
        
        <div className="min-w-0 flex-1">
          <h3 className="font-bold text-slate-800 dark:text-white truncate" title={record.name}>
            {record.name}
          </h3>
          {isGrid && (
            <>
              <span className="inline-block px-2 py-0.5 mt-1 rounded text-[10px] font-bold uppercase tracking-wider bg-slate-100 dark:bg-slate-700 text-slate-500">
                {record.folder || "Uncategorized"}
              </span>
              <p className="text-sm text-slate-500 dark:text-slate-400 mt-2 line-clamp-2 h-10">
                {record.description || "No description provided."}
              </p>
            </>
          )}
          {!isGrid && (
             <p className="text-xs text-slate-500 dark:text-slate-400 mt-0.5 truncate max-w-md">
               {record.description} ‚Ä¢ <span className="font-medium text-slate-400">{record.folder}</span>
             </p>
          )}
        </div>
      </div>

      {/* Actions Footer */}
      <div className={`flex items-center gap-2 ${isGrid ? "mt-auto pt-4 border-t border-slate-100 dark:border-slate-700/50" : ""}`}>
        {record.link && (
          <a 
            href={record.link} 
            target="_blank" 
            rel="noopener noreferrer"
            className="flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-slate-50 hover:bg-blue-50 dark:bg-slate-700 dark:hover:bg-slate-600 text-slate-700 dark:text-slate-200 text-sm font-medium rounded-lg transition-colors group/link"
          >
            <ExternalLink size={16} className="group-hover/link:text-blue-500" />
            Open
          </a>
        )}
        
        {isAdmin && (
          <div className={`flex gap-1 ${!isGrid && "ml-4"}`}>
            <button onClick={onEdit} className="p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors">
              <Edit3 size={18} />
            </button>
            <button onClick={onDelete} className="p-2 text-slate-400 hover:text-rose-600 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-colors">
              <Trash2 size={18} />
            </button>
          </div>
        )}
      </div>
    </motion.div>
  );
};

// --- Sub-Component: Modal Form ---
const RecordModal = ({ isOpen, onClose, initialData, onSubmit, folders }) => {
  const [formData, setFormData] = useState({
    name: initialData?.name || "",
    description: initialData?.description || "",
    folder: initialData?.folder || "",
    link: initialData?.link || ""
  });
  const [isSubmitting, setIsSubmitting] = useState(false);

  const handleSubmit = async (e) => {
    e.preventDefault();
    setIsSubmitting(true);
    if(initialData) await onSubmit(initialData._id, formData);
    else await onSubmit(formData);
    setIsSubmitting(false);
    onClose();
  };

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm">
      <motion.div 
        initial={{ opacity: 0, scale: 0.95 }}
        animate={{ opacity: 1, scale: 1 }}
        className="bg-white dark:bg-slate-800 w-full max-w-lg rounded-3xl shadow-2xl overflow-hidden"
      >
        <div className="p-6 border-b border-slate-200 dark:border-slate-700 flex justify-between items-center">
          <h2 className="text-xl font-bold text-slate-900 dark:text-white">
            {initialData ? "Edit File" : "Upload New File"}
          </h2>
          <button onClick={onClose} className="p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-500">
            <X size={20} />
          </button>
        </div>

        <form onSubmit={handleSubmit} className="p-6 space-y-4">
          <div>
            <label className="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">File Name</label>
            <div className="relative">
              <File className="absolute left-3 top-3 text-slate-400" size={18} />
              <input 
                required
                value={formData.name}
                onChange={e => setFormData({...formData, name: e.target.value})}
                className="w-full pl-10 p-2.5 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-primary-500 outline-none"
                placeholder="e.g. Exam Schedule 2025"
              />
            </div>
          </div>

          <div>
            <label className="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Folder / Category</label>
            <div className="relative">
              <Folder className="absolute left-3 top-3 text-slate-400" size={18} />
              <input 
                list="folderOptions"
                value={formData.folder}
                onChange={e => setFormData({...formData, folder: e.target.value})}
                className="w-full pl-10 p-2.5 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-primary-500 outline-none"
                placeholder="e.g. Syllabus"
              />
              <datalist id="folderOptions">
                {folders.filter(f => f !== "All").map(f => <option key={f} value={f} />)}
              </datalist>
            </div>
          </div>

          <div>
            <label className="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Link URL</label>
            <div className="relative">
              <ExternalLink className="absolute left-3 top-3 text-slate-400" size={18} />
              <input 
                value={formData.link}
                onChange={e => setFormData({...formData, link: e.target.value})}
                className="w-full pl-10 p-2.5 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-primary-500 outline-none"
                placeholder="https://..."
              />
            </div>
          </div>

          <div>
            <label className="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Description</label>
            <textarea 
              rows={3}
              value={formData.description}
              onChange={e => setFormData({...formData, description: e.target.value})}
              className="w-full p-3 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-primary-500 outline-none resize-none"
              placeholder="Add details..."
            />
          </div>

          <div className="pt-2 flex justify-end gap-3">
            <button type="button" onClick={onClose} className="px-5 py-2.5 text-slate-600 hover:bg-slate-100 rounded-xl font-medium transition-colors">
              Cancel
            </button>
            <button type="submit" disabled={isSubmitting} className="flex items-center gap-2 px-6 py-2.5 bg-primary-600 hover:bg-primary-700 text-white rounded-xl font-bold shadow-lg shadow-primary-500/20 transition-all">
              <Save size={18} /> Save Record
            </button>
          </div>
        </form>
      </motion.div>
    </div>
  );
};

export default RecordPage;

================
File: frontend/src/pages/admin/StaffProfile.jsx
================
import React, { useState } from 'react';
import {
  UserCircle,
  Phone,
  Mail,
  Building2,
  GraduationCap,
  BadgeInfo,
  BookUser,
  MessageCircle,
} from 'lucide-react';
import { useAuthStore } from '../../store/useAuthStore';
import Header from '../../components/Header';
import ChangePasswordModal from '../../components/ChangePasswordModal';

const StudentProfile = () => {
  const {authUser} = useAuthStore()
    const [showChangePassword, setShowChangePassword] = useState(false);
  return (
    <div className="min-h-screen bg-gradient-to-br from-sky-100 to-sky-200 dark:from-gray-900 dark:to-gray-800 flex items-center justify-center ">
        <Header />

      <div className="bg-white dark:bg-gray-900 sm:rounded-2xl shadow-2xl w-full max-w-3xl sm:h-auto">
        {/* Header */}
        <div className="bg-gradient-to-tr from-sky-400 to-sky-500 h-36 relative">
          <div className="absolute -bottom-16 left-1/2 transform -translate-x-1/2">
            <div className="w-32 h-32 bg-white rounded-full p-1 shadow-lg">
              <img
                className="rounded-full object-cover w-full h-full"
                src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTO-15oVSs246BVTRobf0Ye3gECp5_E3-OKUGgAD4N8HZgj8xa-PElzug6S6tW0sdlT1cY&usqp=CAU"
                alt="Student Profile"
              />
            </div>
          </div>
        </div>

        {/* Profile Info */}
        <div className="mt-20 px-6 pb-10 text-center">
          <h2 className="text-2xl font-bold text-gray-800 dark:text-white">{authUser.name}</h2>
          <p className="text-sky-500 dark:text-sky-400 mb-6">
              {authUser.role.charAt(0).toUpperCase() + authUser.role.slice(1)}
            </p>


          <div className="grid grid-cols-1 sm:grid-cols-2 gap-5 text-left text-gray-700 dark:text-gray-300">
            
            <InfoRow icon={<Phone size={20} />} label="Contact Number" value={authUser.phoneNumber} />
            <InfoRow icon={<Mail size={20} />} label="Email" value={authUser.email} />
            <InfoRow icon={<Building2 size={20} />} label="Address" value={authUser.address} />
            <InfoRow icon={<MessageCircle size={20} />} label="Whatsapp Number" value={authUser?.whatsupNumber} />
            <button
              onClick={() => setShowChangePassword(true)}
              className="text-sky-600 underline hover:text-sky-800"
            >
              Change Password
            </button>
            {showChangePassword && (
              <ChangePasswordModal onClose={() => setShowChangePassword(false)} />
            )}

          </div>

          {/* <div className="mt-8">
            <button className="bg-sky-500 hover:bg-sky-600 text-white px-6 py-2 rounded-full transition-all">
              Edit Profile
            </button>
          </div> */}
        </div>
      </div>
    </div>
  );
};

// Reusable InfoRow Component
const InfoRow = ({ icon, label, value }) => (
  <div className="flex items-start space-x-3">
    <div className="mt-1 text-sky-500">{icon}</div>
    <div>
      <p className="text-sm font-semibold">{label}</p>
      <p className="text-base">{value}</p>
    </div>
  </div>
);

export default StudentProfile;

================
File: frontend/src/pages/staff/BatchStudentsDetails.jsx
================
import React, { useEffect } from 'react'
import StudentTable from '../../components/StudentTable'
import { useStudentStore } from '../../store/studentStore'
import { useParams } from 'react-router-dom';
import Header from '../../components/Header';

const BatchStudentsDetails = () => {
    const { batchId } = useParams();

const { getBatchStudents, batchStudents } = useStudentStore()
    useEffect(() => {
        getBatchStudents(batchId)
    }, [getBatchStudents])
    
  return (
   <>
   <div className="min-h-screen flex flex-col items-center bg-white dark:bg-gray-900 text-gray-900 dark:text-white">
    <Header />
    <StudentTable students={batchStudents} />
    </div>
   </>
  )
}

export default BatchStudentsDetails

================
File: frontend/src/pages/staff/FeesTeacher.jsx
================
import { useState, useEffect, useMemo } from "react"
import {
  Download,
  Calendar,
  DollarSign,
  AlertCircle,
  CheckCircle,
  Search,
  Filter,
  ChevronDown,
  ChevronUp,
  ArrowUpRight,
  Users,
  BarChart3,
} from "lucide-react"
import { useAdminStore } from "../../store/useAdminMngStore"
import { useFeeStore } from "../../store/feesSrore"
import toast from "react-hot-toast" 

import { jsPDF } from "jspdf";
import autoTable from "jspdf-autotable";
import { useParams } from "react-router-dom"
import { useStaffStore } from "../../store/useStaffStore"
import { useStudentStore } from "../../store/studentStore"
import Header from "../../components/Header"

const months = [ "ÿ¥ŸàŸëÿßŸÑ", "ÿ∞Ÿà ÿßŸÑŸÇÿπÿØÿ©", "ÿ∞Ÿà ÿßŸÑÿ≠ÿ¨ÿ©", "ŸÖÿ≠ÿ±ŸëŸÖ", "ÿµŸÅÿ±", "ÿ±ÿ®Ÿäÿπ ÿßŸÑÿ£ŸàŸëŸÑ",
   "ÿ±ÿ®Ÿäÿπ ÿßŸÑÿ¢ÿÆÿ±", "ÿ¨ŸÖÿßÿØŸâ ÿßŸÑÿ£ŸàŸÑŸâ", "ÿ¨ŸÖÿßÿØŸâ ÿßŸÑÿ£ÿÆÿ±Ÿâ", "ÿ±ÿ¨ÿ®", "ÿ¥ÿπÿ®ÿßŸÜ", "ÿ±ŸÖÿ∂ÿßŸÜ"];

export default function FeesTeacher() {
  const { batchId } = useParams();
  const {batch, getBatchById, isLoading } = useStaffStore()
  const { getBatchStudents, batchStudents} = useStudentStore()
  const {
    fees,
    isLoading: feesLoading,
    fetchFees,
    getStudentStatus,
    getStudentProgress,
    getBatchStats
  } = useFeeStore()

  
  const [searchTerm, setSearchTerm] = useState("")
  const [loading, setLoading] = useState(true)
  const [selectedMonths, setSelectedMonths] = useState([])
  const [selectedStatus, setSelectedStatus] = useState("all")
  const [sortBy, setSortBy] = useState("name")
  const [sortDirection, setSortDirection] = useState("asc")

  useEffect(() => {
    const fetchData = async () => {
      setLoading(true)
      try {
        await getBatchById(batchId)
        getBatchStudents(batchId)
      } catch (error) {
        console.error("Error fetching data:", error)
      } finally {
        setLoading(false)
      }
    }
    fetchData()
  }, [])

  // Fetch fees when batch changes
  useEffect(() => {
    if (batch) {
      fetchFees(batchId)
    }
  }, [batch, fetchFees])


 
  const filteredStudents = useMemo(() => {
  
    return batchStudents
      .map((student) => {
        return {
          id: student._id,
          name: student?.name || "Unknown",
          progress: getStudentProgress(student._id),
          status: getStudentStatus(student._id)
        };
      })
      .filter(student => {
        const matchesSearch = student.name.toLowerCase().includes(searchTerm.toLowerCase());
        const paidMonths = Object.values(student.status).filter(v => v).length;
        const totalMonths = Object.values(student.status).length || 1;
        
        // Status filtering
        if (selectedStatus === "paid" && paidMonths === 0) return false;
        if (selectedStatus === "pending" && paidMonths === totalMonths) return false;
        
        // Month filtering
        if (selectedMonths.length > 0) {
          return selectedMonths.some(m => student.status[m] !== undefined);
        }
        
        return true;
      })
      .sort((a, b) => {
        const modifier = sortDirection === "asc" ? 1 : -1;
        if (sortBy === "name") return a.name.localeCompare(b.name) * modifier;
        if (sortBy === "progress") return (a.progress - b.progress) * modifier;
        return 0;
      });
  }, [
     batchStudents, searchTerm, selectedStatus, 
    selectedMonths, sortBy, sortDirection, fees 
  ]);

  const stats = useMemo(() => {
    if (!batch) {
      return {
        totalPaid: 0,
        totalPending: 0,
        totalAmount: "‚Çπ0"
      }
    }
    
    return getBatchStats(
      batchId, 
      batchStudents?.length || 0
    )
  }, [batchId, getBatchStats, fees, batchStudents?.length]);

 

  // Toggle sort direction
  const toggleSort = (field) => {
    if (sortBy === field) {
      setSortDirection(sortDirection === "asc" ? "desc" : "asc")
    } else {
      setSortBy(field)
      setSortDirection("asc")
    }
  }

  // Toggle month selection for filtering
  const toggleMonthFilter = (month) => {
    setSelectedMonths((prev) => (prev.includes(month) ? prev.filter((m) => m !== month) : [...prev, month]))
  }

  
  if (loading) {
    return (
      <div className="min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center">
        <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"></div>
      </div>
    )
  }

  return (
    <div className="p-4 sm:p-6 bg-gray-50 dark:bg-gray-900 min-h-screen space-y-6 transition-colors">
      {/* Header */}
      <Header />
      <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6 pt-6">
        <div>
          <h1 className="text-3xl sm:text-4xl font-extrabold text-gray-900 dark:text-gray-100 bg-gradient-to-r from-indigo-500 to-purple-600 bg-clip-text text-transparent">
            Monthly Fees
          </h1>
        </div>

        <div className="flex items-center gap-3">
       
        </div>
      </div>

     

   

      {/* TABLE (visible on md+) */}
      <div className="hidden md:block bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden" id="pdf-content">
        <div className="p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
          <div>
            <h2 className="text-xl font-bold text-gray-800 dark:text-gray-100 flex items-center gap-2">
              <Calendar className="w-5 h-5 text-indigo-500" />
              {batch.name || "Select a Batch"} 
            </h2>
            <p className="text-sm text-gray-600 dark:text-gray-400 mt-1">
              {filteredStudents.length} student{filteredStudents.length !== 1 ? "s" : ""} ‚Ä¢{" "}
              {new Date().toLocaleDateString("en-US", { month: "long", year: "numeric" })}
            </p>
          </div>

          <div className="flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400">
            <span className="flex items-center gap-1">
              <span className="w-3 h-3 rounded-full bg-green-500"></span>
              Paid
            </span>
            <span className="flex items-center gap-1">
              <span className="w-3 h-3 rounded-full bg-gray-300 dark:bg-gray-600"></span>
              Pending
            </span>
          </div>
        </div>

        {batchStudents?.length > 0 ? (
          <div className="overflow-x-auto">
            <table className="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
              <thead className="bg-gray-50 dark:bg-gray-750">
                <tr>
                  <th
                    scope="col"
                    className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer"
                    onClick={() => toggleSort("name")}
                  >
                    <div className="flex items-center gap-1">
                      Student
                      {sortBy === "name" &&
                        (sortDirection === "asc" ? <ChevronUp size={14} /> : <ChevronDown size={14} />)}
                    </div>
                  </th>
                  {months.map((m) => (
                    <th
                      key={m}
                      className="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"
                    >
                      {m}
                    </th>
                  ))}
                  <th
                    scope="col"
                    className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer"
                    onClick={() => toggleSort("progress")}
                  >
                    <div className="flex items-center gap-1">
                      Progress
                      {sortBy === "progress" &&
                        (sortDirection === "asc" ? <ChevronUp size={14} /> : <ChevronDown size={14} />)}
                    </div>
                  </th>
                </tr>
              </thead>
              <tbody className="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                {filteredStudents.map((student) => (
                  <tr key={student.id} className="hover:bg-gray-500 dark:hover:bg-gray-750 transition-colors">
                    <td className="px-6 py-4 whitespace-nowrap">
                      <div className="flex items-center">
                        <div className="flex-shrink-0 h-8 w-8 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center">
                          <Users className="h-4 w-4 text-indigo-600 dark:text-indigo-400" />
                        </div>
                        <div className="ml-3">
                          <div className="text-sm font-medium text-gray-900 dark:text-gray-100">{student.name}</div>
                        </div>
                      </div>
                    </td>
                    {months.map((m) => (
                      <td key={m} className="px-1 py-4 whitespace-nowrap text-center">
                        <StyledCheckbox checked={student.status[m]} onChange={() => toggle(student.id, m)} />
                      </td>
                    ))}
                    <td className="px-6 py-4 whitespace-nowrap">
                      <div className="flex items-center gap-3">
                        <ProgressBar value={student.progress} />
                        <span className="text-xs font-medium text-gray-700 dark:text-gray-300">
                          {student.progress}%
                        </span>
                      </div>
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        ) : (
          <div className="p-8 text-center">
            <Users className="h-12 w-12 mx-auto text-gray-400 mb-3" />
            <h3 className="text-lg font-medium text-gray-900 dark:text-gray-100 mb-1">No batchStudents found</h3>
            <p className="text-gray-600 dark:text-gray-400">
              {batch
                ? "Try selecting a different batch or adjusting your filters"
                : "Please select a batch to view batchStudents"}
            </p>
          </div>
        )}
      </div>

      {/* CARDS (visible below md) */}
      <div className="md:hidden space-y-4">
        {batchStudents?.length > 0 ? (
          filteredStudents.map((student) => (
            <div
              key={student.id}
              className="bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden transition-colors"
            >
              <div className="p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                <div className="flex items-center">
                  <div className="flex-shrink-0 h-8 w-8 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center">
                    <Users className="h-4 w-4 text-indigo-600 dark:text-indigo-400" />
                  </div>
                  <div className="ml-3">
                    <div className="text-sm font-medium text-gray-900 dark:text-gray-100">{student.name}</div>
                  </div>
                </div>
                <div className="flex items-center gap-2">
                  <span className="text-xs font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded-full">
                    {student.progress}%
                  </span>
                
                </div>
              </div>

              <div className="p-4">
                <div className="mb-3">
                  <ProgressBar value={student.progress} />
                </div>

                <div className="grid grid-cols-4 gap-2">
                  {months.map((m) => (
                    <div key={m} className="flex flex-col items-center">
                      <span className="text-xs text-gray-600 dark:text-gray-400 mb-1">{m}</span>
                      <StyledCheckbox checked={student.status[m]}  />
                    </div>
                  ))}
                </div>
              </div>
            </div>
          ))
        ) : (
          <div className="bg-white dark:bg-gray-800 rounded-xl shadow-md p-8 text-center">
            <Users className="h-12 w-12 mx-auto text-gray-400 mb-3" />
            <h3 className="text-lg font-medium text-gray-900 dark:text-gray-100 mb-1">No batchStudents found</h3>
            <p className="text-gray-600 dark:text-gray-400">
              {batch
                ? "Try selecting a different batch or adjusting your filters"
                : "Please select a batch to view batchStudents"}
            </p>
          </div>
        )}
      </div>
    </div>
  )
}

// Card Component
function Card({ title, value, icon, color }) {
  const getColorClasses = () => {
    switch (color) {
      case "green":
        return "bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400"
      case "amber":
        return "bg-amber-50 dark:bg-amber-900/20 text-amber-600 dark:text-amber-400"
      case "red":
        return "bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400"
      case "indigo":
      default:
        return "bg-indigo-50 dark:bg-indigo-900/20 text-indigo-600 dark:text-indigo-400"
    }
  }

  return (
    <div className="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 transition-colors">
      <div className="flex items-center justify-between mb-3">
        <h3 className="text-sm font-medium text-gray-600 dark:text-gray-400">{title}</h3>
        <div className={`p-2 rounded-lg ${getColorClasses()}`}>{icon}</div>
      </div>
      <p className="text-2xl font-bold text-gray-900 dark:text-gray-100">{value}</p>
      <div className="mt-2 flex items-center text-xs text-green-600 dark:text-green-400">
        <BarChart3 className="h-3 w-3 mr-1" />
      </div>
    </div>
  )
}

// Styled Checkbox Component
function StyledCheckbox({ checked, onChange }) {
  const [isLoading, setIsLoading] = useState(false);

  const handleChange = async () => {
    setIsLoading(true);
    await onChange();
    setIsLoading(false);
  };

  return (
    <label className="inline-flex items-center justify-center cursor-pointer">
      <input
        type="checkbox"
        checked={checked}
        className="sr-only"
        disabled={isLoading}
      />
      <span
        className={`
          h-6 w-6 flex items-center justify-center rounded-md transition-all duration-200
          ${isLoading ? "opacity-70 animate-pulse" : ""}
          ${
            checked
              ? "bg-indigo-600 dark:bg-indigo-500 shadow-md"
              : "bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 hover:border-indigo-300 dark:hover:border-indigo-500"
          }
        `}
      >
       
        
      </span>
    </label>
  );
}

// Progress Bar Component
function ProgressBar({ value }) {
  // Determine color based on value
  const getBarColor = () => {
    if (value < 30) return "bg-red-500 dark:bg-red-400"
    if (value < 70) return "bg-amber-500 dark:bg-amber-400"
    return "bg-green-500 dark:bg-green-400"
  }

  return (
    <div className="w-full">
      <div className="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 overflow-hidden">
        <div
          className={`${getBarColor()} h-full transition-all duration-500 rounded-full`}
          style={{ width: `${value}%` }}
        />
      </div>
    </div>
  )
}

================
File: frontend/src/pages/student/StdAcademicRegister.jsx
================
import React, { useEffect } from 'react';
import { motion } from 'framer-motion';
import Header from "../../components/Header";
import Card from "../../components/Card";
import { Users, GraduationCap, Settings2Icon, LineChart, MousePointer2, ListTodo, LucideCopySlash, ArchiveIcon, ClipboardList, Award, ClipboardCheck, HandCoins, Medal,  } from "lucide-react";
import { useStaffStore } from '../../store/useStaffStore';
import { useAuthStore } from '../../store/useAuthStore';

const AcademicRegister = () => {
    const { getBatchById, batch } = useStaffStore();
    const { authUser} = useAuthStore();
  
  
    useEffect(() => {
        if(authUser && authUser.batchId){
            getBatchById(authUser.batchId);
        }
    }, [authUser, getBatchById]);
  
    

  const cards = [
    { title: "Students' Leave Status", icon: ClipboardList , url: batch.stdAttendanceRegister },
    { title: "Quarterly Subject Status", icon: GraduationCap, url: batch.subjectStatus },
    { title: "CE Status", icon: Award, url: batch.ceStatus }
  ];

  return (
    <div className="min-h-screen flex flex-col items-center bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-900 dark:to-gray-800">
      <Header />
      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-20 w-full max-w-4xl p-4">
        {cards.map((card, index) => (
          <motion.div
          key={index}
            initial={{ opacity: 0, y: 50 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ type: "spring", stiffness: 100, damping: 10, delay: index * 0.1 }}
          >
            <Card title={card.title} icon={card.icon} {...(card.route ? { route: card.route } : { url: card.url })} />
          </motion.div>

        ))}
      </div>
    </div>
  );
};

export default AcademicRegister

================
File: frontend/src/pages/student/StudentSemesterListing.jsx
================
import React, { useEffect, useState } from "react";
import Header from "../../components/Header";
import { useMarksStore } from "../../store/useMarksStore";
import { useNavigate } from "react-router-dom";
import { motion } from "framer-motion";

const StudentSemesterListing = () => {
  const { semesters, getSemesters } = useMarksStore();
  const navigate = useNavigate();

  useEffect(() => {
    getSemesters();
  }, [getSemesters]);

  const containerVariants = {
    hidden: { opacity: 0 },
    visible: {
      opacity: 1,
      transition: {
        staggerChildren: 0.15,
        delayChildren: 0.3,
      },
    },
  };

  const cardVariants = {
    hidden: { opacity: 0, y: 50 },
    visible: {
      opacity: 1,
      y: 0,
      transition: { type: "spring", stiffness: 120 },
    },
  };

  return (
    <>
      <Header />
      <div className="min-h-screen bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-900 dark:to-gray-800 p-6 pt-24">
        <motion.div
          className="grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4"
          variants={containerVariants}
          initial="hidden"
          animate="visible"
        >
         
          <motion.h1
                 className="col-span-full text-2xl font-extrabold text-gray-900 dark:text-white mt-6 ml-8 mb-4 font-oswald"
                 style={{ fontFamily: 'Poppins, sans-serif' }}
                 initial={{ opacity: 0, y: 100 }}
                 animate={{ opacity: 1, y: 0, transition: { duration: 1.1 } }}
                 >
                   Thamheediyya
               </motion.h1>

          {semesters.map((semester, index) => (
            <React.Fragment key={semester._id || index}>
              {index === 4 && (
                 <motion.h1
                 className="col-span-full text-2xl font-extrabold text-gray-900 dark:text-white mt-6 ml-8 mb-4 font-oswald"
                 style={{ fontFamily: 'Poppins, sans-serif' }}
                 initial={{ opacity: 0, y: 100 }}
                 animate={{ opacity: 1, y: 0, transition: { duration: 1.1 } }}
                 >
                   Aliya
               </motion.h1>
              
              )}

              <motion.div
                className="col-span-1"
                variants={cardVariants}
                whileHover={{ scale: 1.02 }}
                whileTap={{ scale: 0.97 }}
              >
                <div
                  className="bg-white dark:bg-gray-700 rounded-xl shadow-lg dark:shadow-gray-900 p-6 cursor-pointer transition transform hover:-translate-y-2 hover:shadow-2xl"
                  onClick={() =>
                    navigate(`/dashboard/student/semester/${semester._id}`)
                  }
                >
                  <div className="flex items-center">
                    <div className="w-10 h-10 flex-shrink-0 rounded-full bg-sky-800 dark:bg-sky-600 text-white flex items-center justify-center font-bold text-lg mr-4">
                      {index > 3 ? index - 3 : index + 1}
                    </div>
                    <div className="text-gray-900 dark:text-gray-200 text-lg font-medium font-sans">
                      {semester.name}
                    </div>
                  </div>
                </div>
              </motion.div>
            </React.Fragment>
          ))}
        </motion.div>
      </div>
    </>
  );
};

export default StudentSemesterListing;

================
File: frontend/src/store/useRecordStore.js
================
import { create } from "zustand";
import toast from "react-hot-toast";
import { axiosInstance } from "../lib/axios";

export const useRecordStore = create((set, get) => ({
  records: [],
  isLoading: false,

  fetchRecords: async () => {
    set({ isLoading: true });
    try {
      const res = await axiosInstance.get("/records");
      set({ records: res.data });
    } catch (error) {
      toast.error("Failed to fetch records");
    } finally {
      set({ isLoading: false });
    }
  },

  addRecord: async (recordData) => {
    set({ isLoading: true });
    try {
      
      const res = await axiosInstance.post("/records", recordData);
      set((state) => ({
        records: [res.data, ...state.records],
      }));
      toast.success("Record added successfully");
    } catch (error) {
      toast.error("Failed to add record");
    } finally {
      set({ isLoading: false });
    }
  },

  updateRecord: async (id, updatedData) => {
    set({ isLoading: true });
    try {
      const res = await axiosInstance.put(`/records/${id}`, updatedData);
      set((state) => ({
        records: state.records.map((rec) =>
          rec._id === id ? res.data : rec
        ),
      }));
      toast.success("Record updated");
    } catch (error) {
      toast.error("Failed to update record");
    } finally {
      set({ isLoading: false });
    }
  },

  deleteRecord: async (id) => {
    set({ isLoading: true });
    try {
      await axiosInstance.delete(`/records/${id}`);
      set((state) => ({
        records: state.records.filter((rec) => rec._id !== id),
      }));
      toast.success("Record deleted");
    } catch (error) {
      toast.error("Failed to delete record");
    } finally {
      set({ isLoading: false });
    }
  },
}));

================
File: backend/src/controllers/admissionController.js
================
import asyncHandler from "express-async-handler";
import RegisteredUser from "../models/registeredUser.model.js";
import Student from "../models/student.model.js";
import bcrypt from "bcryptjs";
import Batch from "../models/batch.model.js";

export const newAdmission = asyncHandler(async (req, res) => {
  const { name, cicNumber, phoneNumber, email, whatsupNumber,parentNumber, address, password, batchName,  dateOfBirth, profileImage } = req.body;

  if ( !name || !cicNumber  || !password || !batchName ) {
    return res.status(400).json({ message: "name, cicNumber, batchName, password are required" });
  };

  if (password.length < 4 ) {
    return res.status(400).json({ message: "Password must be at least 4 characters" });
  }

  const salt = await bcrypt.genSalt(10);
  const hashedPassword = await bcrypt.hash(password, salt);

    const batch = await Batch.findOne({ name: batchName});

    if (!batch) {
      return res.status(404).json({ message: "Batch not found" });
    }

    const newAdmission = new Student ({
    name,
    cicNumber,
    phoneNumber, 
    email, 
    whatsupNumber,
    parentNumber, 
    address,
    role: "student",
    password: hashedPassword,
    batchName,
    batchId: batch._id,
    dateOfBirth,
  });

  if(newAdmission){
     await newAdmission.save();

    res.status(201).json({
      success: true,
      message: "New Student added successfully",
      student: newAdmission,
    });
  }
});


export const getRegisteredStudents = asyncHandler(async (req, res) => {

    const registeredStudents = await RegisteredUser.find(); 

    res.status(200).json({ success: true, students: registeredStudents });
});

export const selected = asyncHandler(async (req, res) => {

    const { id, isSelected } = req.body;

  
    const registeredStudent = await RegisteredUser.findByIdAndUpdate(id, { isSelected: isSelected }, { new: true });
    
    if(!isSelected){
      return res.status(201).json({ success: true, message: "Student not selected" });
    }
    if (!registeredStudent) {
  
      return res.status(404).json({ success: false, message: "Student not found" });
    }
  
    const { name, phoneNumber, password, batchName, classId, gender, dateOfBirth, profileImage } = registeredStudent;
  
    // Count students in the same class & gender
    let count = await Student.countDocuments({
      batchName,
      gender
    });
  
    const rollNumber = count + 1;
    const classMap = {};
    const alph = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"; 
    
    const batches = await Batch.find().select("name").sort(); 
    
    batches.forEach((c, i) => {
      classMap[c.name] = alph[i] || ""; 
    });

    const classPrefix = classMap[batchName] || "X"; 
    const genderPrefix = gender === "Male" ? "B" : "G";
    const studentId = `${classPrefix}${genderPrefix}${rollNumber}`;

  
    const newStudent = new Student({
      name,
      phoneNumber,
      password,
      batchName,
      classId,
      gender,
      dateOfBirth,
      profileImage,
      rollNumber,
      studentId
    });
  
    const saveStudent = await newStudent.save();

    const cls = await Batch.findById(classId); 
    if (!cls) {
        throw new Error("Batch not found");
    }

    cls.students.push(saveStudent._id);
    await cls.save();  
  
    res.status(201).json({
      success: true,
      message: "New Student Admitted",
      student: saveStudent,
    });
});

================
File: backend/src/helper/transactionHelper.js
================
const db = require('../config/connection');
const collections = require('../config/collection')
module.exports = {
    borrow: (bookNumber, studentId) => {
        return new Promise(async (resolve, reject) => {
          try {
        
            let book = await db.get().collection(collections.BOOK_COLLECTION).findOne({ bookNumber: bookNumber });
            if (!book) {
              reject('Book not found');
              return;
            }
      
            if (book.status !== 'available') {
              reject('Book not available');
              return;
            }
      
            let student = await db.get().collection(collections.USER_COLLECTION).findOne({ studentId: studentId });
            if (!student) {
              reject('Student not registered');
              return;
            }
            studentName = student.studentName;
            const dueDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000); 
            await db.get().collection(collections.BOOK_COLLECTION).updateOne(
              { bookNumber: bookNumber },
              {
                $set: {
                  status: 'borrowed',
                  borrowedBy: studentId,
                  studentName: studentName,
                  dueDate: dueDate,
                },
              }
            );
      
            book = await db.get().collection(collections.BOOK_COLLECTION).findOne({ bookNumber: bookNumber });
      
            await db.get().collection(collections.TRANSACTION_COLLECTION).insertOne({
              bookId: book._id,
              bookNumber: bookNumber,
              borrowDate: new Date(),
              dueDate: book.dueDate,
              studentId: studentId,
              returned: false 
            });
      
            resolve('Book borrowed successfully');
          } catch (error) {
            reject(`Error borrowing book: ${error.message}`);
          }
        });
      },
      returnBook: (bookNumber) => {
        return new Promise(async (resolve, reject) => {
          bookNumber = parseInt(bookNumber, 10)
            try {
                let book = await db.get().collection(collections.BOOK_COLLECTION).findOne({ bookNumber: bookNumber });
    
                if (!book) {
                    reject('Book not found');
                    return;
                }
                await db.get().collection(collections.BOOK_COLLECTION).updateOne(
                    { bookNumber: bookNumber },
                    {
                        $set: {
                            status: 'available',   
                            borrowedBy: "",     
                            studentName: "",     
                            dueDate: "",    
                        },
                    }
                );
    
                await db.get().collection(collections.TRANSACTION_COLLECTION).updateOne(
                    { bookNumber: bookNumber, returned: false },
                    {
                        $set: {
                            returned: true,
                            returnDate: new Date(), 
                        },
                    }
                );
    
                resolve({success: true, message: 'Book returned successfully'});
            } catch (error) {
                console.error({success: false, message:'Error while returning book:', error});
                reject('Failed to return the book');
            }
        });
    },
    
    borrowedBooks:()=>{
        return new Promise(async(resolve,reject)=>{
            try {
                let borrowedBooks = await db.get().collection(collections.TRANSACTION_COLLECTION).aggregate([
                    {
                        $match:{
                            returned: false
                        }
                    },
                    {
                      $lookup: {
                        from: 'users', 
                        localField: 'studentId',  
                        foreignField: 'studentId',  
                        as: 'userInfo'  
                      }
                    },
                    
                    {
                      $lookup: {
                        from: 'books',  
                        localField: 'bookId',  
                        foreignField: '_id',  
                        as: 'bookInfo'  
                      }
                    },
                  
                    {
                      $unwind: {
                        path: '$userInfo',
                        preserveNullAndEmptyArrays: true 
                      }
                    },
                    {
                      $unwind: {
                        path: '$bookInfo',
                        preserveNullAndEmptyArrays: true 
                      }
                    },
                  
                    
                    {
                      $project: {
                        _id: 1,  
                        studentName: '$userInfo.studentName', 
                        studentId: '$userInfo.studentId', 
                        bookTitle: '$bookInfo.title', 
                        bookNumber: 1,  
                        borrowDate: 1,  
                        dueDate: 1  
                      }
                    }
                  ]).sort({ borrowDate: -1 }).toArray();
                  
                  
                if(borrowedBooks){
                    resolve(borrowedBooks);
                }
            } catch (error) {
                reject()
            }
        })
    }
}

================
File: backend/src/lib/utils.js
================
import jwt from "jsonwebtoken";

export const generateToken = (userId, res) => {
    const token = jwt.sign({ userId }, process.env.JWT_SECRET, { expiresIn: "7d" });

    res.cookie("jwt", token, {
        httpOnly: true,
        secure: process.env.NODE_ENV === "production", 
        sameSite: process.env.NODE_ENV === "production" ? "None" : "Lax", 
        maxAge: 7 * 24 * 60 * 60 * 1000,
      });
      

    return token;
};

================
File: frontend/src/components/AdminReadingStatsCards.jsx
================
const AdminReadingStatsCards = ({ readingProgress }) => {
    const totalBooks = readingProgress.length
    const approvedBooks = readingProgress.filter((p) => p.approval).length
    const pendingBooks = totalBooks - approvedBooks
    const totalPages = readingProgress.reduce((sum, p) => sum + (p.numberOfPages || 0), 0)
    const uniqueStudents = new Set(readingProgress.map((p) => p.studentId?._id || p.studentId)).size
  
    const stats = [
      {
        title: "Total Books",
        value: totalBooks,
        icon: "üìö",
        color: "from-blue-500 to-cyan-500",
        bgColor: "bg-blue-50 dark:bg-blue-900/30",
      },
      {
        title: "Approved",
        value: approvedBooks,
        icon: "‚úÖ",
        color: "from-green-500 to-emerald-500",
        bgColor: "bg-green-50 dark:bg-green-900/30",
      },
      {
        title: "Pending Review",
        value: pendingBooks,
        icon: "‚è≥",
        color: "from-amber-500 to-orange-500",
        bgColor: "bg-amber-50 dark:bg-amber-900/30",
      },
      {
        title: "Total Pages",
        value: totalPages.toLocaleString(),
        icon: "üìñ",
        color: "from-purple-500 to-pink-500",
        bgColor: "bg-purple-50 dark:bg-purple-900/30",
      },
    ]
  
    return (
      <div className="grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-4">
        {stats.map((stat, index) => (
          <div
            key={index}
            className={`${stat.bgColor} rounded-xl p-3 shadow-sm hover:shadow-md transition-all duration-300 border border-white/50 dark:border-gray-700/50`}
          >
            <div className="flex items-center justify-between mb-2">
              <div className="text-2xl">{stat.icon}</div>
              <div
                className={`w-6 h-6 rounded-lg bg-gradient-to-r ${stat.color} flex items-center justify-center shadow-lg`}
              >
                <div className="w-2 h-2 bg-white/30 rounded-sm"></div>
              </div>
            </div>
            <div className="text-lg font-bold mb-1 text-gray-800 dark:text-white">{stat.value}</div>
            <div className="text-xs font-medium text-gray-600 dark:text-gray-300">{stat.title}</div>
          </div>
        ))}
      </div>
    )
  }
  
  export default AdminReadingStatsCards

================
File: frontend/src/components/AdminStatsCards.jsx
================
const AdminStatsCards = ({ achievements }) => {
    const totalAchievements = achievements.length
    const approvedAchievements = achievements.filter((a) => a.approval).length
    const pendingAchievements = totalAchievements - approvedAchievements
    const uniqueStudents = new Set(achievements.map((a) => a.studentId?._id || a.studentId)).size
  
    const stats = [
      {
        title: "Total Achievements",
        value: totalAchievements,
        icon: "üèÜ",
        color: "from-blue-500 to-cyan-500",
        bgColor: "bg-blue-50 dark:bg-blue-900/30",
      },
      {
        title: "Approved",
        value: approvedAchievements,
        icon: "‚úÖ",
        color: "from-green-500 to-emerald-500",
        bgColor: "bg-green-50 dark:bg-green-900/30",
      },
      {
        title: "Pending Review",
        value: pendingAchievements,
        icon: "‚è≥",
        color: "from-amber-500 to-orange-500",
        bgColor: "bg-amber-50 dark:bg-amber-900/30",
      },
      // {
      //   title: "Active Students",
      //   value: uniqueStudents,
      //   icon: "üë•",
      //   color: "from-purple-500 to-pink-500",
      //   bgColor: "bg-purple-50 dark:bg-purple-900/30",
      // },
    ]
  
    return (
      <div className="grid grid-cols-3 md:grid-cols-2 lg:grid-cols-4 gap-4">
        {stats.map((stat, index) => (
          <div
            key={index}
            className={`${stat.bgColor} rounded-xl p-3 shadow-sm hover:shadow-md transition-all duration-300 border border-white/50 dark:border-gray-700/50`}
          >
            <div className="flex items-center justify-between mb-2">
              <div className="text-2xl">{stat.icon}</div>
              <div
                className={`w-6 h-6 rounded-lg bg-gradient-to-r ${stat.color} flex items-center justify-center shadow-lg`}
              >
                <div className="w-2 h-2 bg-white/30 rounded-sm"></div>
              </div>
            </div>
            <div className="text-lg font-bold mb-1 text-gray-800 dark:text-white">{stat.value}</div>
            <div className="text-xs font-medium text-gray-600 dark:text-gray-300">{stat.title}</div>
          </div>
        ))}
      </div>
    )
  }
  
  export default AdminStatsCards

================
File: frontend/src/components/InstallPrompt.jsx
================
import { motion, AnimatePresence } from "framer-motion";

const InstallPrompt = ({ deferredPrompt, onClose }) => {
  const handleInstallClick = () => {
    if (!deferredPrompt) return;

    deferredPrompt.prompt();

    deferredPrompt.userChoice.then(() => {
      onClose();
    });
  };

  return (
    <AnimatePresence>
      <motion.div
        className="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50"
        initial={{ opacity: 0 }}
        animate={{ opacity: 1 }}
        exit={{ opacity: 0 }}
      >
        <motion.div
          className="bg-white p-8 rounded-lg shadow-lg max-w-sm text-center"
          initial={{ scale: 0.8, opacity: 0 }}
          animate={{ scale: 1, opacity: 1, transition: { duration: 0.3, ease: "easeOut" } }}
          exit={{ scale: 0.8, opacity: 0, transition: { duration: 0.2, ease: "easeIn" } }}
        >
          <h2 className="text-xl font-semibold mb-4 text-gray-800">
            Install UIA Academics App
          </h2>
          <p className="mb-6 text-gray-600">
            Install this app on your device for a faster.
          </p>
          <div className="flex justify-center gap-4">
            <button
              onClick={handleInstallClick}
              className="px-5 py-2 bg-sky-600 text-white rounded-md shadow hover:bg-sky-700 transition"
            >
              Install
            </button>
            <button
              onClick={onClose}
              className="px-5 py-2 border border-gray-300 rounded-md hover:bg-gray-100 transition"
            >
              Maybe Later
            </button>
          </div>
        </motion.div>
      </motion.div>
    </AnimatePresence>
  );
};

export default InstallPrompt;

================
File: frontend/src/pages/admin/AdminAchievementsPage.jsx
================
"use client"

import { useState, useEffect } from "react"
import { useAchievement } from "../../store/achivemnetStore"
import AdminStatsCards from "../../components/AdminStatsCards"
import AdminEmptyState from "../../components/AdminEmptyState"
import AchievementDetailsModal from "../../components/AchievementDetailsModal"
import LoadingSpinner from "../../components/LoadingSpinner"
import Header from "../../components/Header"
import { useParams } from "react-router-dom"



const AdminAchievementsPage = () => {
    const {studentId} = useParams()
  const { achievements, isLoading, getStdAchievements, updateAchievement, deleteAchievement } = useAchievement()
  const [selectedAchievement, setSelectedAchievement] = useState(null)
  const [searchTerm, setSearchTerm] = useState("")
  const [filterStatus, setFilterStatus] = useState("all")
  const [filterLevel, setFilterLevel] = useState("all")
  const [sortBy, setSortBy] = useState("newest")
  const [selectedItems, setSelectedItems] = useState([])

  useEffect(() => {
    getStdAchievements(studentId);
  }, [getStdAchievements])

  const handleApprove = async (achievementId) => {
    try {
      await updateAchievement(achievementId, { approval: true })
    } catch (error) {
      console.error("Error approving achievement:", error)
    }
  }

  const handleReject = async (achievementId) => {
    try {
      await updateAchievement(achievementId, { approval: false })
    } catch (error) {
      console.error("Error rejecting achievement:", error)
    }
  }

  const handleDelete = async (achievementId) => {
    if (window.confirm("Are you sure you want to delete this achievement?")) {
      try {
        await deleteAchievement(achievementId)
      } catch (error) {
        console.error("Error deleting achievement:", error)
      }
    }
  }

  const handleBulkApprove = async () => {
    if (selectedItems.length === 0) return
    try {
      await Promise.all(selectedItems.map((id) => updateAchievement(id, { approval: true })))
      setSelectedItems([])
    } catch (error) {
      console.error("Error bulk approving achievements:", error)
    }
  }

  const handleBulkReject = async () => {
    if (selectedItems.length === 0) return
    try {
      await Promise.all(selectedItems.map((id) => updateAchievement(id, { approval: false })))
      setSelectedItems([])
    } catch (error) {
      console.error("Error bulk rejecting achievements:", error)
    }
  }

  const toggleSelectItem = (id) => {
    setSelectedItems((prev) => (prev.includes(id) ? prev.filter((item) => item !== id) : [...prev, id]))
  }

  const toggleSelectAll = () => {
    if (selectedItems.length === filteredAndSortedAchievements.length) {
      setSelectedItems([])
    } else {
      setSelectedItems(filteredAndSortedAchievements.map((achievement) => achievement._id))
    }
  }

  const filteredAndSortedAchievements =
    achievements
      ?.filter((achievement) => {
        const matchesSearch =
          achievement.achievedItem?.toLowerCase().includes(searchTerm.toLowerCase()) ||
          achievement.agencyLevel?.toLowerCase().includes(searchTerm.toLowerCase()) ||
          achievement.studentId?.name?.toLowerCase().includes(searchTerm.toLowerCase())

        const matchesStatus =
          filterStatus === "all" ||
          (filterStatus === "approved" && achievement.approval) ||
          (filterStatus === "pending" && !achievement.approval)

        const matchesLevel = filterLevel === "all" || achievement.agencyLevel === filterLevel

        return matchesSearch && matchesStatus && matchesLevel
      })
      ?.sort((a, b) => {
        switch (sortBy) {
          case "newest":
            return new Date(b.createdAt) - new Date(a.createdAt)
          case "oldest":
            return new Date(a.createdAt) - new Date(b.createdAt)
          case "student":
            return (a.studentId?.name || "").localeCompare(b.studentId?.name || "")
          case "achievement":
            return a.achievedItem.localeCompare(b.achievedItem)
          default:
            return 0
        }
      }) || []

  if (isLoading) {
    return <LoadingSpinner />
  }

  return (
    <div
      className={`min-h-screen transition-colors duration-300 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 `}
    >
        <Header />

      <div className="max-w-7xl mx-auto p-4 md:p-8 mt-10">
        {/* Header Section */}
        <div className="mb-8">
          <div className="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6 mb-6">
            <div>
              <h1 className="text-3xl md:text-5xl font-bold mb-2 bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 dark:from-blue-400 dark:via-purple-400 dark:to-pink-400 bg-clip-text text-transparent">
                Manage Achievements
              </h1>
              <p className="text-sm text-gray-600 dark:text-gray-300">Review and approve student achievements</p>
            </div>
            <div className="flex items-center gap-4">
              {selectedItems.length > 0 && (
                <div className="flex gap-2">
                  <button
                    onClick={handleBulkApprove}
                    className="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors duration-200"
                  >
                    Approve ({selectedItems.length})
                  </button>
                  <button
                    onClick={handleBulkReject}
                    className="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors duration-200"
                  >
                    Reject ({selectedItems.length})
                  </button>
                </div>
              )}
            </div>
          </div>

          {/* Stats Cards */}
          <AdminStatsCards achievements={achievements || []} />
        </div>

        {/* Controls Section */}
        {/* <div className="bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm rounded-2xl p-6 mb-8 shadow-lg border border-white/20 dark:border-gray-700/50">
          <div className="flex flex-col lg:flex-row gap-4 mb-4">
            <div className="flex-1">
              <div className="relative">
                <div className="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                  <svg className="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path
                      strokeLinecap="round"
                      strokeLinejoin="round"
                      strokeWidth={2}
                      d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                    />
                  </svg>
                </div>
                <input
                  type="text"
                  placeholder="Search achievements, students, or levels..."
                  value={searchTerm}
                  onChange={(e) => setSearchTerm(e.target.value)}
                  className="w-full pl-12 pr-4 py-3 bg-white dark:bg-gray-700 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200"
                />
              </div>
            </div>

            <div className="flex gap-4">
              <select
                value={filterStatus}
                onChange={(e) => setFilterStatus(e.target.value)}
                className="px-4 py-3 bg-white dark:bg-gray-700 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base text-gray-900 dark:text-white focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200 min-w-32"
              >
                <option value="all">All Status</option>
                <option value="approved">Approved</option>
                <option value="pending">Pending</option>
              </select>

              <select
                value={filterLevel}
                onChange={(e) => setFilterLevel(e.target.value)}
                className="px-4 py-3 bg-white dark:bg-gray-700 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base text-gray-900 dark:text-white focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200 min-w-32"
              >
                <option value="all">All Levels</option>
                <option value="School">School</option>
                <option value="District">District</option>
                <option value="State">State</option>
                <option value="National">National</option>
                <option value="International">International</option>
              </select>

              <select
                value={sortBy}
                onChange={(e) => setSortBy(e.target.value)}
                className="px-4 py-3 bg-white dark:bg-gray-700 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base text-gray-900 dark:text-white focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200 min-w-32"
              >
                <option value="newest">Newest First</option>
                <option value="oldest">Oldest First</option>
                <option value="student">By Student</option>
                <option value="achievement">By Achievement</option>
              </select>
            </div>
          </div>

          {filteredAndSortedAchievements.length > 0 && (
            <div className="flex items-center gap-2">
              <input
                type="checkbox"
                id="selectAll"
                checked={selectedItems.length === filteredAndSortedAchievements.length}
                onChange={toggleSelectAll}
                className="w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 rounded focus:ring-indigo-500 dark:focus:ring-indigo-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"
              />
              <label htmlFor="selectAll" className="text-sm font-medium text-gray-700 dark:text-gray-300">
                Select All ({filteredAndSortedAchievements.length} items)
              </label>
            </div>
          )}
        </div> */}

        {/* Achievements Table */}
        <div className="bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/50 dark:border-gray-700/50 overflow-hidden">
          {filteredAndSortedAchievements.length === 0 ? (
            <AdminEmptyState searchTerm={searchTerm} hasAchievements={achievements?.length > 0} />
          ) : (
            <div className="overflow-x-auto">
              <table className="w-full">
                
              <thead className="bg-gray-50 dark:bg-gray-700/50">
                  <tr>
                    <th className="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                      Achievement
                    </th>
                    <th className="hidden md:table-cell px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                      Level
                    </th>
                    <th className="hidden md:table-cell px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                      Rank
                    </th>
                    <th className="hidden md:table-cell px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                      Status
                    </th>
                    <th className="hidden md:table-cell px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                      Date
                    </th>
                    <th className="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                      Actions
                    </th>
                  </tr>
                </thead>

                <tbody className="divide-y divide-gray-200 dark:divide-gray-700">
                {filteredAndSortedAchievements.map((achievement) => (
                  <tr key={achievement._id} className="hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors duration-200">
                    <td className="px-6 py-4">
                      <div className="text-sm font-medium text-gray-900 dark:text-white max-w-xs truncate">
                        {achievement.achievedItem}
                      </div>
                      {achievement.gradeOrPercentage && (
                        <div className="text-sm text-gray-500 dark:text-gray-400">
                          Grade: {achievement.gradeOrPercentage}
                        </div>
                      )}
                    </td>
                    <td className="hidden md:table-cell px-6 py-4 whitespace-nowrap">
                      {achievement.agencyLevel && (
                        <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300">
                          {achievement.agencyLevel}
                        </span>
                      )}
                    </td>
                    <td className="hidden md:table-cell px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white">
                      {achievement.placeOrRank || "-"}
                    </td>
                    <td className="hidden md:table-cell px-6 py-4 whitespace-nowrap">
                      {achievement.approval ? (
                        <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300">
                          ‚úì Approved
                        </span>
                      ) : (
                        <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300">
                          ‚è≥ Pending
                        </span>
                      )}
                    </td>
                    <td className="hidden md:table-cell px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">
                      {achievement.monthAndYear || new Date(achievement.createdAt).toLocaleDateString()}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm font-medium">
                      <div className="flex items-center gap-2">
                        <button
                          onClick={() => setSelectedAchievement(achievement)}
                          className="text-indigo-600 dark:text-indigo-400 hover:text-indigo-900 dark:hover:text-indigo-300 transition-colors duration-200"
                        >
                          View
                        </button>
                        {!achievement.approval ? (
                          <button
                            onClick={() => handleApprove(achievement._id)}
                            className="text-green-600 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300 transition-colors duration-200"
                          >
                            Approve
                          </button>
                        ) : (
                          <button
                            onClick={() => handleReject(achievement._id)}
                            className="text-yellow-600 dark:text-yellow-400 hover:text-yellow-900 dark:hover:text-yellow-300 transition-colors duration-200"
                          >
                            Revoke
                          </button>
                        )}
                        <button
                          onClick={() => handleDelete(achievement._id)}
                          className="text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300 transition-colors duration-200"
                        >
                          Delete
                        </button>
                      </div>
                    </td>
                  </tr>
                ))}
              </tbody>

              </table>
            </div>
          )}
        </div>

        {/* Achievement Details Modal */}
        {selectedAchievement && (
          <AchievementDetailsModal
            achievement={selectedAchievement}
            onClose={() => setSelectedAchievement(null)}
            onApprove={handleApprove}
            onReject={handleReject}
            onDelete={handleDelete}
          />
        )}
      </div>
    </div>
  )
}

export default AdminAchievementsPage

================
File: frontend/src/pages/admin/AdminBatches.jsx
================
import React, { useEffect, useState } from "react";
import Header from "../../components/Header";
import { useMarksStore } from "../../store/useMarksStore";
import { useNavigate, useParams } from "react-router-dom";
import { useAdminStore } from "../../store/useAdminMngStore";
import { useAchievement } from "../../store/achivemnetStore";
import { useReadingProgress } from "../../store/readingProgressStore";

const AdminBatches = () => {
  const { item } = useParams();
  const navigate = useNavigate();

  const { batches, getBatches } = useAdminStore();
  const { markListCountToApprove, marksCountToApproveByBatch } = useMarksStore();
  const { achievementsCountToApprove, achieveCountToApproveByBatch } = useAchievement();
  const { progressCountToApprove, progressCountToApproveByBatch } = useReadingProgress();

  const [countToApprove, setCountToApprove] = useState([]);

  useEffect(() => {
    getBatches();
  }, [getBatches]);

  useEffect(() => {
    if (item === "marklist") {
      marksCountToApproveByBatch();
    } else if (item === "achievements") {
      achieveCountToApproveByBatch();
    } else if (item === "reading-progress") {
      progressCountToApproveByBatch();
    } else {
      console.warn("Unknown item:", item);
    }
  }, [item, marksCountToApproveByBatch, achieveCountToApproveByBatch, progressCountToApproveByBatch]);

  // 3. Whenever the fetched arrays update, mirror them into local state
  useEffect(() => {
    let arr = [];
    if (item === "marklist") {
      arr = markListCountToApprove;
    } else if (item === "achievements") {
      arr = achievementsCountToApprove;
    } else if (item === "reading-progress") {
      arr = progressCountToApprove;
    }
    setCountToApprove([...arr]); // spread to ensure new reference
  }, [item, markListCountToApprove, achievementsCountToApprove, progressCountToApprove]);

  return (
    <>
      <Header />
      <div className="min-h-screen bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-900 dark:to-gray-800 p-6 pt-24">
        <div className="grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4">
          <h2 className="col-span-full text-2xl font-extrabold text-gray-900 dark:text-white mb-4 ml-8 font-oswald">
            Batches
          </h2>

          {batches.map((batch, index) => {
            const badge = countToApprove.find((b) => String(b._id) === String(batch._id));
            return (
              <div
                key={batch._id || index}
                className="relative block"
                onClick={() => navigate(`/dashboard/admin/batches/${item}/${batch._id}`)}
              >
                <div className="bg-white dark:bg-gray-700 rounded-xl shadow-lg dark:shadow-gray-900 p-3 transform transition duration-300 hover:-translate-y-2 hover:shadow-2xl cursor-pointer relative">
                  {badge?.count > 0 && (
                    <div className="absolute top-2 right-2 w-5 h-5 flex items-center justify-center rounded-full bg-red-600 text-white text-xs font-bold">
                      {badge.count}
                    </div>
                  )}

                  <div className="flex items-center">
                    <div className="w-10 h-10 flex-shrink-0 rounded-full bg-sky-800 dark:bg-sky-600 text-white flex items-center justify-center font-bold text-lg mr-4">
                      {index + 1}
                    </div>
                    <div className="text-gray-900 dark:text-gray-200 text-lg font-medium font-sans">
                      {batch.name}
                    </div>
                  </div>
                </div>
              </div>
            );
          })}
        </div>
      </div>
    </>
  );
};

export default AdminBatches;

================
File: frontend/src/pages/admin/AdminsideMarkListes .jsx
================
import React, { useEffect, useState } from "react";
import { useParams } from "react-router-dom";
import { useMarksStore } from "../../store/useMarksStore";
import { useAuthStore } from "../../store/useAuthStore";
import { axiosInstance } from "../../lib/axios";
import { Loader2, Save, CheckCircle, Lock, Unlock, AlertCircle, Plus, Trash2 } from "lucide-react";
import toast from "react-hot-toast";
import { motion } from "framer-motion";

const AdminsideMarkListes = () => {
  const { studentId } = useParams();
  const { semesters, getSemesters, markList, addMarkList, getMarkList } = useMarksStore();
  const [marksData, setMarksData] = useState({});
  const [saving, setSaving] = useState({});
  const [originalData, setOriginalData] = useState({});

  useEffect(() => {
    getSemesters();
    getMarkList(studentId);
  }, []);

  useEffect(() => {
    const allMarks = {};
    for (const sem of semesters) {
      const ml = markList.find((m) => m.semesterId === sem._id) || { subjects: [], isApproved: false };
      allMarks[sem._id] = { ...ml, subjects: ml.subjects.map(s => ({ ...s })) };
    }
    setMarksData(allMarks);
    setOriginalData(JSON.parse(JSON.stringify(allMarks)));
  }, [semesters, markList]);

  // --- Logic Helpers ---
  const isPass = (mark, total, semName) => {
    const threshold = semName?.includes("AL") ? 0.45 : 0.40;
    return mark >= total * threshold;
  };

  const getSemesterSummary = (subjects, semName) => {
    const totalMarks = subjects.reduce((acc, s) => acc + (parseFloat(s.mark) || 0), 0);
    const totalMax = subjects.reduce((acc, s) => acc + (parseFloat(s.total) || 0), 0);
    const percentage = totalMax ? ((totalMarks / totalMax) * 100).toFixed(2) : "0.00";
    const allPassed = subjects.every(s => isPass(s.mark, s.total, semName));
    return { totalMarks, totalMax, percentage, allPassed };
  };

  const handleInputChange = (semId, idx, field, val) => {
    setMarksData((prev) => {
      const next = { ...prev };
      const sub = next[semId].subjects[idx];
      sub[field] = field === "subject" ? val : parseFloat(val) || 0;
      return { ...next };
    });
  };

  const handleSave = async (semId) => {
    setSaving(s => ({ ...s, [semId]: true }));
    try {
      await addMarkList(studentId, semId, marksData[semId].subjects);
      setOriginalData(prev => ({ ...prev, [semId]: JSON.parse(JSON.stringify(marksData[semId])) }));
      toast.success("Marks saved successfully");
    } catch {
      toast.error("Failed to save");
    } finally {
      setSaving(s => ({ ...s, [semId]: false }));
    }
  };

  const handleApprove = async (mlId, semId) => {
    if (!mlId) return toast.error("Please save marks first");
    try {
      await axiosInstance.patch(`/marklist/${mlId}/status`, { status: true });
      setMarksData(prev => ({ ...prev, [semId]: { ...prev[semId], isApproved: true } }));
      toast.success("Approved successfully");
    } catch {
      toast.error("Approval failed");
    }
  };

  // --- UI Components ---
  
  return (
    <div className="pt-6 pb-20 max-w-5xl mx-auto space-y-8">
      <div className="flex items-center justify-between">
        <h1 className="text-3xl font-display font-bold text-slate-800 dark:text-white">
          Manage Results
        </h1>
        <div className="px-4 py-2 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-300 rounded-lg text-sm font-medium">
          Student ID: {studentId}
        </div>
      </div>

      {semesters.map((sem) => {
        const data = marksData[sem._id];
        const isDirty = JSON.stringify(data) !== JSON.stringify(originalData[sem._id]);
        const summary = data?.subjects ? getSemesterSummary(data.subjects, sem.name) : { totalMarks: 0 };

        return (
          <motion.div 
            key={sem._id}
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            className="bg-white dark:bg-slate-800 rounded-3xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden"
          >
            {/* Header Toolbar */}
            <div className="px-6 py-4 border-b border-slate-200 dark:border-slate-700 flex flex-col sm:flex-row justify-between items-center gap-4 bg-slate-50/50 dark:bg-slate-900/50">
              <h2 className="text-lg font-bold text-slate-800 dark:text-white flex items-center gap-2">
                {sem.name}
                {data?.isApproved && (
                  <span className="px-2 py-0.5 rounded-full bg-emerald-100 text-emerald-700 text-xs font-bold uppercase tracking-wider flex items-center gap-1">
                    <CheckCircle size={12} /> Approved
                  </span>
                )}
              </h2>

              <div className="flex items-center gap-3">
                <button
                  onClick={() => handleSave(sem._id)}
                  disabled={!isDirty || saving[sem._id]}
                  className={`flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-medium transition-all
                    ${isDirty 
                      ? "bg-primary-600 text-white shadow-lg shadow-primary-500/30 hover:bg-primary-700" 
                      : "bg-slate-200 text-slate-400 cursor-not-allowed dark:bg-slate-700"}`}
                >
                  {saving[sem._id] ? <Loader2 className="animate-spin" size={16} /> : <Save size={16} />}
                  Save Changes
                </button>

                {!data?.isApproved && data?._id && (
                  <button
                    onClick={() => handleApprove(data._id, sem._id)}
                    className="flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl text-sm font-medium shadow-lg shadow-emerald-500/20 transition-all"
                  >
                    <CheckCircle size={16} /> Approve
                  </button>
                )}
              </div>
            </div>

            {/* Data Grid */}
            <div className="overflow-x-auto">
              <table className="w-full text-left text-sm">
                <thead>
                  <tr className="border-b border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-400 font-medium">
                    <th className="px-6 py-3 w-12 text-center">#</th>
                    <th className="px-6 py-3 w-1/2">Subject</th>
                    <th className="px-6 py-3 w-32 text-center">Mark Scored</th>
                    <th className="px-6 py-3 w-32 text-center">Max Mark</th>
                    <th className="px-6 py-3 w-24 text-center">Result</th>
                    <th className="px-6 py-3 w-16"></th>
                  </tr>
                </thead>
                <tbody className="divide-y divide-slate-100 dark:divide-slate-700/50">
                  {data?.subjects?.map((sub, idx) => {
                    const passed = isPass(sub.mark, sub.total, sem.name);
                    return (
                      <tr key={idx} className="group hover:bg-slate-50 dark:hover:bg-slate-700/20 transition-colors">
                        <td className="px-6 py-3 text-center text-slate-400 font-mono">{idx + 1}</td>
                        <td className="px-6 py-3">
                          <input
                            type="text"
                            value={sub.subject}
                            onChange={(e) => handleInputChange(sem._id, idx, "subject", e.target.value)}
                            className="w-full bg-transparent border-none outline-none font-medium text-slate-700 dark:text-slate-200 placeholder:text-slate-300 focus:ring-0"
                            placeholder="Subject Name"
                          />
                        </td>
                        <td className="px-6 py-3 text-center">
                          <input
                            type="number"
                            value={sub.mark}
                            onChange={(e) => handleInputChange(sem._id, idx, "mark", e.target.value)}
                            className={`w-20 text-center bg-slate-100 dark:bg-slate-900 border-none rounded-lg py-1.5 font-bold focus:ring-2 focus:ring-primary-500 transition-all ${
                              sub.mark > sub.total ? "text-rose-500 ring-2 ring-rose-500/20" : "text-slate-800 dark:text-white"
                            }`}
                          />
                        </td>
                        <td className="px-6 py-3 text-center">
                          <input
                            type="number"
                            value={sub.total}
                            onChange={(e) => handleInputChange(sem._id, idx, "total", e.target.value)}
                            className="w-20 text-center bg-transparent border-b border-slate-200 dark:border-slate-600 py-1 text-slate-500 focus:border-primary-500 focus:outline-none"
                          />
                        </td>
                        <td className="px-6 py-3 text-center">
                          <span className={`inline-block px-2 py-1 rounded text-xs font-bold ${
                            passed ? "bg-emerald-100 text-emerald-700" : "bg-rose-100 text-rose-700"
                          }`}>
                            {passed ? "PASS" : "FAIL"}
                          </span>
                        </td>
                        <td className="px-6 py-3 text-center">
                          <button 
                            onClick={() => {
                              const newSubjects = [...data.subjects];
                              newSubjects.splice(idx, 1);
                              setMarksData(prev => ({ ...prev, [sem._id]: { ...prev[sem._id], subjects: newSubjects } }));
                            }}
                            className="p-2 text-slate-300 hover:text-rose-500 transition-colors opacity-0 group-hover:opacity-100"
                          >
                            <Trash2 size={16} />
                          </button>
                        </td>
                      </tr>
                    );
                  })}
                  
                  {/* Add Row Button */}
                  <tr>
                    <td colSpan="6" className="px-6 py-3">
                      <button
                        onClick={() => {
                          const newSubjects = [...(data?.subjects || []), { subject: "", mark: 0, total: 100 }];
                          setMarksData(prev => ({ ...prev, [sem._id]: { ...prev[sem._id], subjects: newSubjects } }));
                        }}
                        className="flex items-center gap-2 text-sm text-primary-600 hover:text-primary-700 font-medium"
                      >
                        <Plus size={16} /> Add Subject
                      </button>
                    </td>
                  </tr>
                </tbody>
                
                {/* Summary Footer */}
                <tfoot className="bg-slate-50 dark:bg-slate-800 border-t-2 border-slate-200 dark:border-slate-700">
                  <tr>
                    <td colSpan="2" className="px-6 py-4 font-bold text-right text-slate-600 dark:text-slate-300">
                      SEMESTER TOTALS:
                    </td>
                    <td className="px-6 py-4 text-center font-bold text-lg text-slate-800 dark:text-white">
                      {summary.totalMarks}
                    </td>
                    <td className="px-6 py-4 text-center text-slate-500">
                      / {summary.totalMax}
                    </td>
                    <td className="px-6 py-4 text-center">
                      <div className={`text-sm font-bold ${summary.allPassed ? "text-emerald-600" : "text-rose-600"}`}>
                        {summary.percentage}%
                      </div>
                    </td>
                    <td></td>
                  </tr>
                </tfoot>
              </table>
            </div>
          </motion.div>
        );
      })}
    </div>
  );
};

export default AdminsideMarkListes;

================
File: frontend/src/pages/admin/SignupPage.jsx
================
import { useEffect, useState } from "react";
import { useParams } from "react-router-dom";
import toast from "react-hot-toast";
import { 
  User, Phone, Lock, Save, Loader2, Shield 
} from "lucide-react";
import Header from "../../components/Header";
import InputField from "../../components/InputField";
import SelectField from "../../components/SelectField";
import { useAuthStore } from "../../store/useAuthStore";
import { useStaffStore } from "../../store/useStaffStore";

const SignupPage = () => {
  const { teacherId } = useParams();
  const { signup, isSigningUp } = useAuthStore();
  const { teacher, getTeacher, updateTeacher } = useStaffStore();

  const [formData, setFormData] = useState({
    name: "",
    userName: "",
    phoneNumber: "",
    password: "",
    role: "",
    profileImage: null,
  });

  useEffect(() => {
    if (teacherId) {
      getTeacher(teacherId);
    }
  }, [teacherId]);

  useEffect(() => {
    if (teacher) {
      setFormData((prev) => ({
        ...prev,
        name: teacher.name || "",
        userName: teacher.userName || "",
        phoneNumber: teacher.phoneNumber || "",
        role: teacher.role || "",
      }));
    }
  }, [teacher]);

  const validateForm = () => {
    if (!formData.name) return toast.error("Name is required");
    if (!formData.userName) return toast.error("Username is required");
    if (!formData.phoneNumber) return toast.error("Phone number is required");
    if (!teacherId && !formData.password) return toast.error("Password is required");
    if (!formData.role) return toast.error("Role is required");
    return true;
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    if (!validateForm()) return;

    if (teacherId) {
      await updateTeacher(teacherId, formData);
    } else {
      await signup(formData);
    }
  };

  const handleInputChange = (field, value) => {
    setFormData(prev => ({ ...prev, [field]: value }));
  };

  return (
    <div className="min-h-screen bg-slate-50 dark:bg-surface-dark pb-20">
      <Header page={teacherId ? "Edit Staff" : "Add Staff"} />
      
      <div className="max-w-2xl mx-auto px-4 mt-16">
        
        <div className="text-center mb-10">
          <div className="inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 mb-4 shadow-sm">
            <Shield size={32} />
          </div>
          <h1 className="text-3xl font-display font-bold text-slate-900 dark:text-white">
            {teacherId ? "Update Staff Profile" : "Register New Staff"}
          </h1>
          <p className="text-slate-500 dark:text-slate-400 mt-2">
            Create or modify access for teachers and administrators.
          </p>
        </div>

        <div className="bg-white dark:bg-slate-800 rounded-3xl shadow-xl border border-slate-200 dark:border-slate-700 p-8">
          <form onSubmit={handleSubmit} className="space-y-6">
            
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div className="md:col-span-2">
                <InputField
                  label="Full Name"
                  name="name"
                  value={formData.name}
                  icon={<User size={18} />}
                  onChange={(val) => handleInputChange("name", val)}
                />
              </div>
              
              <InputField
                label="Username"
                name="userName"
                value={formData.userName}
                icon={<User size={18} />}
                onChange={(val) => handleInputChange("userName", val)}
              />
              
              <InputField
                label="Phone Number"
                name="phoneNumber"
                type="tel"
                value={formData.phoneNumber}
                icon={<Phone size={18} />}
                onChange={(val) => handleInputChange("phoneNumber", val)}
              />
              
              <SelectField
                label="Role Access"
                name="role"
                value={formData.role}
                onChange={(val) => handleInputChange("role", val)}
                options={["teacher", "admin"]}
              />

              {!teacherId && (
                <InputField
                  label="Password"
                  name="password"
                  type="password"
                  value={formData.password}
                  onChange={(val) => handleInputChange("password", val)}
                />
              )}
            </div>

            <button
              type="submit"
              disabled={isSigningUp}
              className="w-full py-4 mt-4 bg-gradient-to-r from-indigo-600 to-primary-600 hover:from-indigo-700 hover:to-primary-700 text-white font-bold rounded-xl shadow-lg shadow-indigo-500/30 transform hover:-translate-y-0.5 transition-all flex items-center justify-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed"
            >
              {isSigningUp ? <Loader2 className="animate-spin" /> : <Save size={20} />}
              {teacherId ? "Update Staff Details" : "Create Account"}
            </button>

          </form>
        </div>
      </div>
    </div>
  );
};

export default SignupPage;

================
File: frontend/src/pages/LoginPage.jsx
================
import { useState } from "react";
import { useAuthStore } from "../store/useAuthStore";
import { motion } from "framer-motion";
import { User, Lock, GraduationCap, School, Loader2, ArrowRight } from "lucide-react";
import toast from "react-hot-toast";

const LoginPage = () => {
  const { login, isLoggingIn } = useAuthStore();
  
  // State
  const [role, setRole] = useState("student");
  const [formData, setFormData] = useState({
    username: "",
    password: "",
  });

  const handleChange = (e) => {
    setFormData({ ...formData, [e.target.name]: e.target.value });
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    if (!formData.username || !formData.password) {
      return toast.error("Please fill in all fields");
    }
    login({ ...formData, role });
  };

  return (
    // FIXED: Added 'relative w-full' and 'overflow-hidden' to prevent horizontal scroll
    <div className="min-h-screen w-full relative flex items-center justify-center bg-slate-50 dark:bg-surface-dark overflow-hidden p-4">
      
      {/* Background Blobs - Positioned relative to the viewport container */}
      <div className="absolute top-[-10%] right-[-10%] w-[300px] md:w-[600px] h-[300px] md:h-[600px] bg-primary-500/20 rounded-full blur-[80px] md:blur-[120px] animate-float pointer-events-none" />
      <div className="absolute bottom-[-10%] left-[-10%] w-[300px] md:w-[600px] h-[300px] md:h-[600px] bg-indigo-500/20 rounded-full blur-[80px] md:blur-[120px] animate-float pointer-events-none" />

      {/* Main Card Container */}
      <div className="w-full max-w-6xl grid grid-cols-1 md:grid-cols-2 bg-white/70 dark:bg-surface-glassDark backdrop-blur-2xl rounded-3xl shadow-2xl overflow-hidden border border-white/20 dark:border-slate-700/50 min-h-[500px] md:min-h-[600px] relative z-10">
        
        {/* Left Side: Visuals (Hidden on mobile) */}
        <div className="hidden md:flex flex-col justify-between p-12 bg-gradient-to-br from-primary-600 to-indigo-700 text-white relative overflow-hidden">
          <div className="relative z-10">
            <div className="w-12 h-12 bg-white/20 backdrop-blur-md rounded-xl flex items-center justify-center mb-6">
              <GraduationCap size={32} className="text-white" />
            </div>
            <h1 className="text-4xl font-display font-bold mb-4 leading-tight">
              Welcome to <br/> UIA Academics
            </h1>
            <p className="text-primary-100 text-lg max-w-sm">
              Manage your academic journey with precision. Track results, attendance, and achievements in one place.
            </p>
          </div>

          {/* Abstract geometric shapes */}
          <div className="absolute right-0 bottom-0 opacity-10 transform translate-x-1/4 translate-y-1/4 pointer-events-none">
            <School size={400} />
          </div>
          
          <div className="relative z-10 text-sm text-primary-200">
            ¬© 2025 Wafy CIC. All rights reserved.
          </div>
        </div>

        {/* Right Side: Form */}
        {/* FIXED: Reduced padding on mobile (p-6) to prevent squishing */}
        <div className="p-6 sm:p-12 flex flex-col justify-center w-full">
          <motion.div 
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.5 }}
            className="w-full"
          >
            <h2 className="text-2xl sm:text-3xl font-bold text-slate-800 dark:text-white mb-2">Sign In</h2>
            <p className="text-slate-500 dark:text-slate-400 mb-8 text-sm sm:text-base">Enter your credentials to access the portal.</p>

            <form onSubmit={handleSubmit} className="space-y-5">
              
              {/* Role Selection */}
              <div className="grid grid-cols-3 gap-2 p-1 bg-slate-100 dark:bg-slate-800 rounded-xl">
                {['student', 'teacher', 'admin'].map((r) => (
                  <button
                    key={r}
                    type="button"
                    onClick={() => setRole(r)}
                    className={`py-2 px-1 sm:px-4 rounded-lg text-xs sm:text-sm font-medium transition-all duration-300 capitalize truncate
                      ${role === r 
                        ? 'bg-white dark:bg-slate-700 text-primary-600 shadow-sm' 
                        : 'text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200'
                      }`}
                  >
                    {r}
                  </button>
                ))}
              </div>

              {/* Username Input */}
              <div className="space-y-1">
                <label className="text-sm font-medium text-slate-700 dark:text-slate-300 ml-1">Username / CIC No</label>
                <div className="relative group">
                  <User className="absolute left-4 top-3.5 text-slate-400 group-focus-within:text-primary-500 transition-colors" size={20} />
                  <input
                    type="text"
                    name="username"
                    value={formData.username}
                    onChange={handleChange}
                    placeholder={role === 'student' ? "Enter CIC Number" : "Enter Username"}
                    className="w-full pl-12 pr-4 py-3 bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-xl outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition-all text-slate-800 dark:text-white text-sm sm:text-base"
                  />
                </div>
              </div>

              {/* Password Input */}
              <div className="space-y-1">
                <label className="text-sm font-medium text-slate-700 dark:text-slate-300 ml-1">Password</label>
                <div className="relative group">
                  <Lock className="absolute left-4 top-3.5 text-slate-400 group-focus-within:text-primary-500 transition-colors" size={20} />
                  <input
                    type="password"
                    name="password"
                    value={formData.password}
                    onChange={handleChange}
                    placeholder="Enter Password"
                    className="w-full pl-12 pr-4 py-3 bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-xl outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition-all text-slate-800 dark:text-white text-sm sm:text-base"
                  />
                </div>
              </div>

              {/* Submit Button */}
              <button
                type="submit"
                disabled={isLoggingIn}
                className="w-full py-4 bg-gradient-to-r from-primary-600 to-indigo-600 hover:from-primary-700 hover:to-indigo-700 text-white font-bold rounded-xl shadow-lg shadow-primary-500/30 transform hover:scale-[1.02] active:scale-[0.98] transition-all duration-200 flex items-center justify-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed"
              >
                {isLoggingIn ? <Loader2 className="animate-spin" /> : <>Sign In <ArrowRight size={20} /></>}
              </button>

            </form>
          </motion.div>
        </div>
      </div>
    </div>
  );
};

export default LoginPage;

================
File: backend/src/controllers/achivementsController.js
================
import Achievement from "../models/achivement.model.js";
import Student from "../models/student.model.js";
import mongoose from "mongoose";



export const getStdAchivement = async (req, res) => {
    try {
      const { studentId } = req.params;
      const achievements = await Achievement.find({ studentId });
      res.json(achievements);
    } catch (error) {
      console.error("Error fetching achievements:", error.message);
      res.status(500).json({ message: "Failed to get achievements" });
    }
  };
  export const postStdAchivement = async (req, res) => {
    try {
      const { studentId } = req.params;
      const student = await Student.findById(studentId);
      const newAchievement = new Achievement({
        ...req.body,
        studentId,
        batchId: student.batchId
      });
      const saved = await newAchievement.save();
      res.status(201).json(saved);
    } catch (error) {
      console.error("Error saving achievement:", error.message);
      res.status(400).json({ message: "Failed to add achievement" });
    }
  };
  
  export const editStdAchivement = async (req, res) => {
    try {
      const { achivemnetId } = req.params;
      const updated = await Achievement.findByIdAndUpdate(
        achivemnetId,
        req.body,
        { new: true }
      );
      res.json(updated);
    } catch (error) {
      console.error("Error updating achievement:", error.message);
      res.status(400).json({ message: "Failed to update achievement" });
    }
  };
  export const deleteStdAchivement = async (req, res) => {
    try {
      const { achivemnetId } = req.params;
      const deleted = await Achievement.findByIdAndDelete(achivemnetId);
  
      if (!deleted) {
        return res.status(404).json({ message: "Achievement not found" });
      }
  
      res.json({ message: "Achievement deleted successfully", deleted });
    } catch (error) {
      console.error("Error deleting achievement:", error.message);
      res.status(500).json({ message: "Failed to delete achievement" });
    }
  };


export const getCountToApproveByStd = async (req, res) => {
  try {
    const { batchId } = req.params;
    if (!batchId) {
      return res.status(400).json({ message: "batchId is required" });
    }

    const batchObjId = new mongoose.Types.ObjectId(batchId);

    const counts = await Achievement.aggregate([
      { $match: { approval: false, batchId: batchObjId } },
      { $group:  { _id: "$studentId", count: { $sum: 1 } } }
    ]);

    return res.status(200).json(counts);
  } catch (error) {
    console.error("Error fetching count to approve:", error);
    return res.status(500).json({ message: "Internal Server Error" });
  }
};

export const getCountToApproveByBatch = async (req, res) => {
      try {
          const counts = await Achievement.aggregate([
              { $match: { approval: false } },
              { $group: { _id: "$batchId", count: { $sum: 1 } } } 
          ]);
          
          res.status(200).json(counts);
      } catch (error) {
          console.error("Error fetching count to approve:", error);
          res.status(500).json({ message: "Internal Server Error" });
      }
  };

================
File: backend/src/models/student.model.js
================
import mongoose from "mongoose";

const UserSchema = new mongoose.Schema(
  {
  name: {
    type: String,
    required: true,
    trim: true,
  },
  batchName: {
    type: String,
    required: true,
    trim: true,
  },
  batchId: {
    type: mongoose.Schema.Types.ObjectId,
    required: true,
    ref: "Batch"
  },
  cicNumber: {
    type: Number,
    required: true,
    trim: true,
  },
  phoneNumber: {
    type: Number,
    trim: true,
  },
  whatsupNumber: {
    type: Number,
    trim: true,
  },
  parentNumber: {
    type: Number,
    trim: true,
  },
  dateOfBirth: {
    type: Date,
  },
  email: {
    type: String,
    trim: true,
},
  address: {
    type: String,
    trim: true,
  },
  password: {
    type: String,
    required: true,
  },
  profileImage: {
    type: String,
    default: '',
  },
  role: {
    type: String,
    default:"student"
  },
  
isActive: {
  type: Boolean,
  default: true
}
},
{ timestamps: true }
);

export default mongoose.model("Student", UserSchema);

================
File: backend/src/routes/achivement.route.js
================
import express from "express";
import { deleteStdAchivement, editStdAchivement, getCountToApproveByBatch, getCountToApproveByStd, getStdAchivement, postStdAchivement } from "../controllers/achivementsController.js";

const router = express.Router();


router.get("/count", getCountToApproveByBatch)

router.get("/count/:batchId", getCountToApproveByStd)

router.get("/:studentId", getStdAchivement);

router.post("/:studentId", postStdAchivement);

router.put("/:achivemnetId", editStdAchivement);

router.delete("/:achivemnetId", deleteStdAchivement)

export default router;

================
File: backend/src/routes/readingProgress.route.js
================
import express from "express";
import { deleteStdReadingProgress, editStdReadingProgress, getCountToApproveByBatch, getCountToApproveByStd, getStdReadingProgress, postStdReadingProgress } from "../controllers/readingProgressController.js";

const router = express.Router();

router.get("/count", getCountToApproveByBatch)

router.get("/count/:batchId", getCountToApproveByStd)

router.get("/:studentId", getStdReadingProgress);

router.post("/:studentId", postStdReadingProgress);

router.put("/:recordId", editStdReadingProgress);

router.delete("/:recordId", deleteStdReadingProgress)


export default router;

================
File: frontend/src/components/Card.jsx
================
import { Link } from "react-router-dom";
import { motion } from "framer-motion";
import { ArrowUpRight } from "lucide-react";

const Card = ({ title, icon: Icon, route, url, color = "blue" }) => {
  
  // Dynamic color mapping for richer visuals
  const colorMap = {
    blue: "from-blue-500 to-indigo-600 shadow-blue-500/20",
    green: "from-emerald-500 to-teal-600 shadow-emerald-500/20",
    amber: "from-amber-500 to-orange-600 shadow-amber-500/20",
    red: "from-rose-500 to-red-600 shadow-rose-500/20",
  };

  const gradientClass = colorMap[color] || colorMap.blue;

  const CardContent = () => (
    <motion.div
      whileHover={{ y: -5, scale: 1.02 }}
      whileTap={{ scale: 0.98 }}
      className="relative group overflow-hidden bg-white/60 dark:bg-slate-800/60 backdrop-blur-md 
      border border-white/40 dark:border-slate-700/60 rounded-3xl p-6 h-full
      shadow-lg hover:shadow-2xl transition-all duration-300"
    >
      {/* Background decoration */}
      <div className={`absolute top-0 right-0 w-32 h-32 bg-gradient-to-br ${gradientClass} opacity-5 rounded-bl-full transition-opacity group-hover:opacity-10`} />

      <div className="relative z-10 flex flex-col h-full justify-between">
        <div className="flex justify-between items-start">
          <div className={`p-3.5 rounded-2xl bg-gradient-to-br ${gradientClass} text-white shadow-lg`}>
            <Icon size={28} strokeWidth={1.5} />
          </div>
          
          <div className="bg-slate-100 dark:bg-slate-700/50 p-2 rounded-full opacity-0 group-hover:opacity-100 transition-opacity transform translate-x-2 group-hover:translate-x-0">
            <ArrowUpRight size={18} className="text-slate-500 dark:text-slate-300" />
          </div>
        </div>

        <div className="mt-6">
          <h2 className="text-xl font-bold text-slate-800 dark:text-slate-100 tracking-tight group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors">
            {title}
          </h2>
         {/* {props?.description && <p className="text-xs text-slate-500 dark:text-slate-400 mt-2 line-clamp-2">{props.description}</p>} */}
  
         {/* {!props.description && <p className="text-sm text-slate-500 dark:text-slate-400 mt-1 font-medium">Tap to view details</p>} */}
        </div>
      </div>
    </motion.div>
  );

  if (route) return <Link to={route} className="block h-full"><CardContent /></Link>;
  if (url) return <a href={url} target="_blank" rel="noreferrer" className="block h-full"><CardContent /></a>;
  return <CardContent />;
};

export default Card;

================
File: frontend/src/lib/axios.js
================
import axios from "axios";

const hostname = window.location.hostname;

const baseURL =
  import.meta.env.MODE === "development"
    ? `http://${hostname}:5000/api`
    : import.meta.env.VITE_BACKEND_URL || "https://uia-management.onrender.com/api";

export const axiosInstance = axios.create({
  baseURL,
  withCredentials: true,
});

================
File: frontend/src/pages/admin/AdminAttendance.jsx
================
import React, { useEffect, useState } from "react";
import { useParams } from "react-router-dom";
import { useStudentStore } from "../../store/studentStore";
import { useAdminStore } from "../../store/useAdminMngStore";
import Header from "../../components/Header";
import StudentTable from "../../components/StudentTable";
import { Calendar, Users } from "lucide-react";

const AdminAttendance = () => {
  let { batchId } = useParams();
  const { getBatches, batches, getTeachers, teachers } = useAdminStore();
  const { batchStudents, getBatchStudents } = useStudentStore();
  const [selectedBatch, setSelectedBatch] = useState(null);
  const [activeTab, setActiveTab] = useState("list");

  useEffect(() => {
    getBatches();
    getTeachers();
    if (batchId) getBatchStudents(batchId);
  }, [batchId]);

  useEffect(() => {
    if (batches.length > 0 && batchId) {
      setSelectedBatch(batches.find((c) => c._id === batchId));
    }
  }, [batches, batchId]);

  const teacherName = teachers.find(t => t._id === selectedBatch?.classTeacher)?.name || "Not Assigned";

  return (
    <div className="min-h-screen bg-slate-50 dark:bg-surface-dark pb-20">
      <Header page="Attendance Management" />
      
      <div className="max-w-7xl mx-auto px-4 mt-8">
        
        {/* Banner */}
        {selectedBatch && (
          <div className="bg-white dark:bg-slate-800 p-6 rounded-3xl shadow-sm border border-slate-200 dark:border-slate-700 flex flex-col sm:flex-row justify-between items-center gap-4 mb-8">
            <div className="flex items-center gap-4">
              <div className="w-14 h-14 bg-indigo-50 dark:bg-indigo-900/30 rounded-2xl flex items-center justify-center text-indigo-600 dark:text-indigo-400">
                <Users size={28} />
              </div>
              <div>
                <h1 className="text-2xl font-bold text-slate-900 dark:text-white">{selectedBatch.name}</h1>
                <p className="text-slate-500">Mentor: <span className="font-medium text-slate-700 dark:text-slate-300">{teacherName}</span></p>
              </div>
            </div>
            
            <div className="flex gap-2">
              <button 
                onClick={() => setActiveTab("list")}
                className={`px-5 py-2.5 rounded-xl text-sm font-bold transition-all ${
                  activeTab === "list" 
                    ? "bg-slate-100 dark:bg-slate-700 text-slate-900 dark:text-white" 
                    : "text-slate-500 hover:bg-slate-50"
                }`}
              >
                Student List
              </button>
              <button 
                onClick={() => setActiveTab("report")}
                className={`px-5 py-2.5 rounded-xl text-sm font-bold transition-all ${
                  activeTab === "report" 
                    ? "bg-indigo-600 text-white shadow-lg shadow-indigo-500/30" 
                    : "text-slate-500 hover:bg-slate-50"
                }`}
              >
                Attendance Report
              </button>
            </div>
          </div>
        )}

        {/* Content */}
        {activeTab === "list" ? (
          <StudentTable students={batchStudents} />
        ) : (
          <AttendanceReport cls={selectedBatch} students={batchStudents} />
        )}
      </div>
    </div>
  );
};

// --- Report Sub-Component ---
const AttendanceReport = ({ cls, students }) => {
  const [month, setMonth] = useState(new Date().toLocaleString('default', { month: 'long' }));
  const [monthData, setMonthData] = useState({});
  const days = monthData ? Object.keys(monthData).sort((a,b) => a-b) : [];

  useEffect(() => {
    if (cls?.attendance) {
      setMonthData(cls.attendance[month] || {});
    }
  }, [cls, month]);

  return (
    <div className="bg-white dark:bg-slate-800 rounded-3xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden">
      <div className="p-6 border-b border-slate-200 dark:border-slate-700 flex justify-between items-center">
        <h3 className="font-bold text-lg flex items-center gap-2">
          <Calendar className="text-primary-500" size={20}/> Monthly View
        </h3>
        <select 
          value={month} 
          onChange={(e) => setMonth(e.target.value)}
          className="bg-slate-50 dark:bg-slate-900 border-none rounded-lg px-4 py-2 text-sm focus:ring-2 focus:ring-primary-500 outline-none cursor-pointer"
        >
          {cls?.attendance && Object.keys(cls.attendance).map(m => (
            <option key={m} value={m}>{m}</option>
          ))}
        </select>
      </div>

      <div className="overflow-x-auto">
        <table className="w-full text-sm text-left">
          <thead className="bg-slate-50 dark:bg-slate-900/50 text-slate-500">
            <tr>
              <th className="px-4 py-3 min-w-[50px] text-center">Day</th>
              {students.map(s => (
                <th key={s._id} className="px-2 py-3 text-center min-w-[80px] font-medium truncate max-w-[100px]">
                  {s.name.split(' ')[0]}
                </th>
              ))}
              <th className="px-4 py-3 text-center font-bold">Present</th>
            </tr>
          </thead>
          <tbody className="divide-y divide-slate-100 dark:divide-slate-700">
            {days.map(day => {
              const dayRecords = monthData[day] || {};
              const presentCount = Object.values(dayRecords).filter(v => v).length;
              return (
                <tr key={day} className="hover:bg-slate-50 dark:hover:bg-slate-700/30">
                  <td className="px-4 py-3 text-center font-bold text-slate-700 dark:text-slate-300">{day}</td>
                  {students.map(s => (
                    <td key={s._id} className="px-2 py-3 text-center">
                      <div className={`w-2.5 h-2.5 mx-auto rounded-full ${dayRecords[s.studentId] ? "bg-emerald-500" : "bg-rose-500"}`}></div>
                    </td>
                  ))}
                  <td className="px-4 py-3 text-center font-bold text-primary-600">{presentCount}</td>
                </tr>
              )
            })}
          </tbody>
        </table>
      </div>
    </div>
  );
};

export default AdminAttendance;

================
File: frontend/src/pages/admin/AdminReadingProgressPage.jsx
================
"use client"

import { useState, useEffect } from "react"
import { useReadingProgress } from "../../store/readingProgressStore"
import LoadingSpinner from "../../components/LoadingSpinner"
import AdminReadingStatsCards from "../../components/AdminReadingStatsCards"
import AdminEmptyState from "../../components/AdminEmptyState"
import ReadingProgressDetailsModal from "../../components/ReadingProgressDetailsModal"
import Header from "../../components/Header"
import { useParams } from "react-router-dom"



const AdminReadingProgressPage = () => {
    const {studentId} = useParams()
  const { readingProgress, isLoading, getStdReadingProgress, updateReadingProgress, deleteReadingProgress } =
    useReadingProgress()
  const [selectedProgress, setSelectedProgress] = useState(null)
  const [searchTerm, setSearchTerm] = useState("")
  const [filterStatus, setFilterStatus] = useState("all")
  const [sortBy, setSortBy] = useState("newest")
  const [selectedItems, setSelectedItems] = useState([])

  useEffect(() => {
    getStdReadingProgress(studentId)
  }, [getStdReadingProgress])

  const handleApprove = async (progressId) => {
    try {
      await updateReadingProgress(progressId, { approval: true })
    } catch (error) {
      console.error("Error approving reading progress:", error)
    }
  }

  const handleReject = async (progressId) => {
    try {
      await updateReadingProgress(progressId, { approval: false })
    } catch (error) {
      console.error("Error rejecting reading progress:", error)
    }
  }

  const handleDelete = async (progressId) => {
    if (window.confirm("Are you sure you want to delete this reading progress?")) {
      try {
        await deleteReadingProgress(progressId)
      } catch (error) {
        console.error("Error deleting reading progress:", error)
      }
    }
  }

  const handleBulkApprove = async () => {
    if (selectedItems.length === 0) return
    try {
      await Promise.all(selectedItems.map((id) => updateReadingProgress(id, { approval: true })))
      setSelectedItems([])
    } catch (error) {
      console.error("Error bulk approving reading progress:", error)
    }
  }

  const handleBulkReject = async () => {
    if (selectedItems.length === 0) return
    try {
      await Promise.all(selectedItems.map((id) => updateReadingProgress(id, { approval: false })))
      setSelectedItems([])
    } catch (error) {
      console.error("Error bulk rejecting reading progress:", error)
    }
  }

  const toggleSelectItem = (id) => {
    setSelectedItems((prev) => (prev.includes(id) ? prev.filter((item) => item !== id) : [...prev, id]))
  }

  const toggleSelectAll = () => {
    if (selectedItems.length === filteredAndSortedProgress.length) {
      setSelectedItems([])
    } else {
      setSelectedItems(filteredAndSortedProgress.map((progress) => progress._id))
    }
  }

  const filteredAndSortedProgress =
    readingProgress
      ?.filter((progress) => {
        const matchesSearch =
          progress.bookName?.toLowerCase().includes(searchTerm.toLowerCase()) ||
          progress.authorName?.toLowerCase().includes(searchTerm.toLowerCase()) ||
          progress.publisher?.toLowerCase().includes(searchTerm.toLowerCase()) ||
          progress.studentId?.name?.toLowerCase().includes(searchTerm.toLowerCase())

        const matchesStatus =
          filterStatus === "all" ||
          (filterStatus === "approved" && progress.approval) ||
          (filterStatus === "pending" && !progress.approval)

        return matchesSearch && matchesStatus
      })
      ?.sort((a, b) => {
        switch (sortBy) {
          case "newest":
            return new Date(b.createdAt) - new Date(a.createdAt)
          case "oldest":
            return new Date(a.createdAt) - new Date(b.createdAt)
          case "student":
            return (a.studentId?.name || "").localeCompare(b.studentId?.name || "")
          case "book":
            return a.bookName.localeCompare(b.bookName)
          case "pages":
            return (b.numberOfPages || 0) - (a.numberOfPages || 0)
          default:
            return 0
        }
      }) || []

  if (isLoading) {
    return <LoadingSpinner />
  }

  return (
    <div
      className={`min-h-screen transition-colors duration-300 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 `}
    >
        <Header />
      <div className="max-w-7xl mx-auto p-4 md:p-8 mt-10">
        {/* Header Section */}
        <div className="mb-8">
          <div className="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6 mb-6">
            <div>
              <h1 className="text-3xl md:text-5xl font-bold mb-2 bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 dark:from-blue-400 dark:via-purple-400 dark:to-pink-400 bg-clip-text text-transparent">
                Manage Reading Progress
              </h1>
              <p className="text-sm text-gray-600 dark:text-gray-300">Review and approve student reading progress</p>
            </div>
            <div className="flex items-center gap-4">
              {selectedItems.length > 0 && (
                <div className="flex gap-2">
                  <button
                    onClick={handleBulkApprove}
                    className="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors duration-200"
                  >
                    Approve ({selectedItems.length})
                  </button>
                  <button
                    onClick={handleBulkReject}
                    className="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors duration-200"
                  >
                    Reject ({selectedItems.length})
                  </button>
                </div>
              )}
            </div>
          </div>

          {/* Stats Cards */}
          <AdminReadingStatsCards readingProgress={readingProgress || []} />
        </div>

        {/* Controls Section */}
        {/* <div className="bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm rounded-2xl p-6 mb-8 shadow-lg border border-white/20 dark:border-gray-700/50">
          <div className="flex flex-col lg:flex-row gap-4 mb-4">
            <div className="flex-1">
              <div className="relative">
                <div className="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                  <svg className="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path
                      strokeLinecap="round"
                      strokeLinejoin="round"
                      strokeWidth={2}
                      d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                    />
                  </svg>
                </div>
                <input
                  type="text"
                  placeholder="Search books, authors, students, or publishers..."
                  value={searchTerm}
                  onChange={(e) => setSearchTerm(e.target.value)}
                  className="w-full pl-12 pr-4 py-3 bg-white dark:bg-gray-700 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200"
                />
              </div>
            </div>

            <div className="flex gap-4">
              <select
                value={filterStatus}
                onChange={(e) => setFilterStatus(e.target.value)}
                className="px-4 py-3 bg-white dark:bg-gray-700 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base text-gray-900 dark:text-white focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200 min-w-32"
              >
                <option value="all">All Status</option>
                <option value="approved">Approved</option>
                <option value="pending">Pending</option>
              </select>

              <select
                value={sortBy}
                onChange={(e) => setSortBy(e.target.value)}
                className="px-4 py-3 bg-white dark:bg-gray-700 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-base text-gray-900 dark:text-white focus:outline-none focus:border-indigo-500 dark:focus:border-blue-500 focus:ring-4 focus:ring-indigo-100 dark:focus:ring-blue-500/20 transition-all duration-200 min-w-32"
              >
                <option value="newest">Newest First</option>
                <option value="oldest">Oldest First</option>
                <option value="student">By Student</option>
                <option value="book">By Book Name</option>
                <option value="pages">By Pages</option>
              </select>
            </div>
          </div>

          {filteredAndSortedProgress.length > 0 && (
            <div className="flex items-center gap-2">
              <input
                type="checkbox"
                id="selectAll"
                checked={selectedItems.length === filteredAndSortedProgress.length}
                onChange={toggleSelectAll}
                className="w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 rounded focus:ring-indigo-500 dark:focus:ring-indigo-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"
              />
              <label htmlFor="selectAll" className="text-sm font-medium text-gray-700 dark:text-gray-300">
                Select All ({filteredAndSortedProgress.length} items)
              </label>
            </div>
          )}
        </div> */}

        {/* Reading Progress Table */}
        <div className="bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/50 dark:border-gray-700/50 overflow-hidden">
          {filteredAndSortedProgress.length === 0 ? (
            <AdminEmptyState searchTerm={searchTerm} hasProgress={readingProgress?.length > 0} />
          ) : (
            <div className="overflow-x-auto">
              <table className="w-full">
                <thead className="bg-gray-50 dark:bg-gray-700/50">
                  <tr>
                    
                    <th className="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                      Book Details
                    </th>
                    <th className="hidden md:table-cell px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                      Author
                    </th>
                    <th className="hidden md:table-cell px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                      Pages
                    </th>
                    <th className="hidden md:table-cell px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                      Status
                    </th>
                    <th className="hidden md:table-cell px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                      Date
                    </th>
                    <th className="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                      Actions
                    </th>
                  </tr>
                </thead>
                <tbody className="divide-y divide-gray-200 dark:divide-gray-700">
                  {filteredAndSortedProgress.map((progress) => (
                    <tr
                      key={progress._id}
                      className="hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors duration-200"
                    >
                    
                      <td className="px-6 py-4">
                        <div className="text-sm font-medium text-gray-900 dark:text-white max-w-xs">
                          {progress.bookName}
                        </div>
                      </td>
                      <td className="hidden md:table-cell px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white">
                        {progress.authorName || "-"}
                      </td>
                      <td className="hidden md:table-cell px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white">
                        {progress.numberOfPages ? progress.numberOfPages.toLocaleString() : "-"}
                      </td>
                      <td className="hidden md:table-cell px-6 py-4 whitespace-nowrap">
                        {progress.approval ? (
                          <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300">
                            ‚úì Approved
                          </span>
                        ) : (
                          <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300">
                            ‚è≥ Pending
                          </span>
                        )}
                      </td>
                      <td className="hidden md:table-cell px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">
                        {progress.monthAndYear || new Date(progress.createdAt).toLocaleDateString()}
                      </td>
                      <td className="px-6 py-4 whitespace-nowrap text-xs font-medium">
                        <div className="flex items-center gap-2">
                          <button
                            onClick={() => setSelectedProgress(progress)}
                            className="text-indigo-600 dark:text-indigo-400 hover:text-indigo-900 dark:hover:text-indigo-300 transition-colors duration-200"
                          >
                            View
                          </button>
                          {!progress.approval && (
                            <button
                              onClick={() => handleApprove(progress._id)}
                              className="text-green-600 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300 transition-colors duration-200"
                            >
                              Approve
                            </button>
                          )}
                          {progress.approval && (
                            <button
                              onClick={() => handleReject(progress._id)}
                              className="text-yellow-600 dark:text-yellow-400 hover:text-yellow-900 dark:hover:text-yellow-300 transition-colors duration-200"
                            >
                              Revoke
                            </button>
                          )}
                          <button
                            onClick={() => handleDelete(progress._id)}
                            className="text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300 transition-colors duration-200"
                          >
                            Delete
                          </button>
                        </div>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          )}
        </div>

        {/* Reading Progress Details Modal */}
        {selectedProgress && (
          <ReadingProgressDetailsModal
            progress={selectedProgress}
            onClose={() => setSelectedProgress(null)}
            onApprove={handleApprove}
            onReject={handleReject}
            onDelete={handleDelete}
          />
        )}
      </div>
    </div>
  )
}

export default AdminReadingProgressPage

================
File: frontend/src/pages/admin/BatchStudents.jsx
================
import React, { useEffect, useState } from "react";
import { Eye, Search } from "lucide-react";
import { Link, useParams } from "react-router-dom";
import { useStudentStore } from "../../store/studentStore";
import { useMarksStore } from "../../store/useMarksStore";
import Header from "../../components/Header";
import { useAuthStore } from "../../store/useAuthStore";
import { useAchievement } from "../../store/achivemnetStore";
import { useReadingProgress } from "../../store/readingProgressStore";

const BatchStudents = () => {
  const { item: rawItem, batchId } = useParams();
  // ensure consistent spelling
  const item = rawItem === "achievements" ? "achievements" : rawItem;

  const [searchQuery, setSearchQuery] = useState("");
  const { getBatchStudents, batchStudents } = useStudentStore();
  const { getMarkListToapprove, markList } = useMarksStore();
  const { markListCountToApprove, marksCountToApproveByStd } = useMarksStore();
  const { achievementsCountToApprove, achieveCountToApproveByStd } = useAchievement();
  const { progressCountToApprove, progressCountToApproveByStd } = useReadingProgress();
  const { authUser } = useAuthStore();

  const [students, setStudents] = useState([]);
  const [countToApprove, setCountToApprove] = useState([]);

  // Fetch batch students and initial marklist count
  useEffect(() => {
    if (batchId) {
      getBatchStudents(batchId);
      getMarkListToapprove(batchId);
    }
  }, [batchId, getBatchStudents, getMarkListToapprove]);

  // Sync students list when batchStudents or markList changes
  useEffect(() => {
    if (batchStudents?.length) {
      setStudents([...batchStudents]);
    }
  }, [batchStudents, markList]);

  // Fetch counts by student when item or batch changes
  useEffect(() => {
    if (batchId) {
      if (item === "marklist") marksCountToApproveByStd(batchId);
      else if (item === "achievements") achieveCountToApproveByStd(batchId);
      else if (item === "reading-progress") progressCountToApproveByStd(batchId);
    }
  }, [item, batchId, marksCountToApproveByStd, achieveCountToApproveByStd, progressCountToApproveByStd]);

  // Sync countToApprove local state when store values change
  useEffect(() => {
    let arr = [];
    if (item === "marklist") arr = markListCountToApprove;
    else if (item === "achievements") arr = achievementsCountToApprove;
    else if (item === "reading-progress") arr = progressCountToApprove;

    setCountToApprove([...arr]);
  }, [item, markListCountToApprove, achievementsCountToApprove, progressCountToApprove]);

  // Filter students by search query
  const filteredStudents = students.filter((student) =>
    [student.name, String(student.cicNumber)]
      .some(field => field?.toLowerCase().includes(searchQuery.toLowerCase()))
  );

  return (
    <>
      <Header />
      <div className="min-h-screen bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-900 dark:to-gray-800 p-6 pt-24">
        <div className="flex justify-between items-center mb-8 flex-wrap gap-4">
          <h2 className="text-xl font-extrabold text-gray-900 dark:text-white font-oswald ml-2">
            Students' {item}
          </h2>
          <div className="relative w-full sm:w-1/3">
            <input
              type="text"
              placeholder="Search students..."
              className="w-full px-4 py-2 border rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 bg-white dark:bg-slate-800 shadow-sm"
              value={searchQuery}
              onChange={(e) => setSearchQuery(e.target.value)}
            />
            <Search className="absolute right-3 top-3 text-gray-400" size={18} />
          </div>
        </div>

        {filteredStudents.length === 0 ? (
          <div className="text-center py-10 text-gray-500 dark:text-gray-300">
            No students found.
          </div>
        ) : (
          <div className="grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4">
            {filteredStudents.map((student, index) => {
              const badge = countToApprove.find((s) => String(s._id) === String(student._id));
              return (
                <Link
                  key={student._id}
                  to={
                    authUser.role === "admin"
                      ? `/dashboard/admin/${item}/${student._id}`
                      : `/dashboard/teacher/${item}/${student._id}`
                  }
                >
                  <div className="relative bg-white dark:bg-gray-700 rounded-xl shadow-lg dark:shadow-gray-900 p-3 transform transition duration-300 hover:-translate-y-2 hover:shadow-2xl cursor-pointer">
                    {badge?.count > 0 && (
                      <div className="absolute top-2 right-2 w-5 h-5 flex items-center justify-center rounded-full bg-red-600 text-white text-xs font-bold">
                        {badge.count}
                      </div>
                    )}
                    <div className="flex items-center mb-2">
                      <div className="w-8 h-8 flex-shrink-0 rounded-full bg-sky-800 dark:bg-sky-600 text-white flex items-center justify-center font-bold text-sm mr-4">
                        {index + 1}
                      </div>
                      <div className="text-gray-900 dark:text-gray-200 text-sm font-bold">
                        {student.name}
                        <p className="font-normal text-gray-600 dark:text-gray-400 text-sm">
                          <span>CIC:</span> {student.cicNumber || "N/A"}
                        </p>
                      </div>
                    </div>
                  </div>
                </Link>
              );
            })}
          </div>
        )}
      </div>
    </>
  );
};

export default BatchStudents;

================
File: frontend/src/pages/admin/StudentList.jsx
================
import React, { useEffect, useState } from "react";
import Header from "../../components/Header";
import Footer from "../../components/Footer";
import StudentTable from "../../components/StudentTable";
import { AlertCircle, RefreshCw } from "lucide-react";
import { useStudentStore } from "../../store/studentStore";

const StudentList = ({inactive}) => {
  const { getStudents, deleteStudent, students, isLoading } = useStudentStore();
  const [error, setError] = useState(null);

  useEffect(() => {
    const fetchStudents = async () => {
      try {
        await getStudents();
      } catch (err) {
        setError("Failed to fetch Books. Please try again.");
      }
    };
    fetchStudents();
  }, []);



  return (
    <div className="min-h-screen flex flex-col items-center bg-white dark:bg-gray-900 text-gray-900 dark:text-white">
      <Header user={true} />

      {isLoading ? (
        <div className="mt-10 text-center">
          <p className="text-gray-600 dark:text-gray-400">Loading...</p>
          <div className="animate-spin rounded-full h-8 w-8 border-t-2 border-gray-500"></div>
        </div>
      ) : error ? (
        <div className="flex flex-col items-center mt-10">
          <AlertCircle className="text-red-500 dark:text-red-400" size={48} />
          <p className="text-red-500 dark:text-red-400 mt-2">{error}</p>
          <button
            onClick={() => window.location.reload()}
            className="mt-4 px-4 py-2 bg-red-500 dark:bg-red-600 text-white rounded-lg flex items-center gap-2 hover:bg-red-600 dark:hover:bg-red-700 transition"
          >
            <RefreshCw size={16} />
            Retry
          </button>
        </div>
      ) : (
       <div className="mt-16">
         <StudentTable students={students} />
       </div>
      )}

    </div>
  );
};

export default StudentList;

================
File: frontend/src/pages/staff/AssignedSubjects.jsx
================
import React, { useEffect, useState } from "react";
import { CheckCircle, Loader2 } from "lucide-react";
import Header from "../../components/Header";
import { useStaffStore } from "../../store/useStaffStore";
import { MdAdd, MdAddAlert, MdAddCircle, MdAddHomeWork, MdMarkunread } from "react-icons/md";
import { useAuthStore } from "../../store/useAuthStore";
import { useParams } from "react-router-dom";

const AssignedSubjects = () => {
  const { assignedSubjects, getAssignedSubjects, isLoading, } = useStaffStore();
  const {authUser} = useAuthStore();
  let { teacherId } = useParams();
  const [userId, setUserId] = useState('');

  useEffect(() => {
    if (teacherId) {
      setUserId(teacherId);
    } else if (authUser?._id) {
      setUserId(authUser._id);
    }
  }, [teacherId, authUser]);


  useEffect(() => {
    getAssignedSubjects(teacherId);
  }, [getAssignedSubjects]);

  return (
    <>
      <Header />
      <div className="min-h-screen bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-900 dark:to-gray-800 p-4 pt-24">
        <h2 className="text-2xl font-bold text-gray-800 dark:text-white mb-6 text-center">
         Subjects
        </h2>

        {isLoading ? (
          <div className="flex justify-center items-center h-40">
            <Loader2 className="animate-spin w-8 h-8 text-gray-600 dark:text-white" />
          </div>
        ) : (
          <div className="flex flex-col gap-4">
            {assignedSubjects.map((subject, index) => (
              <div
                key={subject._id || index}
                className="bg-white dark:bg-gray-800 rounded-2xl shadow-md px-5 py-4"
              >
                <div className="flex items-center justify-between mb-2">
                  <div className="flex items-center gap-4">
                    <div className="w-10 h-10 rounded-full  bg-sky-700 text-white flex items-center justify-center font-bold">
                      {index + 1}
                    </div>
                    <div>
                      <h3 className="text-lg font-semibold text-gray-900 dark:text-white capitalize">
                        {subject.name}
                      </h3>
                      <p className="text-sm text-gray-500 dark:text-gray-300">
                         {subject.batchDetails?.name || "N/A"}
                      </p>
                      {userId?.toString() === subject?.subTeacher?.toString() ? (
                          subject?.periodTeacher1 > 0 ? (
                            <p className="text-sm text-gray-500 dark:text-gray-300">
                              Period: {subject.periodTeacher1}
                            </p>
                          ) : null
                        ) : (
                          subject?.periodTeacher2 > 0 ? (
                            <p className="text-sm text-gray-500 dark:text-gray-300">
                              Period: {subject.periodTeacher2}
                            </p>
                          ) : null
                        )}

                    </div>
                  </div>
               
                  {subject.CEmark && (
                       <a
                       href={subject.batchDetails.CEmarkList}
                       target="_blank"
                       rel="noopener noreferrer"
                       aria-label="Open internal mark sheet in a new tab"
                       > 
                    <div className="flex items-center gap-2 bg-gradient-to-r from-red-500 to-amber-500 rounded-full px-3 py-2 shadow-md w-fit ">
                       <MdAdd className="w-4 h-4 text-white animate-pulse" />
                        <span className="text-xs font-medium text-white animate-pulse">CE Mark</span>
                    </div>
                    </a>
                    )}

                </div>
              </div>
            ))}
          </div>
        )}
      </div>
    </>
  );
};

export default AssignedSubjects;

================
File: frontend/src/pages/student/CurruntSemSubjects.jsx
================
import React, { useEffect } from "react";
import { CheckCircle, Loader2 } from "lucide-react";
import Header from "../../components/Header";
import { MdAdd, MdAddAlert, MdAddCircle, MdAddHomeWork, MdMarkunread } from "react-icons/md";
import { useStudentStore } from "../../store/studentStore";
import { useParams } from "react-router-dom";

const CurruntSemSubjects = () => {
  const {semSubjects, getCurruntSemSubjects, isLoading} = useStudentStore();

  useEffect(() => {
    getCurruntSemSubjects();
  }, [getCurruntSemSubjects]);

  return (
    <>
      <Header />
      <div className="min-h-screen bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-900 dark:to-gray-800 p-4 pt-24">
        <h2 className="text-xl font-bold text-gray-800 dark:text-white mb-6 text-center">
          My Subjects
        </h2>

        {isLoading ? (
          <div className="flex justify-center items-center h-40">
            <Loader2 className="animate-spin w-8 h-8 text-gray-600 dark:text-white" />
          </div>
        ) : (
          <div className="flex flex-col gap-4">
            {semSubjects.map((subject, index) => (
              <div
                key={subject._id || index}
                className="bg-white dark:bg-gray-800 rounded-2xl shadow-md px-5 py-4"
              >
                <div className="flex items-center justify-between mb-2">
                  <div className="flex items-center gap-4">
                    <div className="w-10 h-10 rounded-full  bg-sky-700 text-white flex items-center justify-center font-bold">
                      {index + 1}
                    </div>
                    <div>
                      <h3 className="text-sm font-semibold text-gray-900 dark:text-white capitalize">
                        {subject.name}
                      </h3>
                      <p className="text-xs text-gray-500 dark:text-gray-300">
                      Teacher: {subject?.subTeacherInfo?.[0]?.name || "Teacher not assigned"}
                      </p>
                      {
                        subject?.subTeacher2Info.length > 0  &&
                        <p className="text-xs text-gray-500 dark:text-gray-300">
                        Teacher 2: {subject?.subTeacher2Info?.[0]?.name || "Teacher not assigned"}
                        </p>
                      }
                      <p className="text-xs text-gray-500 dark:text-gray-300">
                        mark: {subject?.mark}
                      </p>
                      <p className="text-xs text-gray-500 dark:text-gray-300">
                       CE mark: {subject?.CEmark === true ? "Yes" : "No"}
                      </p>
                    </div>
                  </div>
               
                

                </div>
              </div>
            ))}
          </div>
        )}
      </div>
    </>
  );
};

export default CurruntSemSubjects;

================
File: frontend/src/pages/student/MarkListPage.jsx
================
import { useEffect, useState } from "react";
import { useParams } from "react-router-dom";
import { useMarksStore } from "../../store/useMarksStore";
import { useAuthStore } from "../../store/useAuthStore";
import { motion } from "framer-motion";
import { AlertTriangle, Lock, Send, CheckCircle, Clock } from "lucide-react";
import { axiosInstance } from "../../lib/axios";
import toast from "react-hot-toast";

const MarkListPage = () => {
  const { semesterid } = useParams();
  const { semesters, getSemesters, markList, getMarkList } = useMarksStore();
  const { authUser } = useAuthStore();
  
  const [selectedSemester, setSelectedSemester] = useState(null);

  useEffect(() => {
    getSemesters();
  }, []);

  useEffect(() => {
    if (authUser?._id && semesterid) {
      getMarkList(authUser._id, semesterid);
    }
  }, [authUser, semesterid]);

  useEffect(() => {
    setSelectedSemester(semesters.find(s => s._id === semesterid));
  }, [semesters, semesterid]);

  const marks = markList?.subjects || [];
  const totalMarks = marks.reduce((sum, s) => sum + (s.mark || 0), 0);
  const maxMarks = marks.reduce((sum, s) => sum + (s.total || 0), 0);
  const percentage = maxMarks ? ((totalMarks / maxMarks) * 100).toFixed(2) : "0.00";
  const isApproved = markList?.isApproved;

  const handleRequestEdit = async () => {
    try {
      await axiosInstance.patch(`/marklist/${markList._id}/request-edit`);
      toast.success("Edit request sent to administration");
    } catch {
      toast.error("Request failed");
    }
  };

  return (
    <div className="max-w-4xl mx-auto pt-10 pb-20">
      
      {/* Header */}
      <div className="mb-8 text-center">
        <h1 className="text-4xl font-display font-bold text-slate-800 dark:text-white mb-2">
          {selectedSemester?.name || "Semester Result"}
        </h1>
        <div className="inline-flex items-center gap-2 px-4 py-1.5 bg-white dark:bg-slate-800 rounded-full shadow-sm border border-slate-200 dark:border-slate-700 text-sm font-medium text-slate-500">
          {isApproved ? (
            <span className="flex items-center gap-1.5 text-emerald-600"><CheckCircle size={14} /> Official Result</span>
          ) : (
            <span className="flex items-center gap-1.5 text-amber-600"><Clock size={14} /> Provisional / Pending Approval</span>
          )}
        </div>
      </div>

      {/* Score Card */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <StatCard label="Total Score" value={totalMarks} sub={`/ ${maxMarks}`} />
        <StatCard label="Percentage" value={`${percentage}%`} highlight />
        <StatCard label="Result Status" value={percentage >= 40 ? "PASSED" : "FAILED"} color={percentage >= 40 ? "emerald" : "rose"} />
      </div>

      {/* Marks Table */}
      <motion.div 
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        className="bg-white dark:bg-slate-800 rounded-3xl shadow-lg border border-slate-200 dark:border-slate-700 overflow-hidden"
      >
        <table className="w-full text-left">
          <thead className="bg-slate-50 dark:bg-slate-900 border-b border-slate-200 dark:border-slate-700">
            <tr>
              <th className="px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider">Subject</th>
              <th className="px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider text-right">Max Mark</th>
              <th className="px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider text-right">Obtained</th>
              <th className="px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider text-center">Grade</th>
            </tr>
          </thead>
          <tbody className="divide-y divide-slate-100 dark:divide-slate-700">
            {marks.map((sub, i) => {
              const passed = sub.mark >= (sub.total * 0.4); // Simplified pass logic
              return (
                <tr key={i} className="hover:bg-slate-50 dark:hover:bg-slate-700/30 transition-colors">
                  <td className="px-6 py-4 font-medium text-slate-800 dark:text-slate-200">
                    {sub.subject}
                  </td>
                  <td className="px-6 py-4 text-right text-slate-500">{sub.total}</td>
                  <td className="px-6 py-4 text-right font-bold text-slate-800 dark:text-white">
                    {sub.mark}
                  </td>
                  <td className="px-6 py-4 text-center">
                    <span className={`px-2 py-1 rounded text-xs font-bold ${passed ? "bg-emerald-100 text-emerald-700" : "bg-rose-100 text-rose-700"}`}>
                      {passed ? "P" : "F"}
                    </span>
                  </td>
                </tr>
              );
            })}
          </tbody>
        </table>
        
        {/* Footer Action */}
        <div className="p-6 bg-slate-50 dark:bg-slate-900/50 border-t border-slate-200 dark:border-slate-700 flex justify-between items-center">
          <div className="flex items-center gap-2 text-sm text-slate-500">
            <Lock size={16} /> Results are locked by administration.
          </div>
          {isApproved && (
            <button 
              onClick={handleRequestEdit}
              className="text-sm text-primary-600 hover:text-primary-700 font-medium hover:underline"
            >
              Found an error? Request Edit
            </button>
          )}
        </div>
      </motion.div>
    </div>
  );
};

const StatCard = ({ label, value, sub, highlight, color }) => (
  <div className={`p-6 rounded-2xl border ${highlight ? 'bg-primary-600 text-white border-primary-600 shadow-xl shadow-primary-500/20' : 'bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700'}`}>
    <p className={`text-sm font-medium mb-1 ${highlight ? 'text-primary-100' : 'text-slate-500'}`}>{label}</p>
    <div className="flex items-baseline gap-2">
      <h3 className={`text-3xl font-display font-bold ${color === 'rose' ? 'text-rose-500' : color === 'emerald' ? 'text-emerald-500' : highlight ? 'text-white' : 'text-slate-800 dark:text-white'}`}>
        {value}
      </h3>
      {sub && <span className="text-sm opacity-60">{sub}</span>}
    </div>
  </div>
);

export default MarkListPage;

================
File: frontend/src/pages/student/StudentProfile.jsx
================
import { useState } from "react";
import { useAuthStore } from "../../store/useAuthStore";
import { motion, AnimatePresence } from "framer-motion";
import { 
  User, Phone, Mail, MapPin, MessageCircle, 
  GraduationCap, BadgeInfo, Users, Shield, Key, 
  Camera, Edit3, Save 
} from "lucide-react";
import toast from "react-hot-toast";

const StudentProfile = () => {
  const { authUser, changePassword } = useAuthStore();
  const [activeTab, setActiveTab] = useState("personal");

  // Passwords State
  const [passwords, setPasswords] = useState({
    currentPassword: "",
    newPassword: "",
    confirmPassword: ""
  });
  const [isSaving, setIsSaving] = useState(false);

  const handlePasswordChange = async (e) => {
    e.preventDefault();
    if (passwords.newPassword !== passwords.confirmPassword) {
      return toast.error("New passwords do not match");
    }
    if (passwords.newPassword.length < 4) {
      return toast.error("Password must be at least 4 characters");
    }
    
    setIsSaving(true);
    try {
      await changePassword(passwords.currentPassword, passwords.newPassword);
      setPasswords({ currentPassword: "", newPassword: "", confirmPassword: "" });
    } catch (error) {
      console.error(error);
    } finally {
      setIsSaving(false);
    }
  };

  return (
    <div className="min-h-screen bg-slate-50 dark:bg-surface-dark pb-20">
      
      {/* 1. Hero Cover Section */}
      <div className="relative h-60 md:h-80 bg-gradient-to-r from-primary-600 via-indigo-600 to-purple-600 overflow-hidden">
        {/* Abstract Background Patterns */}
        <div className="absolute inset-0 opacity-20">
          <div className="absolute -top-24 -left-24 w-96 h-96 bg-white rounded-full blur-3xl mix-blend-overlay"></div>
          <div className="absolute bottom-0 right-0 w-64 h-64 bg-amber-400 rounded-full blur-3xl mix-blend-overlay"></div>
        </div>
        
        <div className="absolute bottom-0 left-0 w-full h-24 bg-gradient-to-t from-slate-50/90 dark:from-surface-dark/90 to-transparent"></div>
      </div>

      <div className="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 relative -mt-24 z-10">
        
        {/* 2. Profile Header Card */}
        <div className="bg-white dark:bg-slate-800 rounded-3xl shadow-xl p-6 md:p-8 flex flex-col md:flex-row items-start md:items-end gap-6 border border-slate-100 dark:border-slate-700">
          
          {/* Avatar */}
          <div className="relative group">
            <div className="w-32 h-32 md:w-40 md:h-40 rounded-3xl border-4 border-white dark:border-slate-800 shadow-lg overflow-hidden bg-white">
              <img
                src={authUser?.profileImage || `https://api.dicebear.com/7.x/initials/svg?seed=${authUser?.name}`}
                alt="Profile"
                className="w-full h-full object-cover"
              />
            </div>
            {/* Camera Icon Overlay (Visual only for now) */}
            <div className="absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-3xl cursor-pointer">
              <Camera className="text-white" />
            </div>
          </div>

          {/* User Info */}
          <div className="flex-1 w-full md:w-auto">
            <h1 className="text-3xl font-display font-bold text-slate-900 dark:text-white mb-1">
              {authUser?.name}
            </h1>
            <div className="flex flex-wrap items-center gap-3 text-sm text-slate-500 dark:text-slate-400">
              <span className="flex items-center gap-1 bg-primary-50 dark:bg-primary-900/20 text-primary-600 dark:text-primary-400 px-3 py-1 rounded-full font-medium">
                <GraduationCap size={16} />
                {authUser?.role || "Student"}
              </span>
              <span className="flex items-center gap-1">
                <BadgeInfo size={16} />
                CIC: {authUser?.cicNumber || "N/A"}
              </span>
              <span className="hidden sm:inline text-slate-300">|</span>
              <span className="flex items-center gap-1">
                <Users size={16} />
                {authUser?.batchName || "No Batch"}
              </span>
            </div>
          </div>

          {/* Edit Profile Button (Visual) */}
          <button className="hidden md:flex items-center gap-2 px-5 py-2.5 bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 rounded-xl font-medium hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors">
            <Edit3 size={18} />
            Edit Profile
          </button>
        </div>

        {/* 3. Navigation Tabs */}
        <div className="mt-8 flex items-center gap-1 bg-white/50 dark:bg-slate-800/50 backdrop-blur-md p-1.5 rounded-2xl w-full md:w-fit border border-slate-200 dark:border-slate-700 overflow-x-auto">
          {["personal", "academic", "security"].map((tab) => (
            <button
              key={tab}
              onClick={() => setActiveTab(tab)}
              className={`relative px-6 py-2.5 rounded-xl text-sm font-medium transition-all duration-300 capitalize flex items-center gap-2
                ${activeTab === tab ? "text-primary-600 dark:text-white" : "text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}
              `}
            >
              {activeTab === tab && (
                <motion.div
                  layoutId="activeTab"
                  className="absolute inset-0 bg-white dark:bg-slate-700 shadow-sm rounded-xl"
                  transition={{ type: "spring", bounce: 0.2, duration: 0.6 }}
                />
              )}
              <span className="relative z-10 flex items-center gap-2">
                {tab === "personal" && <User size={18} />}
                {tab === "academic" && <GraduationCap size={18} />}
                {tab === "security" && <Shield size={18} />}
                {tab}
              </span>
            </button>
          ))}
        </div>

        {/* 4. Tab Content Area */}
        <div className="mt-6">
          <AnimatePresence mode="wait">
            <motion.div
              key={activeTab}
              initial={{ opacity: 0, y: 10 }}
              animate={{ opacity: 1, y: 0 }}
              exit={{ opacity: 0, y: -10 }}
              transition={{ duration: 0.3 }}
            >
              {/* --- PERSONAL TAB --- */}
              {activeTab === "personal" && (
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <InfoCard title="Contact Information" icon={Phone}>
                    <InfoRow icon={Phone} label="Phone" value={authUser?.phoneNumber} />
                    <InfoRow icon={MessageCircle} label="WhatsApp" value={authUser?.whatsupNumber} isLink linkPrefix="https://wa.me/" />
                    <InfoRow icon={Mail} label="Email" value={authUser?.email} isLink linkPrefix="mailto:" />
                  </InfoCard>
                  
                  <InfoCard title="Address & Location" icon={MapPin}>
                    <div className="flex items-start gap-4 p-4 bg-slate-50 dark:bg-slate-800/50 rounded-2xl border border-slate-100 dark:border-slate-700/50">
                      <div className="p-3 bg-white dark:bg-slate-700 rounded-xl shadow-sm text-primary-500">
                        <MapPin size={24} />
                      </div>
                      <div>
                        <p className="text-sm font-medium text-slate-500 dark:text-slate-400">Home Address</p>
                        <p className="text-base text-slate-800 dark:text-slate-200 mt-1 leading-relaxed">
                          {authUser?.address || "Address not provided"}
                        </p>
                      </div>
                    </div>
                  </InfoCard>
                </div>
              )}

              {/* --- ACADEMIC TAB --- */}
              {activeTab === "academic" && (
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <InfoCard title="Class Details" icon={Users}>
                    <InfoRow icon={GraduationCap} label="Current Semester" value={authUser?.semester} />
                    <InfoRow icon={Users} label="Batch" value={authUser?.batchName} />
                    <InfoRow icon={BadgeInfo} label="Roll Number" value={authUser?.rollNumber || "N/A"} />
                  </InfoCard>

                  <InfoCard title="Mentors & Leaders" icon={BadgeInfo}>
                    <InfoRow icon={User} label="Class Mentor" value={authUser?.classTeacher} />
                    <InfoRow icon={User} label="Class Leader 1" value={authUser?.classLeader} />
                    <InfoRow icon={User} label="Class Leader 2" value={authUser?.classLeader2} />
                  </InfoCard>
                </div>
              )}

              {/* --- SECURITY TAB --- */}
              {activeTab === "security" && (
                <div className="max-w-2xl">
                  <div className="bg-white dark:bg-slate-800 rounded-3xl shadow-sm border border-slate-200 dark:border-slate-700 p-8">
                    <div className="flex items-center gap-4 mb-6">
                      <div className="p-3 bg-rose-50 dark:bg-rose-900/20 rounded-2xl text-rose-500">
                        <Key size={24} />
                      </div>
                      <div>
                        <h3 className="text-lg font-bold text-slate-800 dark:text-white">Change Password</h3>
                        <p className="text-sm text-slate-500">Ensure your account uses a long, random password.</p>
                      </div>
                    </div>

                    <form onSubmit={handlePasswordChange} className="space-y-4">
                      <div className="space-y-1">
                        <label className="text-sm font-medium text-slate-700 dark:text-slate-300">Current Password</label>
                        <input 
                          type="password" 
                          value={passwords.currentPassword}
                          onChange={(e) => setPasswords({...passwords, currentPassword: e.target.value})}
                          className="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 focus:ring-2 focus:ring-primary-500 outline-none transition-all"
                          placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                        />
                      </div>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="space-y-1">
                          <label className="text-sm font-medium text-slate-700 dark:text-slate-300">New Password</label>
                          <input 
                            type="password" 
                            value={passwords.newPassword}
                            onChange={(e) => setPasswords({...passwords, newPassword: e.target.value})}
                            className="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 focus:ring-2 focus:ring-primary-500 outline-none transition-all"
                            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                          />
                        </div>
                        <div className="space-y-1">
                          <label className="text-sm font-medium text-slate-700 dark:text-slate-300">Confirm Password</label>
                          <input 
                            type="password" 
                            value={passwords.confirmPassword}
                            onChange={(e) => setPasswords({...passwords, confirmPassword: e.target.value})}
                            className="w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 focus:ring-2 focus:ring-primary-500 outline-none transition-all"
                            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                          />
                        </div>
                      </div>
                      <div className="pt-4 flex justify-end">
                        <button 
                          type="submit" 
                          disabled={isSaving}
                          className="flex items-center gap-2 px-6 py-3 bg-primary-600 hover:bg-primary-700 text-white rounded-xl font-medium shadow-lg shadow-primary-500/30 transition-all disabled:opacity-70"
                        >
                          {isSaving ? <Loader2 className="animate-spin" /> : <Save size={18} />}
                          Update Password
                        </button>
                      </div>
                    </form>
                  </div>
                </div>
              )}
            </motion.div>
          </AnimatePresence>
        </div>
      </div>
    </div>
  );
};

// --- Helper Components for Clean Code ---

const InfoCard = ({ title, icon: Icon, children }) => (
  <div className="bg-white dark:bg-slate-800 rounded-3xl shadow-sm border border-slate-200 dark:border-slate-700 p-6">
    <div className="flex items-center gap-3 mb-6 border-b border-slate-100 dark:border-slate-700 pb-4">
      <div className="p-2 bg-primary-50 dark:bg-primary-900/20 rounded-lg text-primary-600 dark:text-primary-400">
        <Icon size={20} />
      </div>
      <h3 className="font-bold text-slate-800 dark:text-white">{title}</h3>
    </div>
    <div className="space-y-4">
      {children}
    </div>
  </div>
);

const InfoRow = ({ icon: Icon, label, value, isLink, linkPrefix }) => (
  <div className="flex items-center justify-between p-3 hover:bg-slate-50 dark:hover:bg-slate-700/50 rounded-xl transition-colors group">
    <div className="flex items-center gap-3">
      <div className="text-slate-400 group-hover:text-primary-500 transition-colors">
        <Icon size={18} />
      </div>
      <span className="text-sm font-medium text-slate-500 dark:text-slate-400">{label}</span>
    </div>
    {isLink && value ? (
      <a 
        href={`${linkPrefix}${value}`} 
        target="_blank" 
        rel="noreferrer"
        className="text-primary-600 dark:text-primary-400 font-medium hover:underline"
      >
        {value}
      </a>
    ) : (
      <span className="font-semibold text-slate-800 dark:text-slate-200 text-right">{value || "Not set"}</span>
    )}
  </div>
);

export default StudentProfile;

================
File: frontend/src/routes/PrivateRoutes.jsx
================
import { Routes, Route, Navigate } from "react-router-dom";
import { useAuthStore } from "../store/useAuthStore";
import StudentRoutes from "./StudentRoutes";
import TeacherRoutes from "./TeacherRoutes";
import AdminRoutes from "./AdminRoutes";
import DashboardLayout from "../components/layout/DashboardLayout"; // Import the new layout

const PrivateRoutes = () => {
  const { authUser } = useAuthStore();

  if (!authUser) return <Navigate to="/auth/login" replace />;

  return (
    <Routes>
      <Route element={<DashboardLayout />}>
        {/* All these routes will now be rendered INSIDE the Glass Layout */}
        
        {authUser.role === "student" && (
          <Route path="student/*" element={<StudentRoutes />} />
        )}
        {authUser.role === "teacher" && (
          <Route path="teacher/*" element={<TeacherRoutes />} />
        )}
        {authUser.role === "admin" && (
          <Route path="admin/*" element={<AdminRoutes />} />
        )}
        
      </Route>

      <Route
        path="*"
        element={
          authUser?.role ? (
            <Navigate to={authUser.role.toLowerCase()} replace />
          ) : (
            <Navigate to="/login" replace />
          )
        }
      />
    </Routes>
  );
};

export default PrivateRoutes;

================
File: frontend/src/routes/StudentRoutes.jsx
================
import { Routes, Route, Navigate } from "react-router-dom";

import StudentHome from "../pages/student/StudentHome";
import StudentSemesterListing from "../pages/student/StudentSemesterListing";
import MarkListPage from "../pages/student/MarkListPage";
import CurruntSemSubjects from "../pages/student/CurruntSemSubjects";
import StudentFees from "../pages/student/StudentFees";
import StudentProfile from "../pages/student/StudentProfile";
import NotFound from "../pages/NotFound"; 
import AchievementPage from "../pages/student/AchivementPage";
import ReadingProgressPage from "../pages/student/readingProgressPage";
import AcademicRegister from "../pages/student/StdAcademicRegister";
import StudentFeePortal from "../pages/student/StudentFees";


const StudentRoutes = () => {
  return (
    <Routes>
      <Route index element={<StudentHome />} />
      <Route path="academic-register" element={<AcademicRegister  />} />
      <Route path="semester-list" element={<StudentSemesterListing />} />
      <Route path="achievement" element={<AchievementPage/>} />
      <Route path="reading-progress" element={<ReadingProgressPage/>} />
      <Route path="semester/:semesterid" element={<MarkListPage />} />
      <Route path="subjects" element={<CurruntSemSubjects />} />
      <Route path="ishthiraq" element={<StudentFeePortal />} />
      <Route path="profile" element={<StudentProfile />} />



      <Route path="*" element={<NotFound />} />
    </Routes>
  );
};

export default StudentRoutes;

================
File: frontend/src/routes/TeacherRoutes.jsx
================
import { Routes, Route } from "react-router-dom";
import AttendancePage from "../pages/staff/AttendancePage";
import TeacherHome from "../pages/staff/TeacherHome";
import TeacherAddGraceMark from "../pages/staff/TeacherAddGraceMark";
import CalssTeacherHome from "../pages/staff/CalssTeacherHome";
import BatchStudentsDetails from "../pages/staff/BatchStudentsDetails";
import AssignedSubjects from "../pages/staff/AssignedSubjects";
import StaffProfile from "../pages/admin/StaffProfile";
import FeesTeacher from "../pages/staff/FeesTeacher";
import MarkSubmitedStudentsPage from "../pages/admin/MarkSubmitedStudentsPage";
import AdminsideMarkListes from "../pages/admin/AdminsideMarkListes ";
import BatchStudents from "../pages/admin/BatchStudents";
import AdminAchievementsPage from "../pages/admin/AdminAchievementsPage";
import AdminReadingProgressPage from "../pages/admin/AdminReadingProgressPage";
import AcademicRegister from "../pages/staff/StaffAcademicRegister";
import BatchAcademicStatus from "../pages/admin/BatchAcademicStatus";

const TeacherRoutes = () => {
  return (
    <Routes>
      <Route index element={<TeacherHome />} />
      <Route path="attendance/:classname" element={<AttendancePage />} />
      <Route path="calss-teacher-home/:batchId" element={<CalssTeacherHome />} />
      <Route path="batch-students/:batchId" element={<BatchStudentsDetails />} />
      <Route path="grace-mark" element={<TeacherAddGraceMark />} />
      <Route path="assigned-subjects" element={<AssignedSubjects />} />
      <Route path="ishthiraq/:batchId" element={<FeesTeacher />} />
      <Route path="profile" element={<StaffProfile />} />
    
      <Route path="batches/:item/:batchId" element={<BatchStudents />} />
      <Route path="marklist/:studentId" element={<AdminsideMarkListes />} />
      <Route path="achievements/:studentId" element={<AdminAchievementsPage />} />
      <Route path="reading-progress/:studentId" element={<AdminReadingProgressPage />} />

      <Route path="academic-register" element={<AcademicRegister  />} />
      <Route path="std-attendance-register" element={<BatchAcademicStatus item="stdAttendanceRegister" />} />
      <Route path="staff-attendance-register" element={<BatchAcademicStatus item="staffAttendanceRegister" />} />
      <Route path="subject-status" element={<BatchAcademicStatus item="subjectStatus" />} />
      <Route path="ce-status" element={<BatchAcademicStatus item="ceStatus" />} />

      <Route path="*" element={<TeacherHome />} />
    </Routes>
  );
};

export default TeacherRoutes;

================
File: frontend/src/store/achivemnetStore.js
================
import { create } from "zustand";
import toast from "react-hot-toast";
import { axiosInstance } from "../lib/axios";
import { useAuthStore } from "./useAuthStore";

export const useAchievement = create((set, get) => ({
  achievements: [],
  achievementsCountToApprove: [],
  isLoading: false,
  error: null,

  // Fetch all achievements 
  getAchievementsByBatch: async () => {
    set({ isLoading: true, error: null });
    try {
        const authUser = useAuthStore.getState().authUser;
      const res = await axiosInstance.get(`/achievements/${authUser._id}`);
      set({ achievements: res.data, isLoading: false });
    } catch (error) {
      console.error("Failed to fetch achievements:", error.message);
      set({ error: error.message, isLoading: false });
      toast.error("Failed to load achievements");
    }
  },

  
  // Fetch all achievements for a student
  getStdAchievements: async (studentId) => {
    set({ isLoading: true, error: null });
    try {
      const id = studentId || useAuthStore.getState().authUser._id;
      const res = await axiosInstance.get(`/achievements/${id}`);
      set({ achievements: res.data, isLoading: false });
    } catch (error) {
      console.error("Failed to fetch achievements:", error.message);
      set({ error: error.message, isLoading: false });
      toast.error("Failed to load achievements");
    }
  },

  // Add a new achievement
  addAchievement: async (data) => {
    try {
        const authUser = useAuthStore.getState().authUser;
      const res = await axiosInstance.post(`/achievements/${authUser._id}`, data);
      set((state) => ({
        achievements: [...state.achievements, res.data]
      }));
      toast.success("Achievement added");
    } catch (error) {
      console.error("Failed to add achievement:", error.message);
      toast.error("Failed to add achievement");
    }
  },

  // Update an existing achievement
  updateAchievement: async (achievementId, data) => {
    try {
      const res = await axiosInstance.put(`/achievements/${achievementId}`, data);
      set((state) => ({
        achievements: state.achievements.map((a) =>
          a._id === achievementId ? res.data : a
        )
      }));
      toast.success("Achievement updated");
    } catch (error) {
      console.error("Failed to update achievement:", error.message);
      toast.error("Update failed");
    }
  },
deleteAchievement: async (achievementId) => {
  try {
    const res = await axiosInstance.delete(`/achievements/${achievementId}`);
    set((state) => ({
      achievements: state.achievements.filter(a => a._id !== achievementId)
    }));
    toast.success("Achievement deleted successfully");
    return res.data;
  } catch (error) {
    console.error("Delete error:", error);
    toast.error("Failed to delete achievement");
  }
},
achieveCountToApproveByBatch: async () => {
  try {
    const res =await axiosInstance.get('/achievements/count');
    
    set({ achievementsCountToApprove: [...res.data] });

    const {achievementsCountToApprove} = get()
    console.log("count",achievementsCountToApprove);
    
  } catch (error) {
      console.log("Error in getcountToApprove", error);
  }
},
achieveCountToApproveByStd: async (batchId) => {
  try {
    const res =await axiosInstance.get(`/achievements/count/${batchId}`);
    
    set({ achievementsCountToApprove: [...res.data] });

  } catch (error) {
      console.log("Error in getcountToApprove", error);
  }
},

}));

================
File: frontend/src/store/useMarksStore.js
================
import { create } from "zustand";
import { axiosInstance } from "../lib/axios";
import toast from "react-hot-toast";

export const useMarksStore = create((set, get) => ({
    semesters: [],
    isLoading: false,
    markList: [],
    markListCountToApprove: [],

    addMarkList: async (studentId, semesterId, markList) => {
        set({isLoading: true})
        try {
          const res = await axiosInstance.post("/marklist", {
            studentId,
            semesterId,
            markList,
          });
          toast.success(res.data.message);
        } catch (error) {
          toast.error(error.message);
        } finally {
            set({isLoading: false})
        }
    },
    getMarkList: async (studentId, semesterId) => {
        set({isLoading: true});
        try {
            if(studentId, semesterId){
                const res = await axiosInstance.get(`/marklist/?studentId=${studentId}&semesterId=${semesterId}`);
            set({markList: res.data})
            }else if(studentId){
                const res = await axiosInstance.get(`/marklist/?studentId=${studentId}`);
            set({markList: res.data})
            }
        } catch (error) {
            toast.error(error.message);
        } finally {
            set({isLoading: false})
        }
    },
    getMarkListToapprove: async (batchId) => {
        set({isLoading: true});
        try {
            const res = await axiosInstance.get(`/marklist/?batchId=${batchId}`);
            set({markList: res.data})
        
        } catch (error) {
            toast.error(error.message);
        } finally {
            set({isLoading: false})
        }
    },
 
    marksCountToApproveByBatch: async () => {
        try {
          const res =await axiosInstance.get('/marklist/count');
          
          set({markListCountToApprove: res.data})
        } catch (error) {
            console.log("Error in getcountToApprove", error);
        }
      },
    marksCountToApproveByStd: async (batchId) => {
        try {
          const res =await axiosInstance.get(`/marklist/count/${batchId}`);
          set({markListCountToApprove: res.data})
        } catch (error) {
            console.log("Error in getcountToApprove", error);
        }
      },

    getSemesters: async () => {
        set({ isLoading: true });
    
        try {
            const res = await axiosInstance.get('/mng/semester'); 
    
            set({ semesters: res.data });
        } catch (error) {
            console.log("Error in getSemesters:", error);
        } finally {
            set({ isLoading: false }); 
        }
    }
    
}))

================
File: backend/package.json
================
{
  "name": "backend",
  "version": "1.0.0",
  "main": "src/index.js",
  "scripts": {
    "dev": "nodemon src/index.js",
    "start": "node src/index.js"
  },
  "keywords": [],
  "author": "",
  "type": "module",
  "license": "ISC",
  "description": "",
  "dependencies": {
    "axios": "^1.8.4",
    "bcryptjs": "^3.0.0",
    "cloudinary": "^2.5.1",
    "cookie-parser": "^1.4.7",
    "cors": "^2.8.5",
    "dotenv": "^16.4.7",
    "express": "^4.21.2",
    "express-async-handler": "^1.2.0",
    "google-auth-library": "^9.15.1",
    "google-spreadsheet": "^4.1.4",
    "googleapis": "^148.0.0",
    "jsonwebtoken": "^9.0.2",
    "mongoose": "^8.10.1",
    "uia-management": "file:.."
  },
  "devDependencies": {
    "nodemon": "^3.1.9"
  },
  "engines": {
    "node": "18.x"
  }
}

================
File: backend/src/controllers/marksComtroller.js
================
import Marklist from "../models/marklist.model.js";
import Semester from "../models/semester.model.js"
import Student from "../models/student.model.js";
import mongoose from "mongoose";


export const addMarkList = async (req, res) => {
    try {
        const { studentId, semesterId, markList } = req.body;
 
        if (!studentId || !semesterId || !markList) {
            return res.status(400).json({ message: "All fields are required" });
        }

        const student = await Student.findById(studentId);
        const cicNumber = Number(student.cicNumber)
        if (!student) {
            return res.status(404).json({ message: "Student not found" });
        }
        const existingMarklist = await Marklist.findOneAndUpdate(
            { studentId, semesterId }, 
            { 
              subjects: markList, 
              batchId: student.batchId, 
              cicNumber,
              editingStatus: "disable" 
            },
            { new: true, upsert: true } 
          );
          
          await existingMarklist.save();
          
      

        res.status(201).json({ message: "Mark List added successfully" });

    } catch (error) {
        console.error("Error adding mark list:", error);
        res.status(500).json({ message: "Internal Server Error" });
    }
};

export const getMarkList = async (req, res) => {
    try {
        const { studentId, semesterId, batchId } = req.query;
        let markList;
        if(studentId && semesterId){
         markList = await Marklist.findOne({ studentId, semesterId});
        }else if(studentId){
         markList = await Marklist.find({ studentId });
        }else if(batchId){
         markList = await Marklist.find({ batchId });
        }
        
        if (markList) {
            return res.status(200).json(markList);
        } else {
            return res.status(200).json([]); 
        }
    } catch (error) {
        console.error("Error fetching mark list:", error);
        res.status(500).json({ message: "Internal server error" });
    }
};

// export const getCountToApprove = async (req, res) => {
//     try {
//         // const pendingMarkLists = await Marklist.find({ isApproved: false });
//         const counts = await Marklist.aggregate([
//             { $match: { $or: [
//               { isApproved: false },
//               { editingStatus: "send" }
//             ] } },
//             { $group: { _id: "$batchId", count: { $sum: 1 } } } 
//         ]);
        
//         res.status(200).json(counts);
//     } catch (error) {
//         console.error("Error fetching count to approve:", error);
//         res.status(500).json({ message: "Internal Server Error" });
//     }
// };

export const getCountToApproveByStd = async (req, res) => {
  try {
    const { batchId } = req.params;

    if (!batchId) {
      return res.status(400).json({ message: "batchId is required" });
    }

    const batchObjId = new mongoose.Types.ObjectId(batchId);

    const counts = await Marklist.aggregate([
      {
        $match: {
          $and: [
            {
              $or: [
                { isApproved: false },
                { editingStatus: "send" }
              ]
            },
            { batchId: batchObjId } 
          ]
        }
      },
      {
        $group: {
          _id: "$studentId",
          count: { $sum: 1 }
        }
      }
    ]);

    return res.status(200).json(counts);
  } catch (error) {
    console.error("Error fetching count to approve:", error);
    return res.status(500).json({ message: "Internal Server Error" });
  }
};



  export const getCountToApproveByBatch = async (req, res) => {
      try {
          const counts = await Marklist.aggregate([
            { $match: { $or: [
              { isApproved: false },
              { editingStatus: "send" }
            ] } },
            { $group: { _id: "$batchId", count: { $sum: 1 } } } 
        ]);
          
          res.status(200).json(counts);
      } catch (error) {
          console.error("Error fetching count to approve:", error);
          res.status(500).json({ message: "Internal Server Error" });
      }
  };
  

export const updateStatus = async (req, res) => {
    try {
      const { status } = req.body; 
      const { marklistId } = req.params;
      
  
      
      const updatedMarklist = await Marklist.findByIdAndUpdate(
        marklistId,
        {isApproved: status, isEditable: false },
        { new: true }
      );
      
  
      if (!updatedMarklist) {
        return res.status(404).json({ message: "Marklist not found" });
      }
  
      res.status(200).json({
        message: "Status updated successfully",
        marklist: updatedMarklist,
      });
    } catch (error) {
      console.error(error);
      res.status(500).json({ message: "Internal server error" });
    }
  };

  export const editAceesRequst = async (req, res) => {
    try {
      
      const { marklistId } = req.params;

       const updatedMarklist = await Marklist.findByIdAndUpdate(
        marklistId,
        {editingStatus: "send" },
        { new: true }
      );
      
      if (!updatedMarklist) {
        return res.status(404).json({ message: "Marklist not found" });
      }
  
      res.status(200).json({
        message: "Edit access requeted successfully",
        marklist: updatedMarklist,
      });
    } catch (error) {
      console.error(error);
      res.status(500).json({ message: "Internal server error" });
    }
  }
  
 export const allowEditAccess = async (req, res) => {
  try {
    const { marklistId } = req.params;

     const updatedMarklist = await Marklist.findByIdAndUpdate(
      marklistId,
      {isApproved: false, isEditable: true, editingStatus: "allow" },
      { new: true }
    );
    
    if (!updatedMarklist) {
      return res.status(404).json({ message: "Marklist not found" });
    }

    res.status(200).json({
      message: "Edit access allowed successfully",
      marklist: updatedMarklist,
    });
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Internal server error" });
  }
}

================
File: backend/src/controllers/readingProgressController.js
================
import ReadingProgress from "../models/readingProgress.model.js";
import Student from "../models/student.model.js";
import mongoose from "mongoose"

export const getStdReadingProgress = async (req, res) => {
    try {
      const { studentId } = req.params;
      const records = await ReadingProgress.find({ studentId });
      res.json(records);
    } catch (error) {
      console.error("Error fetching reading progress:", error.message);
      res.status(500).json({ message: "Failed to get reading progress" });
    }
  };
  
  export const postStdReadingProgress = async (req, res) => {
    try {
      const { studentId } = req.params;
      const student = await Student.findById(studentId);
      const newRecord = new ReadingProgress({
        ...req.body,
        studentId,
        batchId: student.batchId
      });
      const saved = await newRecord.save();
      res.status(201).json(saved);
    } catch (error) {
      console.error("Error saving reading progress:", error.message);
      res.status(400).json({ message: "Failed to add reading progress" });
    }
  };
  
  export const editStdReadingProgress = async (req, res) => {
    try {
      const { recordId } = req.params;
      const updated = await ReadingProgress.findByIdAndUpdate(
        recordId,
        req.body,
        { new: true }
      );
      res.json(updated);
    } catch (error) {
      console.error("Error updating reading progress:", error.message);
      res.status(400).json({ message: "Failed to update reading progress" });
    }
  };

  export const deleteStdReadingProgress = async (req, res) => {
      try {
        const { recordId } = req.params;
        const deleted = await ReadingProgress.findByIdAndDelete(recordId);
    
        if (!deleted) {
          return res.status(404).json({ message: "ReadingProgress not found" });
        }
    
        res.json({ message: "ReadingProgress deleted successfully", deleted });
      } catch (error) {
        console.error("Error deleting ReadingProgress:", error.message);
        res.status(500).json({ message: "Failed to delete ReadingProgress" });
      }
    };
  
   
     
   
     export const getCountToApproveByBatch = async (req, res) => {
         try {
             const counts = await ReadingProgress.aggregate([
                 { $match: { approval: false } },
                 { $group: { _id: "$batchId", count: { $sum: 1 } } } 
             ]);
             
             res.status(200).json(counts);
         } catch (error) {
             console.error("Error fetching count to approve:", error);
             res.status(500).json({ message: "Internal Server Error" });
         }
     };
     
     

     export const getCountToApproveByStd = async (req, res) => {
       try {
         const { batchId } = req.params;
         if (!batchId) {
           return res.status(400).json({ message: "batchId is required" });
         }
     
         const batchObjId = new mongoose.Types.ObjectId(batchId);
     
         const counts = await ReadingProgress.aggregate([
           { $match: { approval: false, batchId: batchObjId } },
           { $group:  { _id: "$studentId", count: { $sum: 1 } } }
         ]);
     
         return res.status(200).json(counts);
       } catch (error) {
         console.error("Error fetching count to approve:", error);
         return res.status(500).json({ message: "Internal Server Error" });
       }
     };

================
File: backend/src/middleware/auth.middleware.js
================
import jwt from "jsonwebtoken"
import User from "../models/student.model.js"
import Staff from "../models/staff.model.js";
import Batch from "../models/batch.model.js";
import Student from "../models/student.model.js";
import Semester from "../models/semester.model.js";

export const protectRoute = async (req, res, next) => {
  try {
    const token = req.cookies.jwt;

    if (!token) {
      return res.status(401).json({ message: "Unauthorized - No token provided" });
    }

    const decoded = jwt.verify(token, process.env.JWT_SECRET);
    if (!decoded || !decoded.userId) {
      return res.status(401).json({ message: "Unauthorized - Invalid token" });
    }

    let user = await User.findOne({ _id: decoded.userId, isActive: true }).select("-password");

    if (!user) {
      user = await Staff.findById(decoded.userId).select("-password");
    }

    if (!user) {
      return res.status(401).json({ message: "Unauthorized - User not found" });
    }

    if (user.role === "student") {
      const batch = await Batch.findById(user.batchId);
      if (batch) {
        const [semester, staff, leader1, leader2] = await Promise.all([
          batch.currentSemester ? Semester.findById(batch.currentSemester) : null,
          batch.classTeacher ? Staff.findById(batch.classTeacher) : null,
          batch.classLeader ? Student.findById(batch.classLeader) : null,
          batch.classLeader2 ? Student.findById(batch.classLeader2) : null,
        ]);

        user = user.toObject(); 
        user.batchName = batch.name || "Unknown Batch";
        user.semester = semester?.name || " ";
        user.classTeacher = staff?.name || " ";
        user.classLeader = leader1?.name || " ",
        user.classLeader2 = leader2?.name || " "
      }
    } else {
      user = user.toObject(); 
    }

    req.user = user;
    next();

  } catch (error) {
    console.error("Error in protectRoute middleware:", error.message);
    res.status(500).json({ message: "Internal server error" });
  }
};

================
File: backend/src/models/Subject.model.js
================
import mongoose from "mongoose";
import Semester from "./semester.model.js";

const subjectSchema = new mongoose.Schema(
  {
    name: {
      type: String,
      required: true,
      trim: true,
    },
    mark: {
      type: Number,
      required: true
    },
    CEmark: {
     type: Boolean,
     default: false
    },
    code: {
      type: String,
      uppercase: true,
    },
    isArtSub: {
      type: Boolean,
    },
    semester: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "Semester",
    },
    artSemester: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "ArtSemester",
    },
    subTeacher: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "Staff",
    },
    subTeacher2: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "Staff",
    },
    periodTeacher1: {
      type: Number,
    },
    periodTeacher2: {
      type: Number,
    },
    description: {
      type: String,
      trim: true,
    },
  },
  { timestamps: true }
);

subjectSchema.pre("save", async function (next) {
  if (!this.code) {
    try {
      const semesterId = this.semester;  
      const semester = await Semester.findById(semesterId); 
      if (!semester) {
        throw new Error("Semester not found");
      }

      const namePart = this.name.substring(0, 4).toUpperCase();
      const semesterSufix = semester.name.charAt(semester.name.length - 1); 

      const lastSubject = await mongoose
        .model("Subject")
        .findOne({ code: new RegExp(`^${namePart}\\d{3}$`, "i") })
        .sort({ createdAt: -1 });

      let nextNumber = 10;
      if (lastSubject && lastSubject.code) {
        const lastNumber = parseInt(lastSubject.code.match(/\d+$/), 10);
        if (!isNaN(lastNumber)) {
          nextNumber = lastNumber + 1;
        }
      }

      this.code = `${namePart}${nextNumber}${semesterSufix}`;
    } catch (error) {
      return next(error); 
    }
  }
  next();
});

export default mongoose.model("Subject", subjectSchema);

================
File: backend/src/routes/fees.route.js
================
import express from "express";
import { assignFeesToBatch, createFee, getDashboardAnalytics, getFeeByStudent, getFeesByBatch, getFeesByStd, updateFeeStatus } from "../controllers/feesController.js";

const router = express.Router();

router.put("/:cicNumber", updateFeeStatus );

router.post("/", createFee);

router.get("/", getFeesByBatch);

router.get('/dashboard', getDashboardAnalytics);

router.get('/std', getFeeByStudent)

router.post("/assign", assignFeesToBatch); 

router.get("/get-std-fees/:studentId", getFeesByStd);

export default router;

================
File: frontend/src/pages/admin/AssignDutiesPage.jsx
================
import { useEffect, useState } from "react"
import { 
  FiBook, 
  FiUsers, 
  FiUser, 
  FiPlus, 
  FiX, 
  FiCheck, 
  FiInfo, 
  FiEdit2, 
  FiSearch,
  FiBookOpen,
  FiCalendar,
  FiUserCheck,
  FiAlertCircle,
  FiLoader,
  FiList
} from "react-icons/fi"
import { axiosInstance } from "../../lib/axios"
import { useAdminStore } from "../../store/useAdminMngStore"
import { useStudentStore } from "../../store/studentStore"
import Header from "../../components/Header"
import { ListChecks } from "lucide-react"
import TimetableAssignment from "./TimetableAsigment"

const StatusBadge = ({ isAssigned, label }) => (
  <span
    className={`ml-2 px-2 py-0.5 text-xs font-medium rounded-full transition-colors duration-300 ${
      isAssigned
        ? "bg-emerald-100 dark:bg-emerald-900/30 text-emerald-800 dark:text-emerald-300"
        : "bg-amber-100 dark:bg-amber-900/30 text-amber-800 dark:text-amber-300"
    }`}
  >
    {isAssigned ? "Assigned" : "Pending"}
  </span>
)

const AssignmentCard = ({ 
  id, 
  name, 
  isAssigned, 
  assignedName,
  assignedName2, 
  periodTeacher1,
  periodTeacher2,
  isEditing, 
  toggleEdit, 
  children,
  icon: Icon = FiUser
}) => (
  <div
    className="bg-white dark:bg-gray-800 rounded-xl shadow-md border border-gray-100 dark:border-gray-700 
    overflow-hidden transition-all duration-300 hover:shadow-lg transform hover:-translate-y-1"
  >
    <div className="bg-gray-50 dark:bg-gray-700 px-6 py-4 border-b border-gray-200 dark:border-gray-600 flex justify-between items-center">
      <h3 className="font-semibold text-gray-800 dark:text-white flex items-center gap-2">
        {name}
        <StatusBadge isAssigned={isAssigned} />
      </h3>
      <button
        onClick={() => toggleEdit(id)}
        className="text-gray-700 hover:text-sky-600 dark:text-gray-400 dark:hover:text-sky-400 
        transition-colors duration-200 p-1.5 rounded-full hover:bg-gray-100 dark:hover:bg-gray-600"
        aria-label={isEditing ? "Cancel editing" : "Edit assignment"}
      >
        {isEditing ? <FiX className="w-5 h-5" /> : <FiEdit2 className="w-5 h-5" />}
      </button>
    </div>

    <div className="p-6">
      {isEditing ? (
        children
      ) : (
        <div className="space-y-4">
          <div className="flex items-center gap-4">
            <div className="w-14 h-14 rounded-full bg-sky-100 dark:bg-sky-900/30 flex items-center justify-center text-sky-600 dark:text-sky-300">
              <Icon className="w-7 h-7" />
            </div>
            <div>
              <p className="text-sm text-gray-500 dark:text-gray-400 mb-1">Assigned</p>
              <p className="font-medium text-gray-800 dark:text-white text-sm">
                {assignedName || "Not assigned yet"}
                {periodTeacher1 > 0 &&  <span className="ml-2 text-sm text-gray-500">Period: {periodTeacher1}</span>}
              </p> 
              {
                assignedName2 && 
                <p className="font-medium text-gray-800 dark:text-white text-sm">
                {assignedName2 || "Not assigned yet"}
                {periodTeacher2 > 0 && <span className="ml-2 text-sm text-gray-500">Period: {periodTeacher2}</span>}
              </p>
              }
            </div>
          </div>

          {!isAssigned && (
            <button
              onClick={() => toggleEdit(id)}
              className="w-full mt-3 py-2.5 bg-sky-600 hover:bg-sky-700 text-white rounded-lg 
              transition-all duration-200 flex items-center justify-center gap-2 shadow-sm hover:shadow
              focus:ring-2 focus:ring-sky-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800"
            >
              <FiPlus className="w-4 h-4" />
              Assign Now
            </button>
          )}
        </div>
      )}
    </div>
  </div>
)

const EmptyState = ({ searchTerm }) => (
  <div className="bg-white dark:bg-gray-800 rounded-xl shadow-md p-10 text-center max-w-md mx-auto">
    <div className="bg-gray-100 dark:bg-gray-700 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6">
      <FiAlertCircle className="w-10 h-10 text-gray-500 dark:text-gray-400" />
    </div>
    <h3 className="text-xl font-medium text-gray-800 dark:text-white mb-3">No items found</h3>
    <p className="text-gray-600 dark:text-gray-400 mb-6">
      {searchTerm ? "Try a different search term" : "Add items to start making assignments"}
    </p>
  
  </div>
)

const NotificationMessage = ({ message, onDismiss }) => {
  if (!message) return null;
  
  return (
    <div
      className={`p-4 rounded-lg flex items-center gap-3 shadow-md animate-fadeIn transition-all duration-300 ${
        message.type === "error"
          ? "bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 border-l-4 border-red-700"
          : "bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-300 border-l-4 border-emerald-700"
      }`}
    >
      {message.type === "error" ? <FiX className="w-5 h-5 flex-shrink-0" /> : <FiCheck className="w-5 h-5 flex-shrink-0" />}
      <span className="flex-grow">{message.text}</span>
      <button 
        onClick={onDismiss} 
        className="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"
        aria-label="Dismiss notification"
      >
        <FiX className="w-4 h-4" />
      </button>
    </div>
  )
}

const SearchBar = ({ value, onChange, placeholder }) => (
  <div className="relative w-full max-w-sm">
    <FiSearch className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" />
    <input
      type="text"
      placeholder={placeholder}
      value={value}
      onChange={(e) => onChange(e.target.value)}
      className="pl-10 pr-4 py-2.5 w-full rounded-lg border border-gray-300 dark:border-gray-600 
      bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-sky-500 
      focus:border-sky-500 transition-all duration-200"
    />
    {value && (
      <button 
        onClick={() => onChange("")}
        className="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600"
        aria-label="Clear search"
      >
        <FiX className="w-4 h-4" />
      </button>
    )}
  </div>
)

function SubjectAssignment({ batches, teachers, art = false }) {
  const { getSubjects, subjects, getArtSubjects, artSubjects } = useAdminStore();
  const [selectedBatch, setSelectedBatch] = useState(batches[0]);
  const [subjectAssignments, setSubjectAssignments] = useState({});
  const [allSubjects, setAllSubjects] = useState([])
  const [message, setMessage] = useState(null);
  const [searchTerm, setSearchTerm] = useState("");
  const [editMode, setEditMode] = useState({});
  const [isLoading, setIsLoading] = useState(false);

 useEffect(() => {
  if (selectedBatch) {
    setIsLoading(true);
    setAllSubjects([])
    if(art) {
    getArtSubjects(selectedBatch.currentArtSemester);
    } else {
    getSubjects(selectedBatch.currentSemester);
    }
  setIsLoading(false);
  }
}, [selectedBatch, getSubjects, getArtSubjects]);

useEffect(() => {
  if (art) {
    setAllSubjects(artSubjects);
  } else {
    setAllSubjects(subjects);
  }
}, [subjects, artSubjects, art]);


  useEffect(() => {
    const modified = {};
    for (const sub of allSubjects) {
      modified[sub._id] = {
        subTeacher: sub.subTeacher || "",
        subTeacher2: sub.subTeacher2 || "",
        periodTeacher2: sub.periodTeacher2 || "",
        periodTeacher1: sub.periodTeacher1 || "",
      };
    }
    setSubjectAssignments(modified);
  }, [subjects, artSubjects, allSubjects]);

  const handleTeacherSelect = async (subjectId, teacherId, second = false) => {
    try {
      setSubjectAssignments((prev) => ({
        ...prev,
        [subjectId]: {
          ...prev[subjectId],
          [second ? "subTeacher2" : "subTeacher"]: teacherId,
        },
      }));

      await axiosInstance.post("/mng/asign-subteacher", {
        subjectId,
        teacherId,
        second,
        art
      });

      setMessage({
        type: "success",
        text: "Subject teacher updated successfully!",
      });
      setEditMode((prev) => ({ ...prev, [subjectId]: false }));

      setTimeout(() => setMessage(null), 3000);
    } catch {
      setMessage({
        type: "error",
        text: "Failed to update subject teacher. Please try again.",
      });
    }
  };

  const handlePeriodSelect = async (subjectId, period, second = false) => {
    try {
      setSubjectAssignments((prev) => ({
        ...prev,
        [subjectId]: {
          ...prev[subjectId],
          [second ? "periodTeacher2" : "periodTeacher1"]: period,
        },
      }));

      await axiosInstance.post("/mng/asign-subteacher-period", {
        subjectId,
        period,
        second,
        art
      });

      setMessage({
        type: "success",
        text: "Period count updated successfully!",
      });

      setTimeout(() => setMessage(null), 3000);
    } catch {
      setMessage({
        type: "error",
        text: "Failed to update period count. Please try again.",
      });
    }
  };

  const toggleEditMode = (subjectId) => {
    setEditMode((prev) => ({
      ...prev,
      [subjectId]: !prev[subjectId],
    }));
  };

  const filteredSubjects = allSubjects.filter((subject) =>
    subject.name.toLowerCase().includes(searchTerm.toLowerCase())
  );

  return (
    <div className="space-y-6">
      <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
        <div className="mb-3 sm:mb-0 w-full md:w-auto">
          <label className="text-sm font-medium text-gray-600 dark:text-gray-400 mb-1 block">Select Batch</label>
          <select
            value={selectedBatch?._id || ""}
            onChange={(e) =>
              setSelectedBatch(batches.find((b) => b._id === e.target.value))
            }
            className="w-full md:w-64 border-0 bg-gray-100 dark:bg-gray-700 rounded-lg py-2.5 px-3 text-gray-800 dark:text-gray-100 focus:ring-2 focus:ring-sky-500 appearance-none"
          >
            <option value="" disabled>Select batch</option>
            {batches.map((b) => (
              <option key={b._id} value={b._id}>{b.name}</option>
            ))}
          </select>
        </div>
        <SearchBar value={searchTerm} onChange={setSearchTerm} placeholder="Search subjects..." />
      </div>

      <NotificationMessage message={message} onDismiss={() => setMessage(null)} />

      {isLoading ? (
        <div className="flex justify-center items-center py-20">
          <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-sky-600"></div>
        </div>
      ) : filteredSubjects.length > 0 ? (
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {filteredSubjects.map((subject) => {
            const sub = subjectAssignments[subject._id] || {};
            const teacher = teachers.find((t) => t._id === sub.subTeacher);
            const teacher2 = teachers.find((t) => t._id === sub.subTeacher2);
            const isEditing = editMode[subject._id];

            return (
              <AssignmentCard
                key={subject._id}
                id={subject._id}
                name={subject.name}
                isAssigned={!!teacher}
                assignedName={teacher?.name}
                assignedName2={teacher2?.name}
                periodTeacher1={subject?.periodTeacher1}
                periodTeacher2={subject?.periodTeacher2}
                isEditing={isEditing}
                toggleEdit={toggleEditMode}
                icon={FiBookOpen}
              >
                <div className="grid grid-cols-2 gap-4">
                  {/* Teacher 1 */}
                  <div>
                    <label className="block text-sm font-medium text-gray-700 dark:text-gray-300">Select Teacher 1</label>
                    <select
                      value={sub.subTeacher}
                      onChange={(e) => handleTeacherSelect(subject._id, e.target.value)}
                      className="w-full px-4 py-2.5 rounded-lg border bg-white dark:bg-gray-700 dark:border-gray-600 text-gray-900 dark:text-white"
                    >
                      <option value="">Select teacher...</option>
                      {teachers.map((t) => (
                        <option key={t._id} value={t._id}>{t.name}</option>
                      ))}
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 dark:text-gray-300">Period</label>
                    <select
                      value={sub.periodTeacher1}
                      onChange={(e) => handlePeriodSelect(subject._id, e.target.value)}
                      className="w-full px-4 py-2.5 rounded-lg border bg-white dark:bg-gray-700 dark:border-gray-600 text-gray-900 dark:text-white"
                    >
                      <option value="">Select...</option>
                      {[0,1,2,3,4,5,6,7,8,9,10].map(p => (
                        <option key={p} value={p}>{p}</option>
                      ))}
                    </select>
                  </div>

                  {/* Teacher 2 */}
                  <div>
                    <label className="block text-sm font-medium text-gray-700 dark:text-gray-300">Select Teacher 2</label>
                    <select
                      value={sub.subTeacher2}
                      onChange={(e) => handleTeacherSelect(subject._id, e.target.value, true)}
                      className="w-full px-4 py-2.5 rounded-lg border bg-white dark:bg-gray-700 dark:border-gray-600 text-gray-900 dark:text-white"
                    >
                      <option value="">Select teacher...</option>
                      {teachers.map((t) => (
                        <option key={t._id} value={t._id}>{t.name}</option>
                      ))}
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 dark:text-gray-300">Period</label>
                    <select
                      value={sub.periodTeacher2}
                      onChange={(e) => handlePeriodSelect(subject._id, e.target.value, true)}
                      className="w-full px-4 py-2.5 rounded-lg border bg-white dark:bg-gray-700 dark:border-gray-600 text-gray-900 dark:text-white"
                    >
                      <option value="">Select...</option>
                      {[0,1,2,3,4,5,6,7,8,9,10].map(p => (
                        <option key={p} value={p}>{p}</option>
                      ))}
                    </select>
                  </div>
                </div>
              </AssignmentCard>
            );
          })}
        </div>
      ) : (
        <EmptyState searchTerm={searchTerm} />
      )}
    </div>
  );
}


function BatchTeacherAssignment({ batches, teachers }) {
  const [batchAssignments, setBatchAssignments] = useState({})
  const [message, setMessage] = useState(null)
  const [searchTerm, setSearchTerm] = useState("")
  const [editMode, setEditMode] = useState({})

  useEffect(() => {
    const modified = {}
    for (const cl of batches) {
      modified[cl._id] = cl.classTeacher || ""
    }
    setBatchAssignments(modified)
  }, [batches])

  const handleTeacherSelect = async (classId, teacherId) => {
    try {
      setBatchAssignments((prev) => ({
        ...prev,
        [classId]: teacherId,
      }))

      await axiosInstance.post("/mng/asign-teacher", {
        classId,
        teacherId,
      })

      setMessage({ type: "success", text: "Batch teacher updated successfully!" })
      setEditMode((prev) => ({ ...prev, [classId]: false }))

      setTimeout(() => setMessage(null), 3000)
    } catch (error) {
      setMessage({ type: "error", text: "Failed to update batch teacher. Please try again." })
    }
  }

  const toggleEditMode = (batchId) => {
    setEditMode((prev) => ({
      ...prev,
      [batchId]: !prev[batchId],
    }))
  }

  const filteredBatches = batches.filter((batch) => 
    batch.name.toLowerCase().includes(searchTerm.toLowerCase())
  )

  return (
    <div className="space-y-6">
      <div className="flex justify-end mb-6">
        <SearchBar 
          value={searchTerm}
          onChange={setSearchTerm}
          placeholder="Search batches..."
        />
      </div>

      <NotificationMessage 
        message={message} 
        onDismiss={() => setMessage(null)} 
      />

      {filteredBatches.length > 0 ? (
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {filteredBatches.map((batch) => {
            const teacherId = batchAssignments[batch._id]
            const teacher = teachers.find((t) => t._id === teacherId)
            const isEditing = editMode[batch._id]

            return (
              <AssignmentCard
                key={batch._id}
                id={batch._id}
                name={batch.name}
                isAssigned={!!teacher}
                assignedName={teacher?.name}
                isEditing={isEditing}
                toggleEdit={toggleEditMode}
                icon={FiUsers}
              >
                <div className="space-y-4">
                  <label className="block text-sm font-medium text-gray-700 dark:text-gray-300">
                    Select Teacher
                  </label>
                  <select
                    value={batchAssignments[batch._id] || ""}
                    onChange={(e) => handleTeacherSelect(batch._id, e.target.value)}
                    className="w-full px-4 py-2.5 rounded-lg border border-gray-300 dark:border-gray-600 
                    bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 
                    focus:ring-sky-500 focus:border-sky-500 transition-all duration-200"
                  >
                    <option value="">Select teacher...</option>
                    {teachers.map((t) => (
                      <option key={t._id} value={t._id}>
                        {t.name}
                      </option>
                    ))}
                  </select>
                </div>
              </AssignmentCard>
            )
          })}
        </div>
      ) : (
        <EmptyState searchTerm={searchTerm} />
      )}
    </div>
  )
}

function SemesterAssignment({batches, semesters}) {
  const [batchAssignments, setBatchAssignments] = useState({})
  const [message, setMessage] = useState(null)
  const [searchTerm, setSearchTerm] = useState("")
  const [editMode, setEditMode] = useState({})

  useEffect(() => {
    const modified = {}
    for (const cl of batches) {
      modified[cl._id] = cl.currentSemester || ""
    }
    setBatchAssignments(modified)
  }, [batches])

  const handleSemesterSelect = async (classId, semesterId) => {
    try {
      setBatchAssignments((prev) => ({
        ...prev,
        [classId]: semesterId,
      }))

      await axiosInstance.post("/mng/asign-semester", {
        classId,
        semesterId,
      })

      setMessage({ type: "success", text: "Semester assigned successfully!" })
      setEditMode((prev) => ({ ...prev, [classId]: false }))

      setTimeout(() => setMessage(null), 3000)
    } catch (error) {
      setMessage({ type: "error", text: "Failed to update semester. Please try again." })
    }
  }

  const toggleEditMode = (batchId) => {
    setEditMode((prev) => ({
      ...prev,
      [batchId]: !prev[batchId],
    }))
  }

  const filteredBatches = batches.filter((batch) => 
    batch.name.toLowerCase().includes(searchTerm.toLowerCase())
  )

  return (
    <div className="space-y-6">
      <div className="flex justify-end mb-6">
        <SearchBar 
          value={searchTerm}
          onChange={setSearchTerm}
          placeholder="Search batches..."
        />
      </div>

      <NotificationMessage 
        message={message} 
        onDismiss={() => setMessage(null)} 
      />

      {filteredBatches.length > 0 ? (
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {filteredBatches.map((batch) => {
            const semesterId = batchAssignments[batch._id]
            const semester = semesters.find((s) => s._id === semesterId)
            const isEditing = editMode[batch._id]

            return (
              <AssignmentCard
                key={batch._id}
                id={batch._id}
                name={batch.name}
                isAssigned={!!semester}
                assignedName={semester?.name}
                isEditing={isEditing}
                toggleEdit={toggleEditMode}
                icon={FiCalendar}
              >
                <div className="space-y-4">
                  <label className="block text-sm font-medium text-gray-700 dark:text-gray-300">
                    Select Semester
                  </label>
                  <select
                    value={batchAssignments[batch._id] || ""}
                    onChange={(e) => handleSemesterSelect(batch._id, e.target.value)}
                    className="w-full px-4 py-2.5 rounded-lg border border-gray-300 dark:border-gray-600 
                    bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 
                    focus:ring-sky-500 focus:border-sky-500 transition-all duration-200"
                  >
                    <option value="">Select Semester...</option>
                    {semesters.map((s) => (
                      <option key={s._id} value={s._id}>
                        {s.name}
                      </option>
                    ))}
                  </select>
                </div>
              </AssignmentCard>
            )
          })}
        </div>
      ) : (
        <EmptyState searchTerm={searchTerm} />
      )}
    </div>
  )
}

const ClassLeaderAssignment = ({ batches, students }) => {
  const [batchAssignments, setBatchAssignments] = useState({})
  const [message, setMessage] = useState(null)
  const [searchTerm, setSearchTerm] = useState("")
  const [editMode, setEditMode] = useState({})

  useEffect(() => {
    const modified = {}
    for (const batch of batches) {
      modified[batch._id] = {
        classLeader: batch.classLeader || "",
        classLeader2: batch.classLeader2 || ""
      }
    }
    setBatchAssignments(modified)
  }, [batches])

  const handleLeaderSelect = async (batchId, studentId, second = false) => {
    try {
      setBatchAssignments(prev => ({
        ...prev,
        [batchId]: {
          ...prev[batchId],
          [second ? "classLeader2" : "classLeader"]: studentId
        }
      }))

      await axiosInstance.post("/mng/asign-class-leader", {
        classId: batchId,
        studentId,
        second
      })

      setMessage({ type: "success", text: "Class leader assigned successfully!" })
      setEditMode(prev => ({ ...prev, [batchId]: false }))

      setTimeout(() => setMessage(null), 3000)
    } catch (error) {
      setMessage({ type: "error", text: "Failed to update class leader. Please try again." })
    }
  }

  const toggleEditMode = (batchId) => {
    setEditMode(prev => ({
      ...prev,
      [batchId]: !prev[batchId]
    }))
  }

  const filteredBatches = batches.filter(batch =>
    batch.name.toLowerCase().includes(searchTerm.toLowerCase())
  )

  return (
    <div className="space-y-6">
      <div className="flex justify-end mb-6">
        <SearchBar
          value={searchTerm}
          onChange={setSearchTerm}
          placeholder="Search batches..."
        />
      </div>

      <NotificationMessage message={message} onDismiss={() => setMessage(null)} />

      {filteredBatches.length > 0 ? (
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {filteredBatches.map((batch) => {
            const assignment = batchAssignments[batch._id] || {}
            const leader1 = students.find((s) => s._id === assignment.classLeader)
            const leader2 = students.find((s) => s._id === assignment.classLeader2)
            const batchStudents = students.filter((s) => s.batchId === batch._id)
            const isEditing = editMode[batch._id]

            return (
              <AssignmentCard
                key={batch._id}
                id={batch._id}
                name={batch.name}
                isAssigned={!!(leader1 || leader2)}
                assignedName={leader1?.name}
                assignedName2={leader2?.name}
                isEditing={isEditing}
                toggleEdit={toggleEditMode}
                icon={FiUserCheck}
              >
                <div className="space-y-4">
                  <label className="block text-sm font-medium text-gray-700 dark:text-gray-300">
                    Select Class Leader 1
                  </label>
                  <select
                    value={assignment.classLeader}
                    onChange={(e) => handleLeaderSelect(batch._id, e.target.value)}
                    className="w-full px-4 py-2.5 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition-all duration-200"
                  >
                    <option value="">Select student...</option>
                    <option value="No">Not Assigned</option>
                    {batchStudents.map((student) => (
                      <option key={student._id} value={student._id}>
                        {student.name}
                      </option>
                    ))}
                  </select>

                  <label className="block text-sm font-medium text-gray-700 dark:text-gray-300">
                    Select Class Leader 2
                  </label>
                  <select
                    value={assignment.classLeader2}
                    onChange={(e) => handleLeaderSelect(batch._id, e.target.value, true)}
                    className="w-full px-4 py-2.5 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition-all duration-200"
                  >
                    <option value="">Select student...</option>
                    <option value="No">Not Assigned</option>
                    {batchStudents.map((student) => (
                      <option key={student._id} value={student._id}>
                        {student.name}
                      </option>
                    ))}
                  </select>
                </div>
              </AssignmentCard>
            )
          })}
        </div>
      ) : (
        <EmptyState searchTerm={searchTerm} />
      )}
    </div>
  )
}

function AssignDutiesPage() {
  const [activeTab, setActiveTab] = useState("subjects")
  const { getBatches, getTeachers, getSemesters, getArtSems, batches, teachers, semesters, artSems } = useAdminStore()
  const { students, getStudents } = useStudentStore()
  const props = { batches, teachers, semesters, students, artSems }
  const [loading, setLoading] = useState(true)

  // Fetch data from API
  useEffect(() => {
    const fetchData = async () => {
      setLoading(true)
      try {
        await Promise.all([getBatches(), getSemesters(), getTeachers(), getStudents(), getArtSems()])
      } catch (error) {
        console.error("Error fetching data:", error)
      } finally {
        setLoading(false)
      }
    }
    fetchData()
  }, [getBatches, getSemesters, getTeachers, getStudents])

  const tabs = [
    { id: "subjects", label: "Assign Subject", icon: FiBook },
    { id: "artSubjects", label: "Assign Art Subject", icon: FiBookOpen },
    { id: "classTeacher", label: "Class Mentors", icon: FiUsers },
    { id: "classLeader", label: "Class Leaders", icon: FiUserCheck },
    // { id: "timeTable", label: "Time Table", icon: FiList }
  ]

  return (
    <div className="min-h-screen bg-gray-50 dark:bg-gray-900 py-8 transition-colors duration-300">
      <Header />
      <div className="max-w-7xl mx-auto px-4 mt-14 sm:px-6 lg:px-8">
      
      <header className="mb-10">
        <div className="relative overflow-x-auto scrollbar-hide">
          <div className="flex space-x-2 p-1 bg-white dark:bg-gray-800 rounded-xl shadow-md w-max md:max-w-3xl mx-auto">
            {tabs.map((tab) => (
              <button
                key={tab.id}
                onClick={() => setActiveTab(tab.id)}
                className={`flex-shrink-0 px-4 py-2 rounded-full font-medium text-sm flex items-center gap-2 transition-all duration-300
                  ${
                    activeTab === tab.id
                      ? "bg-sky-600 text-white shadow-md"
                      : "bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"
                  }`}
              >
                <tab.icon className={`w-4 h-4 ${activeTab === tab.id ? "text-white" : "text-sky-600 dark:text-sky-400"}`} />
                <span className="text-sm">{tab.label}</span>
              </button>
            ))}
          </div>
        </div>
      </header>



        {loading ? (
          <div className="flex flex-col justify-center items-center py-20">
            <FiLoader className="w-10 h-10 text-sky-600 animate-spin mb-4" />
            <p className="text-gray-600 dark:text-gray-400">Loading data...</p>
          </div>
        ) : activeTab === "subjects" ? (
          <SubjectAssignment {...props} />
        ) : activeTab === "artSubjects" ? (
          <SubjectAssignment batches={batches} teachers={teachers} art={true} />
        ) : activeTab === "classTeacher" ? (
          <BatchTeacherAssignment {...props} />
        ) : activeTab === "currentSemester" ? (
          <SemesterAssignment {...props} />
        ) : activeTab === "classLeader" ? (
          <ClassLeaderAssignment {...props}  />
        ) : <TimetableAssignment /> }
      </div>
    </div>
  )
}

export default AssignDutiesPage

================
File: frontend/src/pages/admin/MarkSubmitedStudentsPage.jsx
================
import React, { useEffect, useState } from "react";
import { Eye, Search } from "lucide-react";
import { Link, useParams } from "react-router-dom";
import { useStudentStore } from "../../store/studentStore";
import { useMarksStore } from "../../store/useMarksStore";
import Header from "../../components/Header";
import { useAuthStore } from "../../store/useAuthStore";

const MarkSubmitedStudentsPage = () => {
  const { batchId } = useParams();
  const [searchQuery, setSearchQuery] = useState("");
  const { getBatchStudents, batchStudents } = useStudentStore();
  const [students, setStudents] = useState([]);
  const { getMarkListToapprove, markList } = useMarksStore();
  const {authUser} = useAuthStore();

  useEffect(() => {
    getBatchStudents(batchId);
    getMarkListToapprove(batchId);
  }, [batchId]);

  useEffect(() => {
    if (batchStudents?.length > 0) {
      setStudents(
        [...batchStudents]
      );
      // setStudents(
      //   batchStudents.filter((s) =>
      //     markList.some((m) => m.studentId === s._id)
      //   )
      // );
    }
  }, [batchStudents, markList]);

  const filteredStudents = students.filter((student) =>
    [student.name, String(student.cicNumber), student.batch]
      .some(field => field?.toLowerCase().includes(searchQuery.toLowerCase()))
  );

  return (
    <>
      <Header />
      <div className="min-h-screen bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-900 dark:to-gray-800 p-6 pt-24">
        <div className="flex justify-between items-center mb-8 flex-wrap gap-4">
          <h2 className="text-2xl font-extrabold text-gray-900 dark:text-white font-oswald ml-2">
          Students' Mark List
          </h2>
          <div className="relative w-full sm:w-1/3">
            <input
              type="text"
              placeholder="Search students..."
              className="w-full px-4 py-2 border rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 bg-white shadow-sm"
              value={searchQuery}
              onChange={(e) => setSearchQuery(e.target.value)}
            />
            <Search className="absolute right-3 top-3 text-gray-400" size={18} />
          </div>
        </div>

        {filteredStudents.length === 0 ? (
          <div className="text-center py-10 text-gray-500 dark:text-gray-300">
            No students found.
          </div>
        ) : (
          
          <div className="grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4">
            {filteredStudents.map((student, index) => (
              <Link
              key={student._id}
              to={
                authUser.role === "admin"
                  ? `/dashboard/admin/marklist/${student._id}`
                  : `/dashboard/teacher/marklist/${student._id}`
              }
            >
                 <div
                key={student._id}
                className="bg-white dark:bg-gray-700 rounded-xl shadow-lg dark:shadow-gray-900 p-6 transform transition duration-300 hover:-translate-y-2 hover:shadow-2xl cursor-pointer"
              >
                  {/* üîπ Badge for Pending Approvals or requsted to edit */}
                    {(() => {
                      const studentMarks = markList.filter(
                        (m) =>
                          m.studentId === student._id &&
                          (
                            m.isApproved === false ||
                            m.editingStatus === "send"
                          )
                      );

                      return (
                        studentMarks.length > 0 && (
                          <div className="absolute top-2 right-2 w-5 h-5 flex items-center justify-center rounded-full bg-red-600 text-white text-xs font-bold">
                            {studentMarks.length}
                          </div>
                        )
                      );
                    })()}

                <div className="flex items-center mb-4">
                  <div className="w-10 h-10 flex-shrink-0 rounded-full bg-sky-800 dark:bg-sky-600 text-white flex items-center justify-center font-bold text-lg mr-4">
                    {index + 1}
                  </div>
                  <div className="text-gray-900 dark:text-gray-200 text-lg font-medium font-sans">
                    {student.name}
                    <p><span className="font-normal">CIC:</span> {student.cicNumber}</p>
                  </div>
                </div>
                {/* <div className="text-gray-700 dark:text-gray-300 text-sm space-y-1">
                  <p><span className="font-medium">Batch:</span> {student.batchName}</p>
                  <p><span className="font-medium">CIC:</span> {student.cicNumber}</p>
                  <p><span className="font-medium">Semester:</span> {markList.find((m) => m.studentId === student._id)?.semesterId || "N/A"}</p>
                </div>
                 */}
              </div>
            </Link>
           
            ))}
          </div>
        )}
      </div>
    </>
  );
};

export default MarkSubmitedStudentsPage;

================
File: frontend/src/pages/admin/SemesterPage.jsx
================
import React, { useState, useEffect } from "react";
import Button from "../../components/Button";
import Input from "../../components/AdminInput";
import { FiPlus, FiSave, FiX, FiLoader, FiEdit, FiTrash2 } from "react-icons/fi";
import Header from "../../components/Header";
import { useParams } from "react-router-dom";
import { useAdminStore } from "../../store/useAdminMngStore";

const SemesterPage = () => {
  const { semesterId, artsId } = useParams();
  const [newSubject, setNewSubject] = useState({ name: "", mark: "", CEmark: "" });
  const [showAddCard, setShowAddCard] = useState(false);
  const [editIndex, setEditIndex] = useState(null);
  const [editedSubject, setEditedSubject] = useState(null);
  const [loading, setLoading] = useState(true);
  const [semSubjects, setSemSubjects] = useState([])

  const { subjects, artSubjects, getSubjects, getArtSubjects, addSubject, deleteSubject, deleteArtSubject, updateSubject, updateArtSubject, getSemesters, semesters, artSems, getArtSems } = useAdminStore();

  useEffect(() => {
    const fetchSubjects = async () => {
      try {
        if(semesterId){
          getSubjects(semesterId)
          getSemesters();

        }else if(artsId){
          getArtSubjects(artsId)
          getArtSems();
        }
        
      } catch (error) {
        console.error("Error fetching subjects:", error);
      } finally {
        setLoading(false);
      }
    };
    fetchSubjects();
  }, [semesterId, artsId, getSubjects, getSemesters, getArtSems]);

  useEffect(() => {
   if(semesterId){
    setSemSubjects(subjects);
   } else if (artsId){
    setSemSubjects(artSubjects)
   }
  }, [subjects, artSubjects])
  

  const handleAddSubject = async () => {
    if (!newSubject.name || !newSubject.mark) return;
    try {
     const id = semesterId || artsId;

      await addSubject(id, {
        name: newSubject.name.trim(),
        mark: newSubject.mark,
        CEmark: newSubject.CEmark === "true",
        isArtSub: Boolean(artsId),
      });

      setNewSubject({ name: "", mark: "", CEmark: "" });
      setShowAddCard(false);
    } catch (error) {
      console.error("Error adding subject:", error);
    }
  };

  const handleDeleteSubject = async (id) => {
    try {
      if (semesterId) {
        await deleteSubject(id);
      }else if(artsId){
      await deleteArtSubject(id);
      }
    } catch (error) {
      console.error("Error deleting subject:", error);
    }
  };

  const handleEditSubject = async (id) => {
    try {
      if (semesterId) {
        await updateSubject(id, editedSubject);
      }else if(artsId){
      await await updateArtSubject(id, editedSubject);
      }
      
      setEditIndex(null);
      setEditedSubject(null);
    } catch (error) {
      console.error("Error updating subject:", error);
    }
  };

  if (loading) {
    return (
      <div className="min-h-screen flex justify-center items-center bg-white dark:bg-gray-900">
        <FiLoader className="animate-spin text-blue-600 w-16 h-16" />
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-white dark:bg-gray-900 text-gray-900 dark:text-white transition-colors duration-300">
      <Header page="Subjects" />
      <div className="container mx-auto py-8 px-4">


          <h1 className="text-xl font-bold mb-6 mt-12">
              Semester:{" "}
              {semesterId
                ? semesters?.find((s) => s._id === semesterId)?.name || "Unknown"
                : artsId
                ? artSems?.find((s) => s._id === artsId)?.name || "Unknown"
                : "Unknown"}
            </h1>



        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
          {/* Add New Subject Card */}
          <div
            className={`flex flex-col justify-between border-2 border-dashed rounded-xl p-6 transition-colors duration-300 cursor-pointer ${
              showAddCard
                ? "border-blue-500 dark:border-blue-400"
                : "border-gray-300 dark:border-gray-600 hover:border-blue-500 dark:hover:border-blue-400"
            }`}
            onClick={() => setShowAddCard(true)}
          >
            {showAddCard ? (
              <div className="flex flex-col gap-4">
                <Input
                  placeholder="Subject name"
                  value={newSubject.name}
                  onChange={(e) => setNewSubject({ ...newSubject, name: e.target.value })}
                />
                <Input
                  placeholder="Subject mark"
                  type="number"
                  value={newSubject.mark}
                  onChange={(e) => setNewSubject({ ...newSubject, mark: e.target.value })}
                />
                <select
                  value={newSubject.CEmark}
                  onChange={(e) => setNewSubject({ ...newSubject, CEmark: e.target.value })}
                  className="input input-bordered p-2 rounded-md"
                >
                  <option value="">CE Mark</option>
                  <option value="true">Yes</option>
                  <option value="false">No</option>
                </select>
                <div className="flex justify-end gap-2">
                  <Button onClick={() => setShowAddCard(false)} className="hover:bg-gray-200 dark:hover:bg-gray-700">
                    <FiX />
                  </Button>
                  <Button onClick={handleAddSubject} className="bg-sky-700 text-white hover:bg-sky-800">
                    <FiSave />
                  </Button>
                </div>
              </div>
            ) : (
              <div className="flex flex-col items-center text-gray-500 dark:text-gray-300">
                <FiPlus className="w-8 h-8 mb-2" />
                <span className="font-medium">Add New Subject</span>
              </div>
            )}
          </div>

          {/* Subject Cards */}
          {semSubjects?.map((subject, index) => (
            <div
              key={subject._id}
              className="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-6 shadow-sm hover:shadow-md transition-shadow duration-300"
            >
              {editIndex === index ? (
                <div className="flex flex-col gap-3">
                  <Input
                    value={editedSubject?.name || ""}
                    onChange={(e) =>
                      setEditedSubject((prev) => ({ ...prev, name: e.target.value }))
                    }
                  />
                  <Input
                    type="number"
                    value={editedSubject?.mark || ""}
                    onChange={(e) =>
                      setEditedSubject((prev) => ({ ...prev, mark: e.target.value }))
                    }
                  />
                  <select
                    value={editedSubject?.CEmark ? "true" : "false"}
                    onChange={(e) =>
                      setEditedSubject((prev) => ({
                        ...prev,
                        CEmark: e.target.value === "true",
                      }))
                    }
                    className="input input-bordered p-2 rounded-md"
                  >
                    <option value="true">CE: Yes</option>
                    <option value="false">CE: No</option>
                  </select>
                  <div className="flex justify-end gap-2">
                    <Button onClick={() => setEditIndex(null)} className="hover:bg-gray-200 dark:hover:bg-gray-700">
                      <FiX />
                    </Button>
                    <Button
                      onClick={() => handleEditSubject(subject._id)}
                      className="bg-green-600 text-white hover:bg-green-700"
                    >
                      <FiSave />
                    </Button>
                  </div>
                </div>
              ) : (
                <div className="space-y-2 flex  justify-between">
                <div>
                    <h3 className="text-sm font-semibold">Name: {subject.name}</h3>
                  <p className="text-slate-400 text-sm font-semibold" >Mark: {subject.mark}</p>
                  <p className="text-slate-400 text-sm font-semibold">CE Mark: {subject.CEmark ? "Yes" : "No"}</p>
                </div>
                  <div className="flex justify-end gap-1 ">
                    <Button
                      onClick={() => {
                        setEditIndex(index);
                        setEditedSubject(subject);
                      }}
                      className="hover:bg-gray-100 dark:hover:bg-gray-700"
                    >
                      <FiEdit />
                    </Button>
                    <Button
                      onClick={() => handleDeleteSubject(subject._id)}
                      className="text-red-600 hover:bg-gray-100 dark:hover:bg-gray-700"
                    >
                      <FiTrash2 />
                    </Button>
                  </div>
                </div>
              )}
            </div>
          ))}
        </div>
      </div>
    </div>
  );
};

export default SemesterPage;

================
File: frontend/src/pages/staff/TeacherHome.jsx
================
import { useEffect } from "react";
import { useStaffStore } from "../../store/useStaffStore";
import { useAuthStore } from "../../store/useAuthStore";
import Card from "../../components/Card";
import { motion } from 'framer-motion';
import { 
  BookOpenText, ClipboardList, DownloadCloud, 
  Users2, Calendar, FileText 
} from "lucide-react";

const downloadsUrl = "https://drive.google.com/drive/folders/1iTo_Ldar0yfnXF_0yUvCXBMfja9KN99w?usp=drive_link";

const TeacherHome = () => {
  const { getBatch, batches } = useStaffStore();
  const { authUser } = useAuthStore();

  useEffect(() => {
    getBatch();
  }, []);

  const containerVariants = {
    hidden: { opacity: 0 },
    visible: { opacity: 1, transition: { staggerChildren: 0.1 } }
  };

  const itemVariants = {
    hidden: { opacity: 0, y: 20 },
    visible: { opacity: 1, y: 0 }
  };

  return (
    <div className="pt-6 pb-20">
      
      {/* Teacher Hero */}
      <motion.div 
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        className="mb-8 p-8 bg-gradient-to-r from-emerald-600 to-teal-600 rounded-3xl shadow-xl text-white relative overflow-hidden"
      >
        <div className="absolute bottom-0 right-0 w-64 h-64 bg-yellow-400 opacity-10 rounded-full blur-3xl transform translate-x-1/4 translate-y-1/4"></div>
        
        <div className="relative z-10">
          <h1 className="text-3xl font-display font-bold mb-2">Hello, {authUser?.name || "Teacher"}</h1>
          <p className="text-emerald-100 max-w-xl">
            You are managing <span className="font-bold bg-white/20 px-2 py-0.5 rounded">{batches.length}</span> classes this semester. 
            Check your academic register below.
          </p>
        </div>
      </motion.div>

      {/* Section Title */}
      <h2 className="text-xl font-bold text-slate-800 dark:text-white mb-4 flex items-center gap-2">
        <Users2 className="text-primary-500" /> My Classes
      </h2>

      {/* Class/Batch Grid */}
      <motion.div 
        variants={containerVariants}
        initial="hidden"
        animate="visible"
        className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8"
      >
        {batches.map((c) => (
          <motion.div key={c._id} variants={itemVariants} className="h-40">
            <Card 
              title={c.name} 
              icon={Users2} 
              route={`/dashboard/teacher/calss-teacher-home/${c._id}`} 
              color="blue"
            />
          </motion.div>
        ))}
      </motion.div>

      {/* Section Title */}
      <h2 className="text-xl font-bold text-slate-800 dark:text-white mb-4 flex items-center gap-2">
        <FileText className="text-primary-500" /> Quick Actions
      </h2>

      {/* Tools Grid */}
      <motion.div 
        variants={containerVariants}
        initial="hidden"
        animate="visible"
        className="grid grid-cols-1 md:grid-cols-4 gap-4"
      >
        <motion.div variants={itemVariants} className="md:col-span-2 h-44">
          <Card 
            title="Assigned Subjects" 
            icon={BookOpenText} 
            route="/dashboard/teacher/assigned-subjects" 
            color="green"
          />
        </motion.div>

        <motion.div variants={itemVariants} className="md:col-span-1 h-44">
          <Card 
            title="Academic Register" 
            icon={ClipboardList} 
            route={`/dashboard/teacher/academic-register`} 
            color="amber"
          />
        </motion.div>

        <motion.div variants={itemVariants} className="md:col-span-1 h-44">
          <Card 
            title="Downloads" 
            icon={DownloadCloud} 
            url={downloadsUrl} 
            color="red"
          />
        </motion.div>
      </motion.div>

    </div>
  );
};

export default TeacherHome;

================
File: frontend/src/pages/student/StudentFees.jsx
================
import { useState, useEffect } from 'react';
import { useFeeStore } from '../../store/feesSrore';
import { useAuthStore } from '../../store/useAuthStore';
import { motion } from 'framer-motion';
import { CreditCard, Check, Clock, AlertTriangle, RefreshCcw } from 'lucide-react';

const StudentFeePortal = () => {
  const { authUser } = useAuthStore();
  const { fetchFeesByStd, isLoading } = useFeeStore();
  const [data, setData] = useState(null);

  useEffect(() => {
    if (authUser) {
      fetchFeesByStd(authUser.batchName, authUser.cicNumber).then(setData);
    }
  }, [authUser]);

  if (isLoading || !data) return (
    <div className="flex items-center justify-center min-h-[60vh]">
      <RefreshCcw className="animate-spin text-primary-500" size={32} />
    </div>
  );

  const { subscription, payments } = data;
  const total = parseFloat(subscription.perYear) || 0;
  const balance = parseFloat(subscription.balance) || 0;
  const paid = total - balance;
  const progress = (paid / total) * 100;

  return (
    <div className="max-w-4xl mx-auto pt-8 pb-20 space-y-10">
      
      {/* 1. Digital Card Section */}
      <div className="relative w-full max-w-md mx-auto perspective-1000 group">
        <motion.div 
          initial={{ rotateY: 90, opacity: 0 }}
          animate={{ rotateY: 0, opacity: 1 }}
          transition={{ duration: 0.8, type: "spring" }}
          className="relative h-64 bg-gradient-to-br from-slate-900 to-slate-800 rounded-3xl shadow-2xl overflow-hidden p-8 flex flex-col justify-between text-white border border-slate-700/50"
        >
          {/* Card Decorations */}
          <div className="absolute top-0 right-0 w-64 h-64 bg-primary-500/20 rounded-full blur-[80px] -mr-16 -mt-16 pointer-events-none" />
          <div className="absolute bottom-0 left-0 w-48 h-48 bg-purple-500/20 rounded-full blur-[60px] -ml-12 -mb-12 pointer-events-none" />
          
          {/* Card Top */}
          <div className="flex justify-between items-start z-10">
            <div className="flex items-center gap-2">
              <div className="w-10 h-10 bg-white/10 backdrop-blur-md rounded-lg flex items-center justify-center">
                <CreditCard className="text-white" size={20} />
              </div>
              <span className="font-display font-bold tracking-widest text-lg">UIA PAY</span>
            </div>
            <span className="font-mono text-sm opacity-70">{authUser?.cicNumber}</span>
          </div>

          {/* Card Body (Chip) */}
          <div className="z-10 mt-4">
            <div className="w-12 h-9 border border-yellow-500/50 bg-gradient-to-br from-yellow-200 to-yellow-600 rounded-md opacity-80" />
          </div>

          {/* Card Bottom */}
          <div className="z-10">
            <p className="text-xs text-slate-300 uppercase tracking-wider mb-1">Student Balance Due</p>
            <div className="flex justify-between items-end">
              <h2 className="text-4xl font-mono font-bold tracking-tight">
                ‚Çπ{balance.toLocaleString()}
              </h2>
              <div className="text-right">
                <p className="text-xs text-slate-400">Card Holder</p>
                <p className="font-medium uppercase tracking-wide">{authUser?.name}</p>
              </div>
            </div>
          </div>
        </motion.div>
      </div>

      {/* 2. Progress Bar */}
      <div className="bg-white dark:bg-slate-800 p-6 rounded-3xl shadow-sm border border-slate-200 dark:border-slate-700">
        <div className="flex justify-between items-end mb-3">
          <div>
            <p className="text-sm text-slate-500 dark:text-slate-400 font-medium">Payment Progress</p>
            <h3 className="text-2xl font-bold text-slate-800 dark:text-white">
              {progress.toFixed(0)}% <span className="text-base font-normal text-slate-400">Complete</span>
            </h3>
          </div>
          <div className="text-right">
            <p className="text-sm text-emerald-600 font-bold">Paid: ‚Çπ{paid.toLocaleString()}</p>
            <p className="text-xs text-slate-400">Total: ‚Çπ{total.toLocaleString()}</p>
          </div>
        </div>
        <div className="w-full h-4 bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden">
          <motion.div 
            initial={{ width: 0 }}
            animate={{ width: `${progress}%` }}
            transition={{ duration: 1.5, ease: "easeOut" }}
            className={`h-full rounded-full bg-gradient-to-r ${progress === 100 ? "from-emerald-500 to-teal-500" : "from-primary-500 to-indigo-500"}`}
          />
        </div>
      </div>

      {/* 3. Transaction Timeline */}
      <div>
        <h3 className="text-xl font-bold text-slate-800 dark:text-white mb-6 px-2">Payment History</h3>
        <div className="space-y-4">
          {Object.entries(payments).map(([month, amount], index) => {
            const isPaid = !!amount;
            return (
              <motion.div 
                key={month}
                initial={{ opacity: 0, x: -20 }}
                animate={{ opacity: 1, x: 0 }}
                transition={{ delay: index * 0.05 }}
                className={`flex items-center justify-between p-4 rounded-2xl border transition-all ${
                  isPaid 
                    ? "bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700" 
                    : "bg-slate-50 dark:bg-slate-900 border-dashed border-slate-300 dark:border-slate-700 opacity-70"
                }`}
              >
                <div className="flex items-center gap-4">
                  <div className={`w-10 h-10 rounded-full flex items-center justify-center ${
                    isPaid ? "bg-emerald-100 text-emerald-600" : "bg-amber-100 text-amber-600"
                  }`}>
                    {isPaid ? <Check size={18} /> : <Clock size={18} />}
                  </div>
                  <div>
                    <p className="font-bold text-slate-800 dark:text-white capitalize">{month.replace(/_/g, ' ').toLowerCase()}</p>
                    <p className="text-xs text-slate-500">{isPaid ? "Payment received" : "Payment pending"}</p>
                  </div>
                </div>
                <div className="text-right">
                  <span className={`font-mono font-bold ${isPaid ? "text-slate-800 dark:text-white" : "text-slate-400"}`}>
                    {isPaid ? `‚Çπ${amount}` : "-"}
                  </span>
                </div>
              </motion.div>
            );
          })}
        </div>
      </div>

    </div>
  );
};

export default StudentFeePortal;

================
File: frontend/src/pages/student/StudentHome.jsx
================
import { useEffect } from "react";
import { useStaffStore } from "../../store/useStaffStore";
import { useAuthStore } from "../../store/useAuthStore";
import Card from "../../components/Card";
import { motion } from 'framer-motion';
import { 
  Award, BookCopyIcon, BookUserIcon, ClipboardList, 
  DownloadCloud, ListChecks, LucideHandCoins, 
  BookMarked, GraduationCap, Calendar 
} from "lucide-react";

const downloadsUrl = "https://drive.google.com/drive/folders/1iTo_Ldar0yfnXF_0yUvCXBMfja9KN99w?usp=drive_link";

const StudentHome = () => {
  const { batch, getStudentBatch } = useStaffStore();
  const { authUser } = useAuthStore();

  useEffect(() => {
    getStudentBatch();
  }, [getStudentBatch]);

  // Bento Grid Configuration
  // colSpan: 1 = standard square, 2 = wide rectangle
  const bentoItems = [
    { 
      title: "Academic Register", 
      icon: ClipboardList, 
      route: "/dashboard/student/academic-register",
      color: "blue",
      colSpan: "md:col-span-2", // Wide Card
      description: "View attendance & leave status"
    },
    { 
      title: "Mark Lists", 
      icon: ListChecks, 
      route: "/dashboard/student/semester-list",
      color: "green",
      colSpan: "md:col-span-1",
      description: "Check exam results"
    },
    { 
      title: "Fees (Ishthiraq)", 
      icon: LucideHandCoins, 
      route: "/dashboard/student/ishthiraq",
      color: "amber",
      colSpan: "md:col-span-1",
      description: "Payment history"
    },
    { 
      title: "My Achievements", 
      icon: Award, 
      route: "/dashboard/student/achievement",
      color: "red",
      colSpan: "md:col-span-1",
      description: "Awards & certificates"
    },
    { 
      title: "Reading Progress", 
      icon: BookUserIcon, 
      route: "/dashboard/student/reading-progress",
      color: "blue",
      colSpan: "md:col-span-2", // Wide Card
      description: "Track books & library logs"
    },
    { 
      title: "Subjects", 
      icon: BookCopyIcon, 
      route: "/dashboard/student/subjects",
      color: "green",
      colSpan: "md:col-span-1",
      description: "Current semester syllabus"
    },
    { 
      title: "Downloads", 
      icon: DownloadCloud, 
      url: downloadsUrl,
      color: "amber",
      colSpan: "md:col-span-1",
      description: "Study materials"
    }
  ];

  // Internal Marks logic
  if(batch?.IRmarkList) {
    bentoItems.push({ 
      title: "Internal Marks", 
      icon: BookMarked, 
      url: batch.IRmarkList, 
      color: "red",
      colSpan: "md:col-span-1" 
    });
  }
  if(batch?.CEmarkList) {
    bentoItems.push({ 
      title: "CE Marks", 
      icon: BookMarked, 
      url: batch.CEmarkList, 
      color: "blue",
      colSpan: "md:col-span-1" 
    });
  }

  const containerVariants = {
    hidden: { opacity: 0 },
    visible: { opacity: 1, transition: { staggerChildren: 0.1 } }
  };

  const itemVariants = {
    hidden: { opacity: 0, y: 20 },
    visible: { opacity: 1, y: 0 }
  };

  return (
    <div className="pt-6 pb-20">
      
      {/* Hero Welcome Card */}
      <motion.div 
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        className="mb-8 p-8 bg-gradient-to-r from-primary-600 to-indigo-600 rounded-3xl shadow-xl text-white relative overflow-hidden"
      >
        <div className="absolute top-0 right-0 w-64 h-64 bg-white opacity-10 rounded-full blur-3xl transform translate-x-1/3 -translate-y-1/3"></div>
        
        <div className="relative z-10 flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
          <div>
            <h1 className="text-3xl font-display font-bold mb-2">Welcome back, {authUser?.name?.split(' ')[0]}!</h1>
            <p className="text-blue-100 flex items-center gap-2">
              <GraduationCap size={18} />
              {batch?.name || "Loading Batch..."} &bull; {authUser?.cicNumber || "ID Loading..."}
            </p>
          </div>
          <div className="bg-white/20 backdrop-blur-md px-4 py-2 rounded-xl border border-white/30 flex items-center gap-2">
            <Calendar size={18} />
            <span className="font-medium text-sm">{new Date().toLocaleDateString('en-US', { weekday: 'long', day: 'numeric', month: 'long' })}</span>
          </div>
        </div>
      </motion.div>

      {/* Bento Grid */}
      <motion.div 
        variants={containerVariants}
        initial="hidden"
        animate="visible"
        className="grid grid-cols-1 md:grid-cols-4 gap-4 auto-rows-[180px]"
      >
        {bentoItems.map((item, index) => (
          <motion.div
            key={index}
            variants={itemVariants}
            className={`${item.colSpan} h-full`}
          >
            <Card 
              title={item.title}
              icon={item.icon}
              color={item.color}
              route={item.route}
              url={item.url}
            />
          </motion.div>
        ))}
      </motion.div>
    </div>
  );
};

export default StudentHome;

================
File: frontend/src/store/feesSrore.js
================
import { create } from 'zustand';
// Note: Ensure you have an 'axiosInstance' configured elsewhere in your project.
// For example, in 'src/lib/axios.js'
import { axiosInstance } from '../lib/axios'; 
// import toast from "react-hot-toast"; // Uncomment if you use react-hot-toast

export const useFeeStore = create((set, get) => ({
    fees: {}, // Cache for fetched data, e.g., { 'BATCH 09': [...] }
    isLoading: false,
    error: null,
    selectedBatch: 'BATCH 09', // Default selected batch

    // --- Constants ---
    monthNames: {
        'SHAW': 'Shawwal', 'DUL Q': "Dhu al-Qi'dah", 'DUL H': 'Dhu al-Hijjah', 
        'MUH': 'Muharram', 'SAF': 'Safar', 'RA A': "Rabi' al-Awwal", 
        'RA AK': "Rabi' al-Akhir", 'JUM U': 'Jumada al-Ula', 'JUM A': 'Jumada al-Akhirah', 
        'RAJ': 'Rajab', 'SHAH': "Sha'ban", 'RAML': 'Ramadan'
    },
    batchNames: ['BATCH 09', 'BATCH 10', 'BATCH 11', 'BATCH 12', 'BATCH 13', 'BATCH 14'],
  batches : {
  '09': 'BATCH 09',
  '10': 'BATCH 10',
  '11': 'BATCH 11',
  '12': 'BATCH 12',
  '13': 'BATCH 13',
  '14': 'BATCH 14',
},

    // --- Actions ---
    setSelectedBatch: (batchName) => {
        set({ selectedBatch: batchName });
    },

    fetchDashboardAnalytics: async () => {
        set({ isLoading: true, error: null });
        try {
            const response = await axiosInstance.get('/fees/dashboard');
            const data = response.data;
            set({ isLoading: false });
            return data; // Return the fetched analytics data
        } catch (error) {
            console.error("Failed to fetch dashboard analytics:", error);
            const errorMessage = error.response?.data?.message || 'Failed to fetch dashboard analytics.';   
            set({ error: errorMessage, isLoading: false });
            return null;
        }
    },


    fetchFees: async (batchName) => {
        set({ isLoading: true, error: null });
        try {
            const response = await axiosInstance.get(`/fees?batch_name=${batchName}`);
            const data = response.data;

            set(state => ({
                fees: { ...state.fees, [batchName]: data },
                isLoading: false
            }));
        } catch (error) {
            console.error("Failed to fetch fees:", error);
            const errorMessage = error.response?.data?.message || 'Failed to fetch student data.';
            set({ error: errorMessage, isLoading: false });
            // toast.error(errorMessage); // Uncomment for user notifications
        }
    },

fetchFeesByStd: async (batchName, cicNumber) => {
    set({ isLoading: true, error: null });
    try {
      console.log("Fetching fees for batch:", batchName, "CIC Number:", cicNumber);

      // 1. Add simple validation
      if (!batchName) {
        throw new Error('Batch name is required to fetch student data.');
      }
      if (!cicNumber) {
        throw new Error('CIC number is required to fetch student data.');
      }

      // 2. Remove all the complex mapping logic (match, padStart, get().batches)
      //    Just use the batchName directly.
      const response = await axiosInstance.get(
        `/fees/std?batch_name=${batchName}&cicNumber=${cicNumber}`
      );
      
      console.log("API response:", response);
      const data = response.data;

      set({ isLoading: false }); 
      return data; 

    } catch (error) {
      console.error("Failed to fetch student fee:", error);
      const errorMessage = error.response?.data?.message || error.message || 'Failed to fetch student fee.';
      set({ error: errorMessage, isLoading: false });
      
      // This part is perfect, do not change it
      throw new Error(errorMessage);
    }
  },

    /**
     * Updates a student's entire fee record.
     * Uses an optimistic update approach for a better user experience.
     */
    updateFee: async (cicNumber, updatedStudentData) => {
      console.log('updated', updatedStudentData);
      
        const batchName = get().selectedBatch;
        const originalData = [...(get().fees[batchName] || [])];

        // 1. Optimistic UI Update: Update the state immediately.
        set(state => {
            const updatedBatchData = (state.fees[batchName] || []).map(student =>
                student.cicNumber === cicNumber ? updatedStudentData : student
            );
            return {
                fees: { ...state.fees, [batchName]: updatedBatchData }
            };
        });

        // 2. API Call: Persist the changes to the backend.
        try {
            await axiosInstance.put(`/fees/${cicNumber}?batch_name=${batchName}`, updatedStudentData);
            // toast.success('Student updated successfully!'); // Uncomment for user notifications
        } catch (error) {
            console.error("Failed to update student:", error);
            const errorMessage = error.response?.data?.message || 'Failed to save changes.';
            
            // 3. Revert on Failure: If the API call fails, revert the UI to its original state.
            set(state => ({
                error: errorMessage,
                fees: { ...state.fees, [batchName]: originalData }
            }));
            // toast.error(errorMessage); // Uncomment for user notifications
        }
    },
}));

================
File: frontend/src/store/studentStore.js
================
import { create } from "zustand";
import toast from "react-hot-toast";
import { axiosInstance } from "../lib/axios";
import { useAuthStore } from "./useAuthStore";


export const useStudentStore = create((set, get) => ({
  students: [],
  batchStudents: [],
  studentsInactive: [],
  student: {},
  semSubjects: [],
  feeStatus: [],
  isLoading: false,
  responseMessage: { text: "", type: "" },
  formData: { 
    studentName: "",
    selectedBatch: "",
    rollNumber: "",
    gender: "",
    studentId: "",
  },

  updateField: (name, value) =>
    set((state) => ({ formData: { ...state.formData, [name]: value } })),

  setResponseMessage: (message) => set({ responseMessage: message }),

  resetForm: () =>
    set({
      formData: {
        studentName: "",
        selectedBatch: "",
        rollNumber: "",
        gender: "",
        studentId: ""
      },
    }),

    registerStudent: async (data) => {
      try {
        const response = await axiosInstance.post("/users/add", data, {
          headers: { "Content-Type": "application/json" },
        });
        
        toast.success("Account created successfully");
    
      } catch (error) {
        console.error(error.response?.data?.message || "An error occurred");
        toast.error(error.response?.data?.message || "An error occurred");
      }
    },
    
    getStudents: async () => {
      set({ isLoading: true }); 
    
      try {
        const res = await axiosInstance.get("/users");
    
        if (res.data && res.data.students) {
          set({ students: res.data.students });
        } else {
          console.warn("Unexpected response format:", res.data);
        }
      } catch (error) {
        console.error("Error fetching students:", error);
      } finally {
        set({ isLoading: false });
      }
    },
    getBatchStudents: async (batchId) => {
      set({ isLoading: true }); 
    
      try {
        const res = await axiosInstance.get(`/users/${batchId}`);
    
        if (res.data && res.data.students) {

          set({ batchStudents: res.data.students });
        } else {
          console.warn("Unexpected response format:", res.data);
        }
      } catch (error) {
        console.error("Error fetching students:", error);
      } finally {
        set({ isLoading: false });
      }
    },

    getStudent: async (studentId) => {
      set({ isLoading: true }); 
     try {
      const res = await axiosInstance.get(`/users/student/${studentId}`)
      set({student: res.data})
      
     } catch (error) {
      console.error("Error fetching student:", error);
    } finally {
      set({ isLoading: false });
    }

    },
    
    editStudent: async (data, studentId) => {
      try {
        const response = await axiosInstance.put(`/users/student/edit/${studentId}`, data);
        
        toast.success("Student Details updated successfully");
      } catch (error) {
        console.error(error.response?.data?.message || "An error occurred");
        toast.error(error.response?.data?.message || "An error occurred");
      }
    },

    deleteStudent: async (studentId) => {
      try {
        const response = await axiosInstance.delete(`/users/student/delete/${studentId}`);
        if (response.status === 200) {
          toast.success("Student deleted successfully");

          set((state) => ({
            students: state.students.filter(student => student._id !== studentId)
          }));

          return true;
        } else {
          toast.error("Failed to delete the student");
          return false;
        }
      } catch (error) {
        console.error(error);
        toast.error("An error occurred while deleting the student");
        return false;
      }
    },

    stdStatusChange: async (studentId, isDeleted) => {
      try {
        const res = await axiosInstance.patch(`/users/student/status/${studentId}`);
    
       if(!isDeleted){
        set((state) => ({
          students: state.students.filter((student) => student._id !== studentId),
        }));
        toast.success("Student Deleted successfully");
       } else {
        set((state) => ({
          studentsInactive: state.studentsInactive.filter((student) => student._id !== studentId),
        }));
        toast.success("Student Restored successfully");
      }
      } catch (error) {
        console.error(error);
        toast.error("An error occurred");
      }
    },    

    getInactiveStudents: async () => {
      set({ isLoading: true }); 
    
      try {
        const res = await axiosInstance.get("/users/inactive-std");
    
        if (res.data && res.data.students) {
          set({ studentsInactive: res.data.students });
        } else {
          console.warn("Unexpected response format:", res.data);
        }
      } catch (error) {
        console.error("Error fetching students:", error);
      } finally {
        set({ isLoading: false });
      }
    },


    getCurruntSemSubjects: async () => {
       const authUser = useAuthStore.getState().authUser;
      set({isLoading: true});
      try {
        const res = await axiosInstance.get(`/mng/currunt-sem-subjects/${authUser.batchId}`);
        set({semSubjects: res.data})
        
      } catch (error) {
        console.error("Error in getCurruntSemSubjects:", error);
      } finally {
        set({ isLoading: false });
      }
    },
   
    

    
}));

================
File: frontend/src/store/useAdminMngStore.js
================
import { create } from "zustand";
import { axiosInstance } from "../lib/axios.js";
import toast from "react-hot-toast";


export const useAdminStore = create((set, get) => ({
  teachers: [],
  batches: [],
  subjects: [],
  artSubjects: [],
  semesters: [],
  artSems: [],
  isLoading: false,

  getTeachers: async () => {
    set({isLoading: true});
    try {
        const res = await axiosInstance.get("/users/teachers");
        
        set({teachers: res.data.teachers});
    } catch (error) {
      console.log("Error in getTeachers:", error);
    }finally{
    set({isLoading: false});

    }
  },
  getSemesters: async () => {
    set({isLoading: true});
    try {
        const res = await axiosInstance.get("/mng/semester");
        
        set({semesters: res.data});
    } catch (error) {
      console.log("Error in getSemesters:", error);
    }finally{
    set({isLoading: false});

    }
  },
  getArtSems: async () => {
    set({isLoading: true});
    try {
        const res = await axiosInstance.get("/mng/art-sem");
        
        set({artSems: res.data});
    } catch (error) {
      console.log("Error in getArtSems:", error);
    }finally{
    set({isLoading: false});

    }
  },

  deleteSemester: async (semesterId) => {
    try {
      const res = await axiosInstance.delete(`/mng/semester/delete/${semesterId}`);
      if (res.status === 200) {
        toast.success("Semester deleted successfully");
        set((state) => ({
          semesters: state.semesters.filter(semester => semester._id !== semesterId)
        }));
      } else {
        toast.error("Failed to delete the Semester");
        return false;
      }
    } catch (error) {
      console.error(error);
      toast.error("An error occurred while deleting Semester");
      return false;
    }
  },
  deleteArtSems: async (artSemId) => {
    try {
      const res = await axiosInstance.delete(`/mng/art-sem/delete/${artSemId}`);
      if (res.status === 200) {
        toast.success("ArtSemsem deleted successfully");
        set((state) => ({
          artSems: state.artSems.filter(artSem => artSem._id !== artSemId)
        }));
      } else {
        toast.error("Failed to delete the artSem");
        return false;
      }
    } catch (error) {
      console.error(error);
      toast.error("An error occurred while deleting artSem");
      return false;
    }
  },
  
  updateSemester: async (semesterId, name) => {
    try {
      const res = await axiosInstance.put(`/mng/semester/update/${semesterId}`, {name});
      if (res.status === 200) {
        toast.success("Semester updated successfully");
        set((state) => ({
          semesters: state.semesters.map((semester) =>
            semester._id === semesterId
              ? { ...semester, name }
              : semester
          )
        }));
        
      } else {
        toast.error("Failed to update Semester");
        return false;
      }
    } catch (error) {
      console.error(error);
      toast.error("An error occurred while updating the Semester");
      return false;
    }
  },
  updateArtSem: async (artSemId, name) => {
    try {
      const res = await axiosInstance.put(`/mng/art-sem/update/${artSemId}`, {name});
      if (res.status === 200) {
        toast.success("artSem updated successfully");
        set((state) => ({
          artSems: state.artSems.map((artSem) =>
            artSem._id === artSemId
              ? { ...artSem, name }
              : artSem
          )
        }));
        
      } else {
        toast.error("Failed to update artSem");
        return false;
      }
    } catch (error) {
      console.error(error);
      toast.error("An error occurred while updating the artSem");
      return false;
    }
  },
  
  deleteBatch: async (batchId) => {
    try {
      const res = await axiosInstance.delete(`/mng/batch/delete/${batchId}`);
      if (res.status === 200) {
        toast.success("Batch deleted successfully");
        set((state) => ({
          batches: state.batches.filter(batch => batch._id !== batchId)
        }));
      } else {
        toast.error("Failed to delete the Batch");
        return false;
      }
    } catch (error) {
      console.error(error);
      toast.error("An error occurred while deleting the Batch");
      return false;
    }
  },
  
  updateBatch: async (batchId, name) => {
    try {
      
      const res = await axiosInstance.put(`/mng/batch/update/${batchId}`, {name});
      if (res.status === 200) {
        toast.success("Batch updated successfully");
        set((state) => ({
          batches: state.batches.map((batch) =>
            batch._id === batchId
              ? { ...batch, name }
              : batch
          )
        }));
        
      } else {
        toast.error("Failed to update the Batch");
        return false;
      }
    } catch (error) {
      console.error(error);
      toast.error("An error occurred while updating the Batch");
      return false;
    }
  },
  

  getSubjects: async (semesterId) => {
    
    set({isLoading: true});
    try {
        const res = await axiosInstance.get(`/mng/subjects/${semesterId}`);
        
        set({subjects: res.data});
        return response.data;
    } catch (error) {
      console.log("Error in getSubjects:", error);
    }finally{
    set({isLoading: false});

    }
  },
  getArtSubjects: async (semesterId) => {
    
    set({isLoading: true});
    try {
        const res = await axiosInstance.get(`/mng/art-subjects/${semesterId}`);
        
        set({artSubjects: res.data});
        return response.data;
    } catch (error) {
      console.log("Error in getSubjects:", error);
    }finally{
    set({isLoading: false});
    }
  },

  addSubject: async (semesterId, details) => {
    try {
      const response = await axiosInstance.post(`mng/subjects/${semesterId}`, details);
  console.log(response);
  
      if (response.status === 201 || response.status === 200) {
        toast.success("Subject added successfully");
  
        const newSubject = response.data.newSubject 

        if (details.isArtSub) {
            set((state) => ({ artSubjects: [...state.artSubjects, newSubject] }));
          } else {
            set((state) => ({ subjects: [...state.subjects, newSubject] }));
          }

       
  
        return true;
      } else {
        toast.error("Failed to add subject");
        return false;
      }
    } catch (error) {
      console.error("Error adding subject:", error);
      toast.error("An error occurred while adding the subject");
      return false;
    }
  },
  
  deleteSubject: async (subjectId) => {
    try {
      const res = await axiosInstance.delete(`/mng/subject/delete/${subjectId}`);
      if (res.status === 200) {
        toast.success("Subject deleted successfully");
        set((state) => ({
          subjects: state.subjects.filter(subject => subject._id !== subjectId )
        }));
      } else {
        toast.error("Failed to delete the Subject");
        return false;
      }
    } catch (error) {
      console.error(error);
      toast.error("An error occurred while deleting the Subject");
      return false;
    }
  },
  
  updateSubject: async (subjectId, details) => {
    try {
      const res = await axiosInstance.put(`/mng/subject/update/${subjectId}`, details);
      if (res.status === 200) {
        toast.success("Subject updated successfully");
  
        set((state) => ({
          subjects: state.subjects.map((subject) =>
            subject._id === subjectId
              ? { ...subject, ...details }
              : subject
          )
        }));
  
      } else {
        toast.error("Failed to update the subject");
        return false;
      }
    } catch (error) {
      console.error(error);
      toast.error("An error occurred while updating the Subject");
      return false;
    }
  },
  deleteArtSubject: async (subjectId) => {
    try {
      const res = await axiosInstance.delete(`/mng/art-subject/delete/${subjectId}`);
      if (res.status === 200) {
        toast.success("Subject deleted successfully");
        set((state) => ({
          subjects: state.subjects.filter(subject => subject._id !== subjectId )
        }));
      } else {
        toast.error("Failed to delete the Subject");
        return false;
      }
    } catch (error) {
      console.error(error);
      toast.error("An error occurred while deleting the Subject");
      return false;
    }
  },
  
  updateArtSubject: async (subjectId, details) => {
    try {
      const res = await axiosInstance.put(`/mng/art-subject/update/${subjectId}`, details);
      if (res.status === 200) {
        toast.success("Subject updated successfully");
  
        set((state) => ({
          subjects: state.subjects.map((subject) =>
            subject._id === subjectId
              ? { ...subject, ...details }
              : subject
          )
        }));
  
      } else {
        toast.error("Failed to update the subject");
        return false;
      }
    } catch (error) {
      console.error(error);
      toast.error("An error occurred while updating the Subject");
      return false;
    }
  },
  
  getBatches: async () => {
    set({isLoading: true});
    try {
        const res = await axiosInstance.get("/mng/batches");
        
        set({batches: res.data});
    } catch (error) {
      console.log("Error in getBatches:", error);
    }finally{
    set({isLoading: false});
    }
  },
  addBatchCemarklink: async (link, batchId) => {
    try {
      const res = await axiosInstance.patch("/mng/update-ce-link", {
        batchId,
        CEmarkListLink: link,
      });
      return res.data; // Optional: return response if needed
    } catch (error) {
      console.error("Error updating CE mark list:", error);
      throw error;
    }
  },
  addBatchIRmarklink: async (link, batchId) => {
    try {
      const res = await axiosInstance.patch("/mng/update-ir-link", {
        batchId,
        IRmarkListLink: link,
      });
      return res.data; 
    } catch (error) {
      console.error("Error updating CE mark list:", error);
      throw error;
    }
  },
  addAcademicStatuslink: async (link, batchId, item) => {
    try {
      const res = await axiosInstance.patch("/mng/update-academic-status-link", {
        batchId,
        [item]: link,
      });
      return res.data; 
    } catch (error) {
      console.error("Error updating Academic Status:", error);
      throw error;
    }
  },
  deleteAcademicStatuslink: async (batchId, item) => {
    try {
      const res = await axiosInstance.patch("/mng/delete-academic-status-link", {
        batchId,
        item
      });
      set((state) => ({
  batches: state.batches.map(batch => {
    if (batch._id === batchId) {
      return {
        ...batch,
        [item]: null, 
      };
    }
    return batch;
  })
}));
      return res.data; 
    } catch (error) {
      console.error("Error deteting Academic Status:", error);
      throw error;
    }
  },
  

  updateSelectedTab: async (selectedTab, newItemName) => {
    set({ isLoading: true });
    try {
      let endpoint;
      
       if (selectedTab === "semester Subjects"){
        endpoint = "semester"
      }else if (selectedTab === "arts Subjects"){
        endpoint = "art-sem"
      }else if (selectedTab === "batches"){
        endpoint = "batches"
      }
      const res = await axiosInstance.post(`/mng/${endpoint}`, {
        name: newItemName.trim(),
      });


      const { batches, subjects, teachers, semesters, artSems } = get();

      if (selectedTab === "batches") {
        set({ batches: [...batches, res.data.newBatch] });
      } else if (selectedTab === "current Semester") {
        set({ semesters: [...semesters, res.data.newSemester] });
      } else if (selectedTab === "semester Subjects") {
        set({ semesters: [...semesters, res.data.newSemester] });
      }  else if (selectedTab === "arts Subjects") {
        set({ artSems: [...artSems, res.data.newArtSem] });
      } else if (selectedTab === "teachers") {
        set({ teachers: [...teachers, res.data.newTeacher] }); 
      }

      toast.success(`${newItemName} added successfully!`);
    } catch (error) {
      console.error("Error adding item:", error);
      toast.error("Failed to add item.");
    } finally {
      set({ isLoading: false });
    }
  }

}));

================
File: frontend/src/store/useAuthStore.js
================
import { create } from "zustand";
import { axiosInstance } from "../lib/axios.js";
import toast from "react-hot-toast";


export const useAuthStore = create((set, get) => ({
  authUser: null,
  isSigningUp: false,
  isLoggingIn: false,
  isUpdatingProfile: false,
  isCheckingAuth: true,

  checkAuth: async () => {
    try {
      const res = await axiosInstance.get("/auth/check");
      set({ authUser: res.data });
      console.log(res.data);
      
    } catch (error) {
      console.log("Error in checkAuth:", error);
      set({ authUser: null });
    } finally {
      set({ isCheckingAuth: false });
    }
  },

  signup: async (data) => {
    set({ isSigningUp: true });
    try {
      const res = await axiosInstance.post("/auth/signup", data);
      set({ authUser: res.data });
      toast.success("Account created successfully");
    } catch (error) {
      toast.error(error.response.data.message);
    } finally {
      set({ isSigningUp: false });
    }
  },

  login: async (data) => {
    set({ isLoggingIn: true });
    try {
      const res = await axiosInstance.post("/auth/login", data);
      
      set({ authUser: res.data });
      toast.success("Logged in successfully");

    } catch (error) {
      toast.error(error.response.data.message);
    } finally {
      set({ isLoggingIn: false });
    }
  },

  logout: async () => {
    try {
      await axiosInstance.post("/auth/logout");
      set({ authUser: null });
      toast.success("Logged out successfully");
    } catch (error) {
      toast.error(error.response.data.message);
    }
  },

 changePassword: async (currentPassword, newPassword ) => {
  try {
    const user = get().authUser;

    const data = {
      ...(user.role === "student" && { studentId: user._id }),
      ...(user.role === "teacher" && { teacherId: user._id }),
      currentPassword,
      newPassword,
    };

    const res = await axiosInstance.patch("/users/change-password", data);
    toast.success( res.message || "Password updated successfully");
  } catch (error) {
    console.error(error);
    toast.error(error.response.data.message || "Failed to update password");
  }
}


  // updateProfile: async (data) => {
  //   set({ isUpdatingProfile: true });
  //   try {
  //     const res = await axiosInstance.put("/auth/update-profile", data);
  //     set({ authUser: res.data });
  //     toast.success("Profile updated successfully");
  //   } catch (error) {
  //     console.log("error in update profile:", error);
  //     toast.error(error.response.data.message);
  //   } finally {
  //     set({ isUpdatingProfile: false });
  //   }
  // },

}));

================
File: .gitignore
================
# Logs
logs/
**/logs/
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
pnpm-debug.log*
lerna-debug.log*

# Dependency directories
frontend/node_modules/
backend/node_modules/


# Build output
dist/
dist-ssr/
build/

# Misc files
*.local

# Environment variables
.env
.env.*
frontend/.env
backend/.env
backend/src/.env


# Editor directories and files
.vscode/*
!.vscode/extensions.json
.idea/
.DS_Store
*.suo
*.ntvs*
*.njsproj
*.sln
*.sw?

================
File: backend/src/models/batch.model.js
================
import mongoose from "mongoose";

const batchSchema = new mongoose.Schema(
  {
    name: {
      type: String,
      required: true,
      trim: true,
    },
    classTeacher: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "Staff",
    },
    classLeader: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "Student",
    },
    classLeader2: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "Student",
    },
    currentSemester: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "Semester",
    },
    currentArtSemester: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "ArtSemester",
    },
    students: [
      {
        type: mongoose.Schema.Types.ObjectId,
        ref: "Student",
      },
    ],
    attendance: {
      type: Object,
      default: {},
    },    
    CEmarkList: {
      type: String,
      default: null,
    },
    IRmarkList: {
      type: String,
      default: null,
    },
    stdAttendanceRegister: {
      type: String,
      default: null,
    },
    staffAttendanceRegister: {
      type: String,
      default: null,
    },
    subjectStatus: {
      type: String,
      default: null,
    },
    ceStatus: {
      type: String,
      default: null,
    },
    ishthiraq: {
      type: String,
      default: null,
    },
  },
  { timestamps: true }
);

export default mongoose.model("Batch", batchSchema);

================
File: backend/src/routes/user.route.js
================
import express from "express";
import { updateUser, addUser, getTeachers, getStudents, getStudent, editStudent, deleteStudent, editTeacher, deleteTeacher, getTeacher, changeStdStatus, getStudentsInactive, updatePassword } from "../controllers/userController.js";

const router = express.Router();


router.get("/", getStudents);

router.get("/inactive-std", getStudentsInactive);

router.get("/teachers", getTeachers);

router.put("/teacher/update/:teacherId", editTeacher)

router.delete("/teacher/delete/:teacherId", deleteTeacher)

router.get("/teacher/:teacherId", getTeacher);

router.get("/student/:studentId", getStudent);

router.put("/student/edit/:studentId", editStudent);

router.post("/add", addUser);

router.put("/edit", updateUser); 

router.delete("/student/delete/:userId", deleteStudent); 

router.patch("/student/status/:userId", changeStdStatus); 

router.patch("/change-password", updatePassword)

router.get("/:batchId", getStudents);







export default router;

================
File: frontend/src/App.jsx
================
import { Toaster } from "react-hot-toast";
import AppRoutes from "./routes/AppRoutes";
import { useAuthStore } from "./store/useAuthStore";
import { useThemeStore } from "./store/useThemeStore";
import { useEffect, useState } from "react";
import InstallPrompt from "./components/InstallPrompt";

function App() {
  const { authUser, checkAuth, isCheckingAuth } = useAuthStore();
  const theme = useThemeStore((state) => state.theme);
  const initializeTheme = useThemeStore((state) => state.initializeTheme);

  const [deferredPrompt, setDeferredPrompt] = useState(null);
  const [showInstallPrompt, setShowInstallPrompt] = useState(false);

  useEffect(() => {
    checkAuth();
    initializeTheme();
  }, [checkAuth, initializeTheme]);

  useEffect(() => {
    const handler = (e) => {
      e.preventDefault();            
      setDeferredPrompt(e);         
      setShowInstallPrompt(true);  
    };

    window.addEventListener("beforeinstallprompt", handler);
    return () => window.removeEventListener("beforeinstallprompt", handler);
  }, []);

  if (isCheckingAuth) {
    return (
        <div className="flex items-center justify-center h-screen relative bg-gray-900">
          <div className="animate-spin rounded-full h-20 w-20 border-t-4 border-b-4 border-gray-900 dark:border-gray-100" />
          <img
            src="/web-app-manifest-192x192.png"
            alt="Logo"
            className="absolute h-12 w-12"
          />
        </div>
      );

  }

  return (
    <div data-theme={theme}>
      <AppRoutes />
      <Toaster />

      {showInstallPrompt && deferredPrompt && (
        <InstallPrompt
          deferredPrompt={deferredPrompt}
          onClose={() => setShowInstallPrompt(false)}
        />
      )}
    </div>
  );
}

export default App;

================
File: frontend/src/pages/staff/CalssTeacherHome.jsx
================
import Header from "../../components/Header";
import Card from "../../components/Card";
import { motion } from 'framer-motion';
import { Award, Book, ClipboardCheck, HandCoins, ListTodo, Medal, Users } from "lucide-react";
import { useParams } from "react-router-dom";
import { useEffect } from "react";
import { useStaffStore } from "../../store/useStaffStore";

const CalssTeacherHome = () => {
  const { batchId } = useParams();
    const {batch, getBatchById } = useStaffStore()
    useEffect(() => {
     if(batchId){
      getBatchById(batchId)
     }
    }, [getBatchById, batchId])
    
    const cards = [
  
      { title: "Students' Details", icon: Users, route: `/dashboard/teacher/batch-students/${batchId}` },  
      { title: "Semester Exam Results", icon: Award, route: `/dashboard/teacher/batches/marklist/${batchId}` },
      { title: "Achivements", icon: Medal, route: `/dashboard/teacher/batches/achievements/${batchId}` },
      { title: "Reading Progress", icon: Book, route: `/dashboard/teacher/batches/reading-progress/${batchId}` },
      { title: "CE Mark", icon: ClipboardCheck, url: batch?.CEmarkList },
      { title: "Internal Mark", icon: ListTodo, url: batch?.IRmarkList  },
      { title: "Ishthiraq", icon:  HandCoins, route: `/dashboard/teacher/ishthiraq/${batchId}`  },
    ];
    return (
      <div className="min-h-screen flex flex-col items-center bg-gradient-to-br from-gray-100 to-gray-300 dark:from-gray-900 dark:to-gray-800">
        <Header />
        <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mt-20 w-full max-w-6xl p-4">
          {cards.map((card, index) => (
            <motion.div
            key={index}
              initial={{ opacity: 0, y: 50 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ type: "spring", stiffness: 100, damping: 10, delay: index * 0.1 }}
            >
              <Card 
               title={card.title}
               icon={card.icon}
               {...(card.route ? { route: card.route } : { url: card.url })} />
            </motion.div>
          ))}
        </div>
      </div>
    );
};

export default CalssTeacherHome

================
File: frontend/src/store/readingProgressStore.js
================
import { create } from "zustand";
import toast from "react-hot-toast";
import { axiosInstance } from "../lib/axios";
import { useAuthStore } from "./useAuthStore";

export const useReadingProgress = create((set, get) => ({
  readingProgress: [],
  progressCountToApprove:[],
  isLoading: false,
  error: null,

  // GET reading progress for a student
  getStdReadingProgress: async (studentId ) => {
    set({ isLoading: true, error: null });
    try {
      
      let id = studentId || useAuthStore.getState().authUser._id;
      
      const res = await axiosInstance.get(`/reading-progress/${id}`);
      set({ readingProgress: res.data, isLoading: false });
    } catch (error) {
      console.error("Failed to fetch reading progress:", error.message);
      set({ error: error.message, isLoading: false });
      toast.error("Failed to load reading progress");
    }
  },

  // POST a new reading record
  addReadingProgress: async ( data ) => {
    try {
        const authUser = useAuthStore.getState().authUser;
      const res = await axiosInstance.post(`/reading-progress/${authUser._id}`, data);
      set((state) => ({
        readingProgress: [...state.readingProgress, res.data],
      }));
      toast.success("Reading progress added");
    } catch (error) {
      console.error("Add failed:", error.message);
      toast.error("Failed to add reading progress");
    }
  },

  updateReadingProgress: async (recordId, data) => {
    try {
      const res = await axiosInstance.put(`/reading-progress/${recordId}`, data);
      set((state) => ({
        readingProgress: state.readingProgress.map((r) =>
          r._id === recordId ? res.data : r
        ),
      }));
      toast.success("Reading progress updated");
    } catch (error) {
      console.error("Update failed:", error.message);
      toast.error("Failed to update reading progress");
    }
  },

  deleteReadingProgress: async (recordId) => {
    try {
      const res = await axiosInstance.delete(`/reading-progress/${recordId}`);
      set((state) => ({
        readingProgress: state.readingProgress.filter(a => a._id !== recordId)
      }));
      toast.success("readingProgress deleted successfully");
      return res.data;
    } catch (error) {
      console.error("Delete error:", error);
      toast.error("Failed to delete readingProgress");
    }
  },
  progressCountToApproveByBatch: async () => {
    try {
      const res =await axiosInstance.get('/reading-progress/count');

      
      set({progressCountToApprove: res.data})
    } catch (error) {
        console.log("Error in getcountToApprove", error);
    }
  },
  progressCountToApproveByStd: async (batchId) => {
    try {
      const res =await axiosInstance.get(`/reading-progress/count/${batchId}`);
      
      set({progressCountToApprove: res.data})
    } catch (error) {
        console.log("Error in getcountToApprove", error);
    }
  },
}));

================
File: frontend/src/store/useStaffStore.js
================
import { create } from "zustand";
import { axiosInstance } from "../lib/axios.js";
import toast from "react-hot-toast";
import { useAuthStore } from "./useAuthStore.js";


export const useStaffStore = create((set, get) => ({
  teachers: [],
  teacher: {},
  isLoading: false,
  batches: [],
  batch: {},
  attendance:{},
  assignedSubjects: [],

  getTeachers: async () => {
    set({isLoading: true});
    try {
        const res = await axiosInstance.get("/users/teachers");
        
        set({teachers: res.data.teachers});
    } catch (error) {
      console.log("Error in getTeachers:", error);
    }finally{
    set({isLoading: false});

    }
  },

  getTeacher: async (teacherId) => {
    set({ isLoading: true }); 
   try {
    const res = await axiosInstance.get(`/users/teacher/${teacherId}`)
    set({teacher: res.data})
    
   } catch (error) {
    console.error("Error fetching teacher:", error);
  } finally {
    set({ isLoading: false });
  }

  },
  updateTeacher: async (teacherId, details) => {
    set({ isLoading: true });
    try {
      await axiosInstance.put(`/users/teacher/update/${teacherId}`, details); 
      toast.success("Teacher Details updated successfully");
      set((state) => ({
        teachers: state.teachers.map((teacher) =>
          teacher._id === teacherId ? { ...teacher, ...details } : teacher
        ),
      }));
    } catch (error) {
      console.log("Error in updateTeacher:", error);
    } finally {
      set({ isLoading: false });
    }
  },
  
  deleteTeacher: async (teacherId) => {
    set({ isLoading: true });
    try {
      await axiosInstance.delete(`/users/teacher/delete/${teacherId}`); 
      toast.success("Teacher Details updated successfully");
      set((state) => ({
        teachers: state.teachers.filter((teacher) => teacher._id !== teacherId),
      }));
    } catch (error) {
      console.log("Error in deleteTeacher:", error);
    } finally {
      set({ isLoading: false });
    }
  },

  getBatch: async () => {
    try {
    const authUser = useAuthStore.getState().authUser
    if (!authUser) {
      console.error("User is not authenticated!");
    } else {
     const res = await axiosInstance.get(`/mng/class/${authUser._id}`)
     
     set({batches: res.data.assignedbatches});
    }
    } catch (error) {
      console.log("Error in getTeachers:", error);
    }finally{
    set({isLoading: false});
    }
  },

  getBatchById: async (batchId)=> {
    set({isLoading: true});
    try {      
      const res = await axiosInstance.get(`/mng/batch/${batchId}`)
      set({batch: res.data.batch});
    } catch (error) {
      console.log("Error in getTeachers:", error);
    }finally{
    set({isLoading: false});
    }
  },
  getStudentBatch: async () => {
  const authUser = useAuthStore.getState().authUser;

  try {
    await get().getBatchById(authUser.batchId);
  } catch (error) {
    console.error("Error in getStudentBatch:", error);
  }
},

  getAssignedSubjects: async (teacherId) => {
    set({isLoading: true});
    let userId;
    if(!teacherId){
      userId = useAuthStore.getState().authUser._id;
    }else{
      userId = teacherId;
    }
    try {
      const res = await axiosInstance.get(`/mng/assigned-subjects/${userId}`);
      set({assignedSubjects: res.data})
    } catch (error) {
      console.log("Error in getAssignedSubjects:", error);
    }finally{
      set({isLoading: false});
      }
  },

  submitAttendance: async (classId, attendance, date) => {
    set({isLoading: true});
    try {
      
      // date = new Date(date).toISOString();
      const res = await axiosInstance.post('/mng/mark-attendance',{classId, attendance, date})


      await useStaffStore.getState().getBatch(); 
      
    } catch (error) {
      console.log("Error in submitAttendance:", error);
    }finally{
      set({isLoading: false});
      }
  },

  getAttendance: async (classId, date) => {
    set({isLoading: true});
    try {
      const res = await axiosInstance.get(`/mng/mark-attendance/?classId=${classId}&date=${date}`)

      set({ attendance: res.data.attendance || {} });
    } catch (error) {
      console.log("Error in getAttendance:", error);
    }finally{
      set({isLoading: false});
      }
  }

}));

================
File: frontend/vite.config.js
================
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import { VitePWA } from 'vite-plugin-pwa';

export default defineConfig({
  plugins: [
    react(),
    VitePWA({
      registerType: 'autoUpdate',
      includeAssets: ['favicon.ico', 'robots.txt', 'apple-touch-icon.png'],
      manifest: {
        name: 'UIA ACADEMICS',
        short_name: 'UIA',
        description: "Manage administration, students, and teachers efficiently.",
        theme_color: '#2563eb',
        background_color: '#000000',
        display: 'standalone',
        start_url: '/',
        icons: [
          {
            src: '/web-app-manifest-192x192.png',
            sizes: '192x192',
            type: 'image/png'
          },
          {
            src: '/web-app-manifest-512x512.png',
            sizes: '512x512',
            type: 'image/png'
          },
          {
            src: '/web-app-manifest-192x192-maskable.png',
            sizes: '192x192',
            type: 'image/png',
            purpose: 'maskable'
          },
          {
            src: '/web-app-manifest-512x512-maskable.png',
            sizes: '512x512',
            type: 'image/png',
            purpose: 'maskable'
          },
        ]
      },
    }),
  ],
  server: {
    host: '0.0.0.0',
    port: 5173,
  },
});

================
File: backend/src/controllers/feesController.js
================
import SheetsDB from "../lib/googleSheet.js";
import Fee from "../models/fees.model.js";
const db = new SheetsDB();


export const createFee = async (req, res) => {
  try {
    const { studentId, batchId, month, paid } = req.body;
    
    const fee = await Fee.findOneAndUpdate(
      { studentId: studentId, batchId: batchId, month },
      { paid, updatedAt: new Date() },
      { upsert: true, new: true }
    );

    res.status(200).json(fee);
  } catch (error) {
    res.status(500).json({ message: 'Error updating fee' });
  }
}

export const assignFeesToBatch = async (req, res) => {
  try {     
    const { batchId, FeeStructure } = req.body;
    if (!batchId || !FeeStructure) {
      return res.status(400).json({ message: 'Batch ID and Fee Structure are required' });
    }
    

    const createdFees = await Fee.insertMany(fees);
    res.status(201).json({ message: 'Fees assigned successfully'});
  } catch (error) {               
    console.error(error);
    res.status(500).json({ message: 'Error assigning fees' });
  }   
};

// Assuming 'db' is your imported module for reading data, e.g., from Google Sheets.
// import * as db from '../utils/googleSheets.js'; 

export const getDashboardAnalytics = async (req, res) => {
  try {
    const batchNames = ['BATCH 09', 'BATCH 10', 'BATCH 11', 'BATCH 12', 'BATCH 13', 'BATCH 14'];
    
    // An array of the keys for monthly payments to make summing them up easier.
    const paymentKeys = ['SHAW', 'DUL_Q', 'DUL_H', 'MUH', 'SAF', 'RA_A', 'RA_AK', 'JUM_U', 'JUM_A', 'RAJ', 'SHAH', 'RAML'];

    // --- Step 1: Fetch and Structure Data for All Batches ---
    // We use Promise.all to fetch data from all sheets concurrently for better performance.
    const allBatchPromises = batchNames.map(name => db.readAll(name));
    const results = await Promise.all(allBatchPromises);

    let allStudents = [];
    results.forEach((batchData, index) => {
      const currentBatchName = batchNames[index];
      const structuredData = batchData.map(item => ({
        batchName: currentBatchName,
        cicNumber: item["CIC NO"],
        name: item.NAME,
        subscription: {
          perYear: Number(item["ISHTIRAK PER YEAR"]) || 0,
          balance: Number(item.BALANCE) || 0,
        },
        payments: {
          SHAW: Number(item.SHAW) || 0,
          DUL_Q: Number(item["DUL Q"]) || 0,
          DUL_H: Number(item["DUL H"]) || 0,
          MUH: Number(item.MUH) || 0,
          SAF: Number(item.SAF) || 0,
          RA_A: Number(item["RA A"]) || 0,
          RA_AK: Number(item["RA AK"]) || 0,
          JUM_U: Number(item["JUM U"]) || 0,
          JUM_A: Number(item["JUM A"]) || 0,
          RAJ: Number(item.RAJ) || 0,
          SHAH: Number(item.SHAH) || 0,
          RAML: Number(item.RAML) || 0,
        },
      }));
      allStudents.push(...structuredData);
    });

    // --- Step 2: Initialize Aggregators ---
    const kpi = {
      totalStudents: 0,
      totalRevenueDue: 0,
      totalCollected: 0,
      totalOutstanding: 0,
      defaulterCount: 0,
    };

    const batchSummary = {};
    batchNames.forEach(name => {
      batchSummary[name] = { due: 0, collected: 0, studentCount: 0, defaulterCount: 0 };
    });

    const monthlyCollection = {};
    paymentKeys.forEach(key => { monthlyCollection[key] = 0; });
    
    let defaultersList = [];

    // --- Step 3: Process All Students in a Single Loop ---
    for (const student of allStudents) {
      const totalPaidByStudent = Object.values(student.payments).reduce((sum, amount) => sum + amount, 0);

      // Aggregate KPI data
      kpi.totalStudents++;
      kpi.totalRevenueDue += student.subscription.perYear;
      kpi.totalCollected += totalPaidByStudent;
      kpi.totalOutstanding += student.subscription.balance;

      if (student.subscription.balance > 0) {
        kpi.defaulterCount++;
        defaultersList.push({
          name: student.name,
          cicNumber: student.cicNumber,
          batchName: student.batchName,
          balance: student.subscription.balance,
        });
      }

      // Aggregate Batch Summary data
      if (batchSummary[student.batchName]) {
        batchSummary[student.batchName].due += student.subscription.perYear;
        batchSummary[student.batchName].collected += totalPaidByStudent;
        batchSummary[student.batchName].studentCount++;
        if (student.subscription.balance > 0) {
          batchSummary[student.batchName].defaulterCount++;
        }
      }
      
      // Aggregate Monthly collection data
      for (const key of paymentKeys) {
        monthlyCollection[key] += student.payments[key] || 0;
      }
    }

    // --- Step 4: Finalize Data for Charts and Tables ---
    
    // Sort defaulters by the highest balance and take the top 10
    const topDefaulters = defaultersList
      .sort((a, b) => b.balance - a.balance)
      .slice(0, 10);
      
    // Format chart data from the summary objects
    const collectionByBatchChart = Object.entries(batchSummary).map(([name, data]) => ({
      batchName: name,
      due: data.due,
      collected: data.collected,
    }));
    
    const defaultersByBatchChart = Object.entries(batchSummary).map(([name, data]) => ({
      batchName: name,
      defaulterCount: data.defaulterCount,
    }));

    const collectionByMonthChart = Object.entries(monthlyCollection).map(([month, amount]) => ({
      month: month,
      collected: amount,
    }));
    
    const batchSummaryTable = Object.entries(batchSummary).map(([name, data]) => ({
      batchName: name,
      ...data,
      outstanding: data.due - data.collected
    }));


    // --- Step 5: Construct Final Response Object ---
    const dashboardData = {
      kpi,
      charts: {
        collectionByBatch: collectionByBatchChart,
        defaultersByBatch: defaultersByBatchChart,
        collectionByMonth: collectionByMonthChart,
        overallPaymentStatus: {
           collected: kpi.totalCollected,
           outstanding: kpi.totalOutstanding
        }
      },
      tables: {
        topDefaulters,
        batchSummary: batchSummaryTable
      }
    };
    
    res.status(200).json(dashboardData);

  } catch (error) {
    console.error("Error fetching dashboard analytics:", error);
    res.status(500).json({ message: "Error fetching dashboard analytics" });
  }
};

export const getFeesByBatch = async (req, res) => {
  try {
    const {batch_name} = req.query;
    const fees = await Fee.find({ batchId: req.query.batchId });
    
  const data = await db.readAll(batch_name);

const structuredData = data.map(item => ({
  cicNumber: item["CIC NO"],
  name: item.NAME,
  contact: item["CONTACT NO"],
  subscription: {
    perYear: item["ISHTIRAK PER YEAR"],
    oldBalance: item["OLD BALANCE"],
    balance: item.BALANCE
  },
  payments: {
    SHAW: item.SHAW,
    DUL_Q: item["DUL Q"],
    DUL_H: item["DUL H"],
    MUH: item.MUH,
    SAF: item.SAF,
    RA_A: item["RA A"],
    RA_AK: item["RA AK"],
    JUM_U: item["JUM U"],
    JUM_A: item["JUM A"],
    RAJ: item.RAJ,
    SHAH: item.SHAH,
    RAML: item.RAML
  }
}));



    res.status(200).json(structuredData);
  } catch (error) {
    console.log(error);
    
    res.status(500).json({ message: 'Error fetching fees' });
  }
};

export const getFeeByStudent = async (req, res) => {
  try {
    // Destructure both batch_name and cicNumber from the query parameters
    const { batch_name, cicNumber } = req.query;

    // Check if both required parameters are provided
    if (!batch_name || !cicNumber) {
      return res.status(400).json({ message: 'Batch name and CIC number are required.' });
    }
    
    // Read all student data from the specified batch
    const allStudents = await db.readAll(batch_name);

    // Find the specific student by their CIC number
    // We compare them as strings to avoid type issues (e.g., "101" vs 101)
    const student = allStudents.find(item => String(item["CIC NO"]) === String(cicNumber));

    // If no student is found with that CIC number, return a 404 error
    if (!student) {
      return res.status(404).json({ message: 'Student not found in this batch.' });
    }

    // If the student is found, structure their data
    const structuredData = {
      cicNumber: student["CIC NO"],
      name: student.NAME,
      contact: student["CONTACT NO"],
      subscription: {
        perYear: student["ISHTIRAK PER YEAR"],
        oldBalance: student["OLD BALANCE"],
        balance: student.BALANCE
      },
      payments: {
        SHAW: student.SHAW,
        DUL_Q: student["DUL Q"],
        DUL_H: student["DUL H"],
        MUH: student.MUH,
        SAF: student.SAF,
        RA_A: student["RA A"],
        RA_AK: student["RA AK"],
        JUM_U: student["JUM U"],
        JUM_A: student["JUM A"],
        RAJ: student.RAJ,
        SHAH: student.SHAH,
        RAML: student.RAML
      }
    };

    // Send the structured data for the single student
    res.status(200).json(structuredData);

  } catch (error) {
    console.error('Error fetching student fee:', error); // Use console.error for better logging
    res.status(500).json({ message: 'Internal server error while fetching student fee' });
  }
};

/**
 * Updates a specific month's payment for a student and recalculates their balance.
 */
export const updateFeeStatus = async (req, res) => {
    try {
        // --- 1. Extract Data ---
        const { cicNumber } = req.params;
        const { batch_name } = req.query;
        // The frontend sends the entire updated student object in the body
        const updatedDataFromClient = req.body;

        // --- 2. Validate Input ---
        if (!batch_name || !updatedDataFromClient || Object.keys(updatedDataFromClient).length === 0) {
            return res.status(400).json({ message: "Missing batch_name in query or student data in body." });
        }

        // --- 3. Find the Student's Row in the Sheet ---
        // IMPORTANT: Your db.readAll function must add a `rowIndex` property to each object
        // so you know which row to update in the Google Sheet.
        const allStudents = await db.readAll(batch_name);
        const studentToUpdate = allStudents.find(student => student["CIC NO"] === cicNumber);

        if (!studentToUpdate) {
            return res.status(404).json({ message: 'Student not found in the specified batch.' });
        }
        
        const sheetRowIndex = studentToUpdate.rowIndex;
        if (!sheetRowIndex) {
            return res.status(500).json({ message: 'Database integration error: rowIndex not found. Cannot update.' });
        }

        // --- 4. Map Frontend Data to Your Sheet Column Headers ---
        // This creates an object with the exact column names as keys, which your db helper needs.
        const updatedRowForSheet = {
            "SL NO": studentToUpdate.rowIndex - 2,
            "NAME": updatedDataFromClient.name,
            "CIC NO": updatedDataFromClient.cicNumber,
            // Only update the fields that can be edited
            "CONTACT NO": updatedDataFromClient.contact,
            "ISHTIRAK PER YEAR": updatedDataFromClient.subscription.perYear,
            "OLD BALANCE": updatedDataFromClient.subscription.oldBalance,
            "BALANCE": updatedDataFromClient.subscription.balance, // We trust the frontend's calculation
            "SHAW": updatedDataFromClient.payments.SHAW,
            "DUL Q": updatedDataFromClient.payments.DUL_Q,
            "DUL H": updatedDataFromClient.payments.DUL_H,
            "MUH": updatedDataFromClient.payments.MUH,
            "SAF": updatedDataFromClient.payments.SAF,
            "RA A": updatedDataFromClient.payments.RA_A,
            "RA AK": updatedDataFromClient.payments.RA_AK,
            "JUM U": updatedDataFromClient.payments.JUM_U,
            "JUM A": updatedDataFromClient.payments.JUM_A,
            "RAJ": updatedDataFromClient.payments.RAJ,
            "SHAH": updatedDataFromClient.payments.SHAH,
            "RAML": updatedDataFromClient.payments.RAML,
        };

        // --- 5. Persist Changes to the Database ---
        // Your db.updateRow function will use the sheet name, row index, and the updated data.
       await db.updateRow(batch_name, sheetRowIndex, updatedRowForSheet);

        // --- 6. Send Success Response ---
        res.status(200).json({
            message: 'Fee status updated successfully.',
            data: updatedDataFromClient // Send back the data for frontend state consistency
        });

    } catch (error) {
        console.error("Error updating fee status:", error);
        res.status(500).json({ message: 'An error occurred on the server while updating.' });
    }
};


export const getFeesByStd = async (req, res) => {
  try {
    const { studentId } = req.params;
    const stdFees = await Fee.find({ studentId: studentId });

    res.status(200).json(stdFees); 
  } catch (error) {
    console.error(error); 
    res.status(500).json({ message: 'Error fetching fees' });
  }
};

================
File: backend/src/routes/management.route.js
================
import express from "express";
import { academicStatusLinkDelete, academicStatusLinkUpdate, asignBatchTeacher, asignClassLeader, asignsemester,  asignSubteacher,  asignSubteacherPeriod,  assignedSubjects,  CELinkDelete,  CELinkUpdate,  curruntSemSubjects,  deleteArtSem,  deleteArtSubject,  deleteBatch,  deleteSemester,  deleteSubject,  getArtSems,  getArtSubjects,  getAssignedBatch,  getAttendance,  getBatch,  getBatches, getSemesters, getSubjects, getTimetable, IRLinkDelete, IRLinkUpdate, postArtSem, postAttendance, postbatches, postSemester, postSubject, postTimetable, updateArtSem, updateArtSubject, updateBatch, updateSemester, updateSubject } from "../controllers/mngController.js";


const router = express.Router();

router.get('/timetable', getTimetable);

router.post('/timetable', postTimetable);

router.get('/semester', getSemesters);

router.post('/semester', postSemester);

router.delete('/semester/delete/:semesterId', deleteSemester);

router.put('/semester/update/:semesterId', updateSemester);

router.get('/art-sem', getArtSems);

router.post('/art-sem', postArtSem);

router.delete('/art-sem/delete/:semesterId', deleteArtSem);

router.put('/art-sem/update/:semesterId', updateArtSem);

router.get('/batches', getBatches);

router.delete('/batch/delete/:batchId', deleteBatch);

router.put('/batch/update/:batchId', updateBatch);

router.get('/class/:teacherId', getAssignedBatch)

router.get('/batch/:batchId', getBatch)

router.post('/batches', postbatches)

router.get('/subjects/:semesterId', getSubjects)

router.post('/subjects/:semesterId', postSubject)

router.delete('/subject/delete/:subjectId', deleteSubject);

router.put('/subject/update/:subjectId', updateSubject);

router.get('/art-subjects/:semesterId', getArtSubjects);

router.delete('/art-subject/delete/:subjectId', deleteArtSubject);

router.put('/art-subject/update/:subjectId', updateArtSubject);

router.post('/asign-teacher', asignBatchTeacher)

router.post('/asign-semester', asignsemester)

router.post('/asign-subteacher', asignSubteacher)

router.post('/asign-subteacher-period', asignSubteacherPeriod)

router.get('/assigned-subjects/:teacherId', assignedSubjects)

router.post('/asign-class-leader', asignClassLeader)

router.post('/mark-attendance', postAttendance)

router.get('/mark-attendance', getAttendance)

router.patch('/update-ce-link', CELinkUpdate)

router.patch('/delete-ce-link', CELinkDelete)

router.patch('/update-ir-link', IRLinkUpdate)

router.patch('/update-ir-link', IRLinkDelete)

router.patch('/update-academic-status-link', academicStatusLinkUpdate)

router.patch('/delete-academic-status-link', academicStatusLinkDelete)

router.get('/currunt-sem-subjects/:batchId', curruntSemSubjects )



export default router;

================
File: frontend/package.json
================
{
  "name": "frontend",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "lint": "eslint .",
    "preview": "vite preview"
  },
  "dependencies": {
    "@emotion/react": "^11.14.0",
    "@emotion/styled": "^11.14.0",
    "@mui/material": "^6.4.8",
    "@shadcn/ui": "^0.0.4",
    "@tailwindcss/typography": "^0.5.16",
    "axios": "^1.7.9",
    "buffer": "^6.0.3",
    "cally": "^0.8.0",
    "class-variance-authority": "^0.7.1",
    "date-fns": "^4.1.0",
    "framer-motion": "^12.9.2",
    "html2canvas": "^1.4.1",
    "jspdf": "^2.5.1",
    "jspdf-autotable": "^3.8.1",
    "lucide-react": "^0.475.0",
    "papaparse": "^5.5.2",
    "pdfjs-dist": "^5.1.91",
    "react": "^19.0.0",
    "react-big-calendar": "^1.18.0",
    "react-confetti": "^6.2.2",
    "react-dnd": "^16.0.1",
    "react-dnd-html5-backend": "^16.0.1",
    "react-dnd-multi-backend": "^9.0.0",
    "react-dnd-touch-backend": "^16.0.1",
    "react-dom": "^19.0.0",
    "react-hot-toast": "^2.5.2",
    "react-icons": "^5.4.0",
    "react-router-dom": "^7.1.5",
    "react-toastify": "^11.0.5",
    "recharts": "^3.2.1",
    "zustand": "^5.0.3"
  },
  "devDependencies": {
    "@eslint/js": "^9.19.0",
    "@types/react": "^19.0.8",
    "@types/react-dom": "^19.0.3",
    "@vitejs/plugin-react": "^4.3.4",
    "autoprefixer": "^10.4.20",
    "daisyui": "^4.12.23",
    "eslint": "^9.19.0",
    "eslint-plugin-react": "^7.37.4",
    "eslint-plugin-react-hooks": "^5.0.0",
    "eslint-plugin-react-refresh": "^0.4.18",
    "globals": "^15.14.0",
    "path": "^0.12.7",
    "postcss": "^8.5.2",
    "tailwindcss": "^3.4.17",
    "vite": "^6.1.0",
    "vite-plugin-pwa": "^1.0.0"
  }
}

================
File: backend/src/controllers/userController.js
================
import bcrypt from "bcryptjs";
import Staff from "../models/staff.model.js";
import Student from "../models/student.model.js";
import Batch from "../models/batch.model.js";

export const addUser = async (req, res) => {
  try {
    
    let {studentName, selectedBatch, rollNumber, studentId } = req.body;

    selectedBatch = parseInt(selectedBatch, 10);
    rollNumber = parseInt(rollNumber, 10);

    const existingUser = await Student.findOne({ studentId });
    if (existingUser) {
      return res.status(400).json({ success: false, message: "This student is already registered." });
    }

    const newUser = new Student({
      studentName,
      selectedBatch,
      rollNumber,
      studentId
    });

    const savedUser = await newUser.save();
    
    res.status(201).json({ 
      success: true, 
      message: "Student registered successfully", 
      user: savedUser 
    });

  } catch (error) {
    console.log(error);
    
    res.status(500).json({ success: false, error: error.message });
  }
};

export const getStudents = async (req, res) => {
  try {
    const { batchId } = req.params;
    let students;
    if(batchId){
       students = await Student.find({batchId, isActive: true}).sort({ cicNumber: 1 });
    }else{
       students = await Student.find({isActive: true}).sort({ cicNumber: 1 });
    }
    

    if (!students || students.length === 0) {
      return res.status(404).json({ success: false, message: "No students found" });
    }

    res.status(200).json({ success: true, students });
  } catch (error) {
    res.status(500).json({ success: false, error: error.message });
  }
};
export const getStudentsInactive = async (req, res) => {
  try {
    const { batchId } = req.params;
    let students;
    if(batchId){
       students = await Student.find({batchId, isActive: false}).sort({ selectedBatch: 1, rollNumber: 1, division: 1 });
    }else{
       students = await Student.find({isActive: false}).sort({ selectedBatch: 1, rollNumber: 1, division: 1 });
    }
    

    if (!students || students.length === 0) {
      return res.status(404).json({ success: false, message: "No students found" });
    }

    res.status(200).json({ success: true, students });
  } catch (error) {
    res.status(500).json({ success: false, error: error.message });
  }
};

export const getStudent = async (req, res) => {
  try {
    const {studentId} = req.params;

    const student = await Student.findById(studentId);

    res.status(200).json(student);
  } catch (error) {
    res.status(500).json({ success: false, error: error.message });
  }
}

export const updatePassword = async (req, res) => {
  try {
    const { studentId, teacherId, currentPassword, newPassword } = req.body;

    if (!currentPassword || !newPassword) {
      return res.status(400).json({ message: "Please provide current and new password." });
    }

    let user;

    if (studentId) {
      user = await Student.findById(studentId);
    } else if (teacherId) {
      user = await Staff.findById(teacherId);
    } else {
      return res.status(400).json({ message: "User ID is required." });
    }

    if (!user) {
      return res.status(404).json({ message: "User not found." });
    }

    const isPasswordCorrect = await bcrypt.compare(currentPassword, user.password);
    if (!isPasswordCorrect) {
      return res.status(400).json({ message: "Current password is incorrect." });
    }

    const salt = await bcrypt.genSalt(10);
    const hashedPassword = await bcrypt.hash(newPassword, salt);

    user.password = hashedPassword;
    await user.save();

    return res.status(200).json({ message: "Password updated successfully." });

  } catch (error) {
    console.error("Error updating password:", error);
    return res.status(500).json({ message: "Server error while updating password." });
  }
};

export const editStudent = async (req, res) => {
  try {
    const { studentId } = req.params;
    const updateData = req.body;
    let hashedPassword;

  if(updateData.password){
    const salt = await bcrypt.genSalt(10);
     hashedPassword = await bcrypt.hash(updateData.password, salt);
     updateData.password = hashedPassword;
  }else{
    delete updateData.password;
  }

  if(updateData.batchName){
    const batchId = await  Batch.findOne({ batchName :updateData.batchName}).batchId;
    updateData.batchId = batchId;
  }

    const student = await Student.findByIdAndUpdate(studentId, updateData, {
      new: true,
      runValidators: true, 
    });

    if (!student) {
      return res.status(404).json({ success: false, message: "Student not found" });
    }

    res.status(200).json({ success: true, student });
  } catch (error) {
    console.error("Error updating student:", error);
    res.status(500).json({ success: false, error: error.message });
  }
};

export const editTeacher = async (req, res) => {
  try {
    const { teacherId } = req.params;
    const updateData = req.body;
    let hashedPassword;

  if(updateData.password){
    const salt = await bcrypt.genSalt(10);
     hashedPassword = await bcrypt.hash(updateData.password, salt);
     updateData.password = hashedPassword;
  }else{
    delete updateData.password;
  }


    const teacher = await Staff.findByIdAndUpdate(teacherId, updateData, {
      new: true,
      runValidators: true, 
    });

    if (!teacher) {
      return res.status(404).json({ success: false, message: "Staff not found" });
    }

    res.status(200).json({ success: true, teacher });
  } catch (error) {
    console.error("Error updating Staff:", error);
    res.status(500).json({ success: false, error: error.message });
  }
};


export const getUser = async (req,res) => {
  try {
    const { userId } = req.params;
    const user = await Student.findOne({ studentId: userId });
    if (!user) {
      return res.status(404).json({ success: false, message: "Student not found" });
    }
    res.status(200).json({ success: true, user });

  } catch (error) {
    res.status(500).json({ success: false, error: error.message });
    
  }
}

export const updateUser = async (req, res) => {

  try {
    const { studentId } = req.body;
    
    const updateData = req.body;

    const updatedUser = await Student.findOneAndUpdate(
      { studentId }, 
      updateData, 
      { new: true, runValidators: true } 
    );

    if (!updatedUser) {
      return res.status(404).json({ success: false, message: "Student not found" });
    }

    return res.status(200).json({ success: true, message: "Student updated successfully", user: updatedUser });
  } catch (error) {
    console.error("Error updating user:", error);
    return res.status(500).json({ success: false, error: error.message });
  }
};

export const changeStdStatus = async (req, res) => {
  try {
    const { userId } = req.params;

    const student = await Student.findById(userId);

    if (!student) {
      return res.status(404).json({ success: false, message: "Student not found" });
    }

    student.isActive = !student.isActive;
    await student.save(); 

    res.status(200).json({ success: true, message: "Student status changed", isActive: student.isActive });
  } catch (error) {
    res.status(500).json({ success: false, error: error.message });
  }
};


export const deleteStudent = async (req, res) => {
  try {
    const { userId } = req.params;

    const deletedUser = await Student.findByIdAndDelete(userId);

    if (!deletedUser) {
      return res.status(404).json({ success: false, message: "Student not found" });
    }

    res.status(200).json({ success: true, message: "Student deleted successfully" });
  } catch (error) {
    res.status(500).json({ success: false, error: error.message });
  }
};


export const getTeachers = async (req, res) => {
  
  try {
    const teachers = await Staff.find({role: "teacher"}).sort({ name: 1 });
    if (!teachers || teachers.length === 0) {
      return res.status(200).json({ success: false, message: "No Teachers found", teachers:[]});
    }
    
    res.status(200).json({ success: true, teachers });
  } catch (error) {
    console.log(error);
    res.status(500).json({ success: false, error: error.message });
    console.log(error);
    
  }
}

export const getTeacher = async (req, res) => {
  try {
    const {teacherId} = req.params;

    const teacher = await Staff.findById(teacherId);

    res.status(200).json(teacher);
  } catch (error) {
    res.status(500).json({ success: false, error: error.message });
  }
}

export const deleteTeacher = async (req, res) => {
  try {
    const { teacherId } = req.params;

    const deletedUser = await Staff.findByIdAndDelete(teacherId);

    if (!deletedUser) {
      return res.status(404).json({ success: false, message: "Teacher not found" });
    }

    res.status(200).json({ success: true, message: "Staff deleted successfully" });
  } catch (error) {
    res.status(500).json({ success: false, error: error.message });
  }
};

================
File: frontend/src/components/Header.jsx
================
import { useThemeStore } from "../store/useThemeStore";
import { useAuthStore } from "../store/useAuthStore";
import { Bell, Moon, Sun, Search } from "lucide-react";
import { motion } from "framer-motion";

const Header = () => {
  const { theme, toggleTheme } = useThemeStore();
  const { authUser } = useAuthStore();

  const getGreeting = () => {
    const hour = new Date().getHours();
    if (hour < 12) return "Good Morning";
    if (hour < 18) return "Good Afternoon";
    return "Good Evening";
  };

  return (
    <header className="flex justify-between items-center bg-surface-glass dark:bg-surface-glassDark backdrop-blur-md rounded-2xl px-6 py-3 border border-white/20 dark:border-slate-700/50 shadow-sm">
      {/* Left: Greeting & Breadcrumbs */}
      <div>
        <h1 className="text-xl font-display font-bold text-slate-800 dark:text-white">
          {getGreeting()}, <span className="text-primary-500">{authUser?.name?.split(' ')[0] || 'Scholar'}</span> üëã
        </h1>
        <p className="text-xs text-slate-500 dark:text-slate-400 font-medium tracking-wide uppercase">
          {authUser?.role || "Guest"} Portal
        </p>
      </div>

      {/* Right: Actions */}
      <div className="flex items-center gap-3">
        {/* Search Bar (Visual Only for now) */}
        <div className="hidden md:flex items-center px-3 py-2 bg-slate-100 dark:bg-slate-800 rounded-xl border-none focus-within:ring-2 ring-primary-500/50 transition-all w-64">
          <Search size={18} className="text-slate-400 mr-2" />
          <input 
            type="text" 
            placeholder="Search anything..." 
            className="bg-transparent border-none outline-none text-sm text-slate-700 dark:text-slate-200 placeholder:text-slate-400 w-full"
          />
        </div>

        {/* Theme Toggle */}
        <motion.button
          whileTap={{ scale: 0.9 }}
          onClick={toggleTheme}
          className="p-2.5 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors"
        >
          {theme === "light" ? <Moon size={20} /> : <Sun size={20} />}
        </motion.button>

        {/* Notifications */}
        <motion.button
          whileTap={{ scale: 0.9 }}
          className="p-2.5 rounded-xl bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors relative"
        >
          <Bell size={20} />
          <span className="absolute top-2 right-2.5 w-2 h-2 bg-rose-500 rounded-full ring-2 ring-white dark:ring-slate-800 animate-pulse" />
        </motion.button>

        {/* Profile Avatar */}
        <div className="ml-2 pl-4 border-l border-slate-200 dark:border-slate-700">
          <div className="w-10 h-10 rounded-full bg-gradient-to-tr from-primary-500 to-indigo-500 p-0.5 cursor-pointer">
            <img 
              src={authUser?.profileImage || "https://api.dicebear.com/7.x/avataaars/svg?seed=Felix"} 
              alt="Profile" 
              className="w-full h-full rounded-full object-cover bg-white"
            />
          </div>
        </div>
      </div>
    </header>
  );
};

export default Header;

================
File: frontend/src/components/StudentTable.jsx
================
import { useState } from "react";
import {
  Pencil, Trash2, Search, Plus, Filter,
  MoreVertical, Phone, Mail, UserX, UserCheck
} from "lucide-react";
import { Link } from "react-router-dom";
import { useAuthStore } from "../store/useAuthStore";
import { useStudentStore } from "../store/studentStore";
import { motion, AnimatePresence } from "framer-motion";

const StudentTable = ({ students, inactive }) => {
  const { authUser } = useAuthStore();
  const { deleteStudent, stdStatusChange } = useStudentStore();
  const [searchQuery, setSearchQuery] = useState("");
  const [activeMenu, setActiveMenu] = useState(null);

  // Filter Logic
  const filteredStudents = students.filter((student) =>
    [student.name, student.batchName, String(student.cicNumber)].some((field) =>
      field?.toLowerCase().includes(searchQuery.toLowerCase())
    )
  );

  // Status Toggle Handler
  const handleStatusChange = async (id) => {
    if (window.confirm(`Are you sure you want to ${inactive ? "Restore" : "Deactivate"} this student?`)) {
      await stdStatusChange(id, inactive);
      setActiveMenu(null);
    }
  };

  const handleDelete = async (id) => {
    if (window.confirm("Are you sure you want to permanently delete this student?")) {
      await deleteStudent(id);
      setActiveMenu(null);
    }
  };

  return (
    <div className="space-y-6">
      
      {/* 1. Toolbar Section */}
      <div className="flex flex-col sm:flex-row justify-between items-center gap-4 bg-white dark:bg-slate-800 p-4 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700">
        
        {/* Search Bar */}
        <div className="relative w-full sm:w-96">
          <Search className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400" size={18} />
          <input
            type="text"
            placeholder="Search students by name, batch, or ID..."
            className="w-full pl-10 pr-4 py-2.5 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-primary-500 outline-none transition-all text-sm"
            value={searchQuery}
            onChange={(e) => setSearchQuery(e.target.value)}
          />
        </div>

        {/* Actions */}
        {authUser.role === "admin" && !inactive && (
          <Link
            to="/dashboard/admin/admission-form"
            className="flex items-center gap-2 px-5 py-2.5 bg-primary-600 hover:bg-primary-700 text-white rounded-xl font-medium shadow-lg shadow-primary-500/20 transition-all active:scale-95 whitespace-nowrap"
          >
            <Plus size={18} />
            <span className="hidden sm:inline">Add Student</span>
          </Link>
        )}
      </div>

      {/* 2. Data Grid (Desktop) & Cards (Mobile) */}
      <div className="bg-white dark:bg-slate-800 rounded-3xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden">
        
        {/* Desktop Header */}
        <div className="hidden md:grid grid-cols-12 gap-4 p-4 bg-slate-50/50 dark:bg-slate-900/50 border-b border-slate-200 dark:border-slate-700 text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider">
          <div className="col-span-1 text-center">#</div>
          <div className="col-span-4">Student</div>
          <div className="col-span-2">Batch</div>
          <div className="col-span-2">Contact</div>
          <div className="col-span-2">Status</div>
          <div className="col-span-1 text-right">Actions</div>
        </div>

        {/* Table Body */}
        <div className="divide-y divide-slate-100 dark:divide-slate-700">
          {filteredStudents.length === 0 ? (
            <div className="p-12 text-center text-slate-500 dark:text-slate-400">
              <div className="inline-flex p-4 rounded-full bg-slate-100 dark:bg-slate-900 mb-4">
                <Filter size={24} />
              </div>
              <p>No students found matching your search.</p>
            </div>
          ) : (
            <AnimatePresence>
              {filteredStudents.map((student, index) => (
                <motion.div
                  key={student._id}
                  initial={{ opacity: 0 }}
                  animate={{ opacity: 1 }}
                  exit={{ opacity: 0 }}
                  className="group relative md:grid grid-cols-12 gap-4 p-4 items-center hover:bg-slate-50 dark:hover:bg-slate-700/30 transition-colors"
                >
                  {/* Mobile Card View Layout */}
                  <div className="flex md:hidden items-center gap-4 mb-4">
                    <div className="relative">
                      <img
                        src={student.profileImage || `https://api.dicebear.com/7.x/initials/svg?seed=${student.name}`}
                        alt={student.name}
                        className="w-12 h-12 rounded-full object-cover ring-2 ring-white dark:ring-slate-700 shadow-sm"
                      />
                      <span className="absolute -bottom-1 -right-1 w-3 h-3 bg-emerald-500 border-2 border-white dark:border-slate-800 rounded-full"></span>
                    </div>
                    <div>
                      <h3 className="font-bold text-slate-900 dark:text-white">{student.name}</h3>
                      <p className="text-xs text-slate-500">CIC: {student.cicNumber}</p>
                    </div>
                  </div>

                  {/* Desktop Columns */}
                  <div className="hidden md:block col-span-1 text-center font-mono text-slate-400 text-sm">
                    {(index + 1).toString().padStart(2, '0')}
                  </div>

                  <div className="col-span-4 hidden md:flex items-center gap-3">
                    <img
                      src={student.profileImage || `https://api.dicebear.com/7.x/initials/svg?seed=${student.name}`}
                      className="w-9 h-9 rounded-full object-cover bg-slate-100"
                      alt=""
                    />
                    <div>
                      <p className="font-medium text-slate-900 dark:text-slate-100 text-sm">{student.name}</p>
                      <p className="text-xs text-slate-500">ID: {student.cicNumber}</p>
                    </div>
                  </div>

                  <div className="col-span-2 text-sm text-slate-600 dark:text-slate-300">
                    <span className="md:hidden font-semibold mr-2">Batch:</span>
                    <span className="px-2.5 py-1 rounded-full bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-300 text-xs font-medium border border-blue-100 dark:border-blue-900/30">
                      {student.batchName}
                    </span>
                  </div>

                  <div className="col-span-2 flex flex-col gap-1">
                    <div className="flex items-center gap-2 text-xs text-slate-500 dark:text-slate-400">
                      <Phone size={12} /> {student.phoneNumber}
                    </div>
                    {/* <div className="flex items-center gap-2 text-xs text-slate-500 dark:text-slate-400 truncate">
                      <Mail size={12} /> {student.email || "No Email"}
                    </div> */}
                  </div>

                  <div className="col-span-2 mt-2 md:mt-0">
                    <span className={`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium border ${inactive 
                      ? "bg-rose-50 border-rose-100 text-rose-600 dark:bg-rose-900/20 dark:border-rose-900/30 dark:text-rose-300"
                      : "bg-emerald-50 border-emerald-100 text-emerald-600 dark:bg-emerald-900/20 dark:border-emerald-900/30 dark:text-emerald-300"
                    }`}>
                      <span className={`w-1.5 h-1.5 rounded-full ${inactive ? "bg-rose-500" : "bg-emerald-500"}`}></span>
                      {inactive ? "Inactive" : "Active"}
                    </span>
                  </div>

                  {/* Actions (Desktop: Hover | Mobile: Always visible) */}
                  <div className="col-span-1 flex justify-end relative">
                    {authUser.role === "admin" && (
                      <div className="flex items-center gap-2 opacity-100 md:opacity-0 group-hover:opacity-100 transition-opacity">
                        <Link 
                          to={`/dashboard/admin/std-edit/${student._id}`}
                          className="p-1.5 text-slate-400 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors"
                          title="Edit"
                        >
                          <Pencil size={16} />
                        </Link>
                        
                        <button
                          onClick={() => handleStatusChange(student._id)}
                          className="p-1.5 text-slate-400 hover:text-amber-600 hover:bg-amber-50 rounded-lg transition-colors"
                          title={inactive ? "Restore" : "Deactivate"}
                        >
                          {inactive ? <UserCheck size={16} /> : <UserX size={16} />}
                        </button>

                        <button
                          onClick={() => handleDelete(student._id)}
                          className="p-1.5 text-slate-400 hover:text-rose-600 hover:bg-rose-50 rounded-lg transition-colors"
                          title="Delete Permanently"
                        >
                          <Trash2 size={16} />
                        </button>
                      </div>
                    )}
                  </div>

                </motion.div>
              ))}
            </AnimatePresence>
          )}
        </div>
      </div>
    </div>
  );
};

export default StudentTable;

================
File: frontend/src/pages/admin/ManagementPage.jsx
================
import React, { useState, useEffect } from "react";
import { useAdminStore } from "../../store/useAdminMngStore";
import { useStaffStore } from "../../store/useStaffStore";
import { 
  FiPlus, FiEdit2, FiTrash2, FiSave, FiX, 
  FiLayers, FiBook, FiUsers, FiCalendar, FiSearch 
} from "react-icons/fi";
import { motion, AnimatePresence } from "framer-motion";
import { useNavigate } from "react-router-dom";
import Header from "../../components/Header";
import toast from "react-hot-toast";
import { axiosInstance } from "../../lib/axios";

// --- Sub-Components Definitions (Moved to top for clarity) ---

const StatusBadge = ({ isAssigned }) => (
  <span
    className={`ml-2 px-2 py-0.5 text-xs font-bold uppercase tracking-wider rounded-full ${
      isAssigned
        ? "bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400"
        : "bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400"
    }`}
  >
    {isAssigned ? "Active" : "Pending"}
  </span>
);

const AssignmentCard = ({ 
  name, 
  isAssigned, 
  assignedName, 
  isEditing, 
  toggleEdit, 
  children,
  icon: Icon = FiCalendar
}) => (
  <div className="bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden group hover:shadow-md transition-all">
    <div className="px-5 py-4 border-b border-slate-100 dark:border-slate-700/50 flex justify-between items-center bg-slate-50/50 dark:bg-slate-900/50">
      <h3 className="font-bold text-slate-800 dark:text-white flex items-center gap-2">
        {name}
        <StatusBadge isAssigned={isAssigned} />
      </h3>
      <button
        onClick={toggleEdit}
        className="text-slate-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors p-1 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700"
      >
        {isEditing ? <FiX /> : <FiEdit2 />}
      </button>
    </div>

    <div className="p-5">
      {isEditing ? (
        children
      ) : (
        <div className="flex items-center gap-4">
          <div className={`w-12 h-12 rounded-xl flex items-center justify-center text-xl ${
            isAssigned 
              ? "bg-primary-50 text-primary-600 dark:bg-primary-900/20 dark:text-primary-400" 
              : "bg-slate-100 text-slate-400 dark:bg-slate-800"
          }`}>
            <Icon />
          </div>
          <div>
            <p className="text-xs text-slate-500 uppercase tracking-wider font-semibold">Current Semester</p>
            <p className="font-bold text-slate-800 dark:text-white text-lg">
              {assignedName || "Not assigned"}
            </p>
          </div>
        </div>
      )}
    </div>
  </div>
);

const SemesterAssignment = ({ batches, semesters, tab, art = false }) => {
  const [batchAssignments, setBatchAssignments] = useState({});
  const [editMode, setEditMode] = useState({});

  useEffect(() => {
    const modified = {};
    for (const cl of batches) {
      if (art) {
        modified[cl._id] = cl.currentArtSemester || "";
      } else {
        modified[cl._id] = cl.currentSemester || "";
      }
    }
    setBatchAssignments(modified);
  }, [batches, tab, art]);

  const handleSemesterSelect = async (classId, semesterId) => {
    try {
      // Optimistic update
      setBatchAssignments((prev) => ({ ...prev, [classId]: semesterId }));
      
      // API Call
      await axiosInstance.post("/mng/asign-semester", {
        classId,
        semesterId,
        art
      });

      toast.success("Semester assigned successfully!");
      setEditMode((prev) => ({ ...prev, [classId]: false }));
    } catch (error) {
      toast.error("Failed to update semester.");
      console.error(error);
    }
  };

  const toggleEditMode = (batchId) => {
    setEditMode((prev) => ({ ...prev, [batchId]: !prev[batchId] }));
  };

  return (
    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {batches.map((batch) => {
        const semesterId = batchAssignments[batch._id];
        const semester = semesters.find((s) => s._id === semesterId);
        const isEditing = editMode[batch._id];

        return (
          <AssignmentCard
            key={batch._id}
            name={batch.name}
            isAssigned={!!semester}
            assignedName={semester?.name}
            isEditing={isEditing}
            toggleEdit={() => toggleEditMode(batch._id)}
          >
            <div className="space-y-3">
              <label className="text-sm font-medium text-slate-700 dark:text-slate-300">
                Assign {art ? "Art " : ""}Semester
              </label>
              <select
                value={batchAssignments[batch._id] || ""}
                onChange={(e) => handleSemesterSelect(batch._id, e.target.value)}
                className="w-full p-2.5 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl outline-none focus:ring-2 focus:ring-primary-500 text-slate-800 dark:text-white"
              >
                <option value="">Select Semester...</option>
                {semesters.map((s) => (
                  <option key={s._id} value={s._id}>
                    {s.name}
                  </option>
                ))}
              </select>
            </div>
          </AssignmentCard>
        );
      })}
    </div>
  );
};

// --- Main Page Component ---

const ManagementPage = () => {
  const { 
    getBatches, getSemesters, getTeachers, getArtSems,
    batches, semesters, teachers, artSems, 
    updateSemester, updateBatch, updateSelectedTab, updateArtSem,
    deleteBatch, deleteSemester, deleteArtSems 
  } = useAdminStore();
  const { deleteTeacher } = useStaffStore();
  
  const [activeTab, setActiveTab] = useState(() => localStorage.getItem("selectedTab") || "batches");
  const [items, setItems] = useState([]);
  const [searchTerm, setSearchTerm] = useState("");
  
  // Edit/Add States
  const [showAdd, setShowAdd] = useState(false);
  const [newItemName, setNewItemName] = useState("");
  const [editId, setEditId] = useState(null);
  const [editName, setEditName] = useState("");
  
  const navigate = useNavigate();

  // Persist Tab
  useEffect(() => {
    localStorage.setItem("selectedTab", activeTab);
  }, [activeTab]);

  // Initial Data Fetch
  useEffect(() => {
    const load = async () => {
      await Promise.all([getBatches(), getSemesters(), getArtSems(), getTeachers()]);
    };
    load();
  }, []);

  // Sync Items with Tab
  useEffect(() => {
    const dataMap = {
      "batches": batches,
      "current Semester": semesters, // Logic for Assignment Component handled separately
      "semester Subjects": semesters,
      "arts Subjects": artSems,
      "teachers": teachers
    };
    // For assignment tabs, we don't need to populate 'items' array
    if (!["current Semester", "current Art Sems"].includes(activeTab)) {
      setItems(dataMap[activeTab] || []);
    }
    setShowAdd(false);
    setEditId(null);
  }, [activeTab, batches, semesters, artSems, teachers]);

  const handleAdd = async () => {
    if (!newItemName.trim()) return toast.error("Name is required");
    try {
      await updateSelectedTab(activeTab, newItemName);
      setNewItemName("");
      setShowAdd(false);
    } catch (error) {
      console.error(error);
    }
  };

  const handleDelete = async (id) => {
    if (!window.confirm("Are you sure? This action is irreversible.")) return;
    
    if (activeTab === "batches") await deleteBatch(id);
    else if (activeTab === "semester Subjects") await deleteSemester(id);
    else if (activeTab === "arts Subjects") await deleteArtSems(id);
    else if (activeTab === "teachers") await deleteTeacher(id);
  };

  const handleUpdate = async (id) => {
    if (activeTab === "batches") await updateBatch(id, editName);
    else if (activeTab === "semester Subjects") await updateSemester(id, editName);
    else if (activeTab === "arts Subjects") await updateArtSem(id, editName);
    
    setEditId(null);
  };

  // Tab Configuration
  const TABS = [
    { id: "batches", label: "Batches", icon: FiLayers },
    { id: "current Semester", label: "Assign Semesters", icon: FiCalendar }, 
    { id: "current Art Sems", label: "Assign Art Sems", icon: FiCalendar }, 
    { id: "semester Subjects", label: "Subjects", icon: FiBook },
    { id: "arts Subjects", label: "Art Subjects", icon: FiBook },
    { id: "teachers", label: "Teachers", icon: FiUsers },
  ];

  // Logic to render specialized assignment components vs the generic list
  const isGenericList = !["current Semester", "current Art Sems"].includes(activeTab);

  return (
    <div className="min-h-screen bg-slate-50 dark:bg-surface-dark pb-20">
      <Header page="Management" />
      
      <div className="max-w-6xl mx-auto px-4 mt-8">
        
        {/* Header Area */}
        <div className="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4">
          <div>
            <h1 className="text-3xl font-display font-bold text-slate-800 dark:text-white">
              Academic Setup
            </h1>
            <p className="text-slate-500 dark:text-slate-400">
              Configure batch structures and curriculum.
            </p>
          </div>

          {isGenericList && (
            <div className="relative w-full md:w-64">
              <FiSearch className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400" />
              <input
                type="text"
                placeholder="Search..."
                value={searchTerm}
                onChange={(e) => setSearchTerm(e.target.value)}
                className="w-full pl-10 pr-4 py-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-primary-500 outline-none transition-all"
              />
            </div>
          )}
        </div>

        {/* Tab Navigation */}
        <div className="flex flex-wrap gap-2 mb-8 bg-white dark:bg-slate-800 p-2 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700">
          {TABS.map((tab) => (
            <button
              key={tab.id}
              onClick={() => setActiveTab(tab.id)}
              className={`flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm font-medium transition-all duration-300
                ${activeTab === tab.id 
                  ? "bg-primary-600 text-white shadow-md" 
                  : "text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-700 dark:text-slate-400"}`}
            >
              <tab.icon size={16} /> {tab.label}
            </button>
          ))}
        </div>

        {/* --- DYNAMIC CONTENT --- */}
        
        {/* 1. Specialized Assignment Components */}
        {activeTab === "current Semester" && (
          <SemesterAssignment batches={batches} semesters={semesters} tab={activeTab} />
        )}
        
        {activeTab === "current Art Sems" && (
          <SemesterAssignment batches={batches} semesters={artSems} tab={activeTab} art={true} />
        )}

        {/* 2. Generic List View (Batches, Subjects, Teachers) */}
        {isGenericList && (
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            
            {/* Add New Card */}
            <motion.div 
              layout
              className={`p-6 rounded-2xl border-2 border-dashed border-slate-300 dark:border-slate-700 flex flex-col items-center justify-center cursor-pointer hover:border-primary-500 transition-colors bg-slate-50/50 dark:bg-slate-800/50 min-h-[140px]
                ${showAdd ? "bg-white dark:bg-slate-800 border-solid border-slate-200" : ""}`}
              onClick={() => !showAdd && setShowAdd(true)}
            >
              {showAdd ? (
                activeTab === "teachers" ? (
                  navigate("/dashboard/admin/signup")
                ) : (
                  <div className="w-full space-y-3" onClick={e => e.stopPropagation()}>
                    <input 
                      autoFocus
                      placeholder={`New ${activeTab.replace(/s$/, "")}...`}
                      className="w-full p-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-primary-500 text-slate-800 dark:text-white"
                      value={newItemName}
                      onChange={e => setNewItemName(e.target.value)}
                      onKeyDown={e => e.key === 'Enter' && handleAdd()}
                    />
                    <div className="flex gap-2 justify-end">
                      <button onClick={() => setShowAdd(false)} className="p-2 text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg"><FiX /></button>
                      <button onClick={handleAdd} className="p-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 shadow-lg shadow-primary-500/30"><FiSave /></button>
                    </div>
                  </div>
                )
              ) : (
                <div className="flex flex-col items-center text-slate-400 group">
                  <div className="w-12 h-12 bg-white dark:bg-slate-700 rounded-full flex items-center justify-center shadow-sm mb-3 group-hover:scale-110 transition-transform">
                    <FiPlus size={24} className="text-primary-500" />
                  </div>
                  <span className="font-medium text-sm">Add New {activeTab === "teachers" ? "Staff" : "Item"}</span>
                </div>
              )}
            </motion.div>

            {/* List Items */}
            <AnimatePresence>
              {items
                .filter(item => (item.name || "").toLowerCase().includes(searchTerm.toLowerCase()))
                .map((item, idx) => (
                  <motion.div
                    key={item._id || idx}
                    layout
                    initial={{ opacity: 0, scale: 0.95 }}
                    animate={{ opacity: 1, scale: 1 }}
                    exit={{ opacity: 0, scale: 0.95 }}
                    className="bg-white dark:bg-slate-800 p-5 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700 group hover:shadow-lg hover:border-primary-200 dark:hover:border-slate-600 transition-all"
                  >
                    <div className="flex justify-between items-start mb-2">
                      <div className="flex items-center gap-3 w-full">
                        <div className="w-10 h-10 flex-shrink-0 rounded-xl bg-slate-100 dark:bg-slate-700 flex items-center justify-center font-display font-bold text-slate-500">
                          {idx + 1}
                        </div>
                        
                        {editId === item._id ? (
                          <input 
                            autoFocus
                            value={editName}
                            onChange={e => setEditName(e.target.value)}
                            className="flex-1 bg-slate-50 dark:bg-slate-900 border border-primary-300 rounded-lg px-2 py-1 outline-none focus:ring-2 focus:ring-primary-500 text-slate-800 dark:text-white"
                          />
                        ) : (
                          <div className="flex-1 min-w-0">
                            <h3 
                              onClick={() => {
                                // Smart Navigation based on Item Type
                                if (activeTab === "batches") navigate(`/dashboard/admin/attendance/${item._id}`);
                                else if (activeTab === "semester Subjects") navigate(`/dashboard/admin/semester/${item._id}`);
                                else if (activeTab === "arts Subjects") navigate(`/dashboard/admin/arts/${item._id}`);
                                else if (activeTab === "teachers") navigate(`/dashboard/admin/teacher-subjects/${item._id}`);
                              }}
                              className="font-bold text-slate-800 dark:text-white cursor-pointer hover:text-primary-600 transition-colors truncate"
                            >
                              {item.name}
                            </h3>
                            {item.userName && <p className="text-xs text-slate-400">@{item.userName}</p>}
                          </div>
                        )}
                      </div>

                      {/* Hover Actions */}
                      <div className="flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity ml-2">
                        {editId === item._id ? (
                          <button onClick={() => handleUpdate(item._id)} className="p-2 text-emerald-500 hover:bg-emerald-50 dark:hover:bg-emerald-900/20 rounded-lg"><FiSave /></button>
                        ) : (
                          <button 
                            onClick={() => { 
                              if (activeTab === "teachers") navigate(`/dashboard/admin/staff-edit/${item._id}`);
                              else { setEditId(item._id); setEditName(item.name); }
                            }} 
                            className="p-2 text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg"
                          >
                            <FiEdit2 size={16} />
                          </button>
                        )}
                        <button onClick={() => handleDelete(item._id)} className="p-2 text-rose-500 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg"><FiTrash2 size={16} /></button>
                      </div>
                    </div>
                  </motion.div>
                ))}
            </AnimatePresence>
          </div>
        )}
      </div>
    </div>
  );
};

export default ManagementPage;

================
File: frontend/index.html
================
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/web-app-manifest-192x192.png" />
    <link rel="manifest" href="/manifest.webmanifest" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Oswald:wght@400;500;700&display=swap" rel="stylesheet">
    <meta name="theme-color" content="#0284C7" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <title>UIA</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>

================
File: frontend/src/pages/admin/AdminHome.jsx
================
import React from 'react';
import { motion } from 'framer-motion';
import { 
  Users, GraduationCap, Settings, ClipboardList, 
  Award, HandCoins, FileText, DownloadCloud, 
  BookOpen, Layers, ShieldCheck 
} from "lucide-react";
import Card from "../../components/Card";

const downloadsUrl = "https://drive.google.com/drive/folders/1iTo_Ldar0yfnXF_0yUvCXBMfja9KN99w?usp=drive_link";

const AdminHome = () => {
  const containerVariants = {
    hidden: { opacity: 0 },
    visible: { opacity: 1, transition: { staggerChildren: 0.05 } }
  };

  const itemVariants = {
    hidden: { opacity: 0, y: 20 },
    visible: { opacity: 1, y: 0 }
  };

  const menuItems = [
    // Core Management (Wide Cards)
    { 
      title: "Student Management", 
      icon: Users, 
      route: "/dashboard/admin/users", 
      color: "blue",
      colSpan: "md:col-span-2",
      description: "Admissions, directory, and student profiles"
    },
    { 
      title: "Academic Setup", 
      icon: Settings, 
      route: "/dashboard/admin/management", 
      color: "indigo",
      colSpan: "md:col-span-1",
      description: "Manage batches, semesters & subjects"
    },
    
    // Duties & Register
    { 
      title: "Assign Duties", 
      icon: Layers, 
      route: "/dashboard/admin/assign-duties", 
      color: "amber",
      colSpan: "md:col-span-1",
      description: "Teachers & Class Leaders"
    },
    { 
      title: "Academic Register", 
      icon: ClipboardList, 
      route: "/dashboard/admin/academic-register", 
      color: "green",
      colSpan: "md:col-span-2",
      description: "Attendance & Class tracking logs"
    },

    // Marks & Results
    { 
      title: "Exam Results", 
      icon: Award, 
      route: "/dashboard/admin/batches/marklist", 
      color: "rose",
      colSpan: "md:col-span-1",
      description: "Semester marks entry"
    },
    { 
      title: "Achievements", 
      icon: ShieldCheck, 
      route: "/dashboard/admin/batches/achievements", 
      color: "purple",
      colSpan: "md:col-span-1",
      description: "Student awards approval"
    },
    { 
      title: "Reading Logs", 
      icon: BookOpen, 
      route: "/dashboard/admin/batches/reading-progress", 
      color: "blue",
      colSpan: "md:col-span-1" 
    },

    // Finances & Records
    { 
      title: "Finance (Ishthiraq)", 
      icon: HandCoins, 
      route: "/dashboard/admin/ishthiraq", 
      color: "emerald",
      colSpan: "md:col-span-2",
      description: "Fee collection dashboard"
    },
    { 
      title: "Documents", 
      icon: FileText, 
      route: "/dashboard/admin/academic-records", 
      color: "slate",
      colSpan: "md:col-span-1" 
    },
    { 
      title: "Downloads", 
      icon: DownloadCloud, 
      url: downloadsUrl, 
      color: "red",
      colSpan: "md:col-span-1" 
    },
  ];

  return (
    <div className="pt-6 pb-20">
      <motion.div 
        initial={{ opacity: 0, y: -20 }}
        animate={{ opacity: 1, y: 0 }}
        className="mb-8"
      >
        <h1 className="text-3xl font-display font-bold text-slate-800 dark:text-white">
          Admin Control Center
        </h1>
        <p className="text-slate-500 dark:text-slate-400">
          Manage your institution's operations from one place.
        </p>
      </motion.div>

      <motion.div 
        variants={containerVariants}
        initial="hidden"
        animate="visible"
        className="grid grid-cols-1 md:grid-cols-4 gap-4 auto-rows-[160px]"
      >
        {menuItems.map((item, index) => (
          <motion.div 
            key={index} 
            variants={itemVariants}
            className={`${item.colSpan} h-full`}
          >
            <Card 
              title={item.title} 
              icon={item.icon} 
              route={item.route} 
              url={item.url} 
              color={item.color}
              description={item.description}
            />
          </motion.div>
        ))}
      </motion.div>
    </div>
  );
};

export default AdminHome;

================
File: backend/src/controllers/auth.controller.js
================
import bcrypt from "bcryptjs";
import { generateToken } from "../lib/utils.js";
import User from "../models/student.model.js";
import cloudinary from "../lib/cloudinary.js";
import Staff from "../models/staff.model.js";
import { GoogleSpreadsheet } from 'google-spreadsheet';
import { JWT } from 'google-auth-library';
import Student from "../models/student.model.js";
import Batch from "../models/batch.model.js";

const serviceAccountAuth = new JWT({
  email: process.env.GOOGLE_SERVICE_ACCOUNT_EMAIL,
  key: process.env.GOOGLE_PRIVATE_KEY.replace(/\\n/g, '\n'), 
  scopes: ['https://www.googleapis.com/auth/spreadsheets'],
});

const SHEET_ID = '1rNnVoeYyt9OyeJe39o0Tyiucn-NUkEf1RkqZ6ZyHwxU';


export const signup = async (req, res) => {
  const { name, userName, phoneNumber, password, role } = req.body;
  
  try {
    if (!name || !userName || !phoneNumber || !password || !role ) {
      return res.status(400).json({ message: "All fields are required" });
    }

    if (password.length < 4 ) { 
      return res.status(400).json({ message: "Password must be at least 4 characters" });
    }

    const staff = await Staff.findOne({ phoneNumber });

    if (staff) return res.status(400).json({ message: "Phone Number already exists" });

    const salt = await bcrypt.genSalt(10);
    const hashedPassword = await bcrypt.hash(password, salt);

    const newStaff = new Staff({
      name,
      userName,
      phoneNumber,
      role,
      password: hashedPassword,
    });

    if (newStaff) {
      // generateToken(newStaff._id, res);
      await newStaff.save();

      res.status(201).json({
        _id: newStaff._id,
        name: newStaff.name,
        email: newStaff.email,
        // profilePic: newStaff.profilePic,
      });
    } else {
      res.status(400).json({ message: "Invalid user data" });
    }
  } catch (error) {
    console.log(error);
    
    console.log("Error in signup controller", error.message);
    res.status(500).json({ message: "Internal Server Error" });
  }
};

export const login = async (req, res) => {
  const { username, password, role} = req.body;
  
  try {
    if (!role) {
      return res.status(400).json({ message: "Role is required" });
    }

    let user;

    if (role === "student") {
      user = await User.findOne({ cicNumber:Number(username), isActive: true });
    } else {
      user = await Staff.findOne({ userName:username });
    }

    if (!user) {
      return res.status(400).json({ message: "Invalid credentials" });
    }

    const isPasswordCorrect = await bcrypt.compare(password, user.password);
    if (!isPasswordCorrect) {
      return res.status(400).json({ message: "Invalid password" });
    }

    generateToken(user._id, res);

    const responseData = {
      _id: user._id,
      name: user.name,
      batch: user.batch || null,
      batchId: user.batchId || null,
      email: user.email || null,
      address: user.address || null,
      cicNumber: user.cicNumber || null,
      phoneNumber: user.phoneNumber || null,
      whatsupNumber: user.whatsupNumber || null,
      parentNumber: user.parentNumber || null,
      role: user.role || null,
      profileImage: user.profileImage || null,
    };

    res.status(200).json(responseData);
  } catch (error) {
    console.error("Error in login controller:", error.message);
    res.status(500).json({ message: "Internal Server Error" });
  }
};

export const logout = (req, res) => {
  try {
    res.clearCookie("jwt", {
      httpOnly: true,
      secure: process.env.NODE_ENV === "production", 
      sameSite: process.env.NODE_ENV === "production" ? "None" : "Lax",
    });

    res.status(200).json({ message: "Logged out successfully" });
  } catch (error) {
    console.error("Error in logout controller:", error.message);
    res.status(500).json({ message: "Internal Server Error" });
  }
};



export const fetchGoogleSheetData = async (req, res) => {
  try {
    const doc = new GoogleSpreadsheet(SHEET_ID, serviceAccountAuth);
    await doc.loadInfo(); 

    console.log(`Sheet Title: ${doc.title}`);

    const sheet = doc.sheetsByIndex[0]; 
    console.log(`Worksheet Title: ${sheet.title}`);
    console.log(`Total Rows: ${sheet.rowCount}`);

    const rows = await sheet.getRows();
   
    const formattedData = rows.map(row => row._rawData);
    for(let c of formattedData){
console.log(c);

      // const batch = await Batch.findOne({ name: c[1] });
      
      // const salt = await bcrypt.genSalt(10);
      // const hashedPassword = await bcrypt.hash(c[2], salt);
       
  
    }


    res.status(200).json({ data: formattedData });

  } catch (error) {
    console.error('Error fetching Google Sheets data:', error);
  }
};

// export const updateProfile = async (req, res) => {
//   try {
//     const { profilePic } = req.body;
//     const userId = req.user._id;

//     if (!profilePic) {
//       return res.status(400).json({ message: "Profile pic is required" });
//     }

//     const uploadResponse = await cloudinary.uploader.upload(profilePic);
//     const updatedUser = await User.findByIdAndUpdate(
//       userId,
//       { profilePic: uploadResponse.secure_url },
//       { new: true }
//     );

//     res.status(200).json(updatedUser);
//   } catch (error) {
//     console.log("error in update profile:", error);
//     res.status(500).json({ message: "Internal server error" });
//   }
// };

export const checkAuth = (req, res) => {
  try {
    
    res.status(200).json(req.user);
  } catch (error) {
    console.log("Error in checkAuth controller", error.message);
    res.status(500).json({ message: "Internal Server Error" });
  }
};

================
File: backend/src/index.js
================
import express from "express";
import dotenv from "dotenv";
import cookieParser from "cookie-parser";
import cors from "cors";
import path from "path";
import { connectDB } from "./lib/db.js";

import authRoutes from "./routes/auth.route.js";
import bookRoutes from "./routes/book.route.js";
import userRoutes from "./routes/user.route.js";
import transactionRoutes from "./routes/transaction.route.js";
import admissionRoutes from "./routes/admission.route.js";
import managementRoutes from "./routes/management.route.js";
import marksRoutes from "./routes/marks.route.js";
import feesRoutes from "./routes/fees.route.js";
import achivemnetRoutes from "./routes/achivement.route.js"
import readingProgressRoutes from "./routes/readingProgress.route.js"
import recordRoutes from "./routes/records.route.js"

dotenv.config();

const PORT = process.env.PORT || 5000;
const __dirname = path.resolve();
const app = express();

app.use(cors({
  origin: [
    "http://localhost:5173",
    "http://localhost:4173", 
    "http://192.168.1.7:5173",
    "https://uia-management.vercel.app",
    "https://uia-app.vercel.app"
  ],
  credentials: true,
}));

app.use(express.json());
app.use(cookieParser());

app.use('/api/auth', authRoutes);
app.use('/api/books', bookRoutes);
app.use('/api/users', userRoutes);
app.use('/api/transactions', transactionRoutes);
app.use('/api/admission', admissionRoutes);
app.use('/api/mng', managementRoutes);
app.use('/api/marklist', marksRoutes);
app.use('/api/fees', feesRoutes);
app.use('/api/achievements', achivemnetRoutes);
app.use('/api/reading-progress', readingProgressRoutes);
app.use('/api/records', recordRoutes);

app.get("/api/ping", (req, res) => {
  res.status(200).send("Server is alive!");
});

if (process.env.NODE_ENV === "production") {
  app.use(express.static(path.join(__dirname, "../frontend/dist")));

  app.get("*", (req, res) => {
    res.sendFile(path.join(__dirname, "../frontend", "dist", "index.html"));
  });
}




app.listen(PORT, () => {
  console.log("Server running on PORT:", PORT);
  connectDB();
});

================
File: backend/src/controllers/mngController.js
================
import mongoose from "mongoose";
import Batch from "../models/batch.model.js";
import Staff from "../models/staff.model.js";
import Subject from "../models/Subject.model.js";
import Timetable from "../models/timetable.model.js";
import Semester from "../models/semester.model.js";
import ArtSemester from "../models/artsemester.model.js";
import ArtSubject from "../models/artsubject.model.js";

export const getTimetable = async (req, res) => {
  try {
    let timetable = await Timetable.findOne();
    let batch = await Batch.find()
    
    if (!timetable) {
      const weekdays = [ "Saturday","Sunday", "Monday", "Tuesday", "Wednesday", "Thursday"];
      const periodCount = 3;
      
      const createEmptySlot = () =>
        Object.fromEntries(batch.map((b) => [b.name, null]));
      
      const grid = {};
      
      weekdays.forEach((day) => {
        grid[day] = Array.from({ length: periodCount }, createEmptySlot);
      });
      
     timetable = new Timetable({ grid });
      
    }

    res.json(timetable);
  } catch (error) {
    res.status(500).json({ message: "Server error", error });
  }
};

export const postTimetable = async (req, res) => {
  try {
    const { grid } = req.body;

    let timetable = await Timetable.findOne();

    if (timetable) {
      timetable.grid = grid;
      await timetable.save();
    } else {
      timetable = new Timetable({ grid });
      await timetable.save();
    }
    res.json({ message: "Timetable updated", timetable });
  } catch (error) {
    res.status(500).json({ message: "Server error", error });
  }
};

export const getSemesters = async (req, res) => {
  try {
    const semesters = await Semester.find(); 
    
    res.status(200).json(semesters); 

  } catch (error) {
    console.error("Error fetching semesters:", error);
    res.status(500).json({ message: "Internal server error" });
  }
};

export const postSemester = async (req, res) => {
  try {
    const { name } = req.body;
    
    const isSemester = await Semester.findOne({ name });
    if (isSemester) {
      return res.status(400).json({ message: "This Semester already exists" });
    }

    const newSemester = new Semester({ name });
    await newSemester.save(); 

    res.status(201).json({ message: "Semester created successfully", newSemester });
  } catch (error) {
    console.error("Error creating Semester:", error);
    res.status(500).json({ message: "Internal server error" });
  }
};

export const deleteSemester = async (req, res) => {
  try {
    const { semesterId } = req.params;

    const deletedSemester = await Semester.findByIdAndDelete(semesterId);
    if (!deletedSemester) {
      return res.status(404).json({ message: "Semester not found" });
    }

    res.status(200).json({ message: "Semester deleted successfully" });
  } catch (error) {
    console.error("Error deleting Semester:", error);
    res.status(500).json({ message: "Internal server error" });
  }
};

export const updateSemester = async (req, res) => {
  try {
    const { semesterId } = req.params;
    const { name } = req.body;

    const updatedSemester = await Semester.findByIdAndUpdate(
      semesterId,
      { name },
      { new: true }
    );

    if (!updatedSemester) {
      return res.status(404).json({ message: "Semester not found" });
    }

    res.status(200).json({ message: "Semester updated successfully", updatedSemester });
  } catch (error) {
    console.error("Error updating Semester:", error);
    res.status(500).json({ message: "Internal server error" });
  }
};

export const getArtSems = async (req, res) => {
  try {
    const artSems = await ArtSemester.find(); 
    
    res.status(200).json(artSems); 

  } catch (error) {
    console.error("Error fetching art semesters:", error);
    res.status(500).json({ message: "Internal server error" });
  }
};

export const postArtSem = async (req, res) => {
  try {
    const { name } = req.body;
    
    const isartSemester = await ArtSemester.findOne({ name });
    if (isartSemester) {
      return res.status(400).json({ message: "This Semester already exists" });
    }

    const newArtSem = new ArtSemester({ name });
    await newArtSem.save(); 

    res.status(201).json({ message: "Semester created successfully", newArtSem });
  } catch (error) {
    console.error("Error creating Semester:", error);
    res.status(500).json({ message: "Internal server error" });
  }
};

export const deleteArtSem = async (req, res) => {
  try {
    const { semesterId } = req.params;

    const deletedSemester = await ArtSemester.findByIdAndDelete(semesterId);
    if (!deletedSemester) {
      return res.status(404).json({ message: "Semester not found" });
    }

    res.status(200).json({ message: "Semester deleted successfully" });
  } catch (error) {
    console.error("Error deleting Semester:", error);
    res.status(500).json({ message: "Internal server error" });
  }
};

export const updateArtSem = async (req, res) => {
  try {
    const { semesterId } = req.params;
    const { name } = req.body;

    const updatedSemester = await ArtSemester.findByIdAndUpdate(
      semesterId,
      { name },
      { new: true }
    );

    if (!updatedSemester) {
      return res.status(404).json({ message: "Semester not found" });
    }

    res.status(200).json({ message: "Semester updated successfully", updatedSemester });
  } catch (error) {
    console.error("Error updating Semester:", error);
    res.status(500).json({ message: "Internal server error" });
  }
};
 
export const getBatches = async (req, res) => {
  try {
    const batches = await Batch.find().sort({ createdAt: -1 });
    
    res.status(200).json(batches); 

  } catch (error) {
    console.error("Error fetching batches:", error);
    res.status(500).json({ message: "Internal server error" });
  }
};

export const deleteBatch = async (req, res) => {
  try {
    const { batchId } = req.params;

    const deletedBatch = await Batch.findByIdAndDelete(batchId);
    if (!deletedBatch) {
      return res.status(404).json({ message: "Batch not found" });
    }

    res.status(200).json({ message: "Batch deleted successfully" });
  } catch (error) {
    console.error("Error deleting Batch:", error);
    res.status(500).json({ message: "Internal server error" });
  }
};

export const updateBatch = async (req, res) => {
  try {
    const { batchId } = req.params;
    const { name } = req.body;
    
    const updatedBatch = await Batch.findByIdAndUpdate(
      batchId,
      { name },
      { new: true, runValidators: true }
    );
    

    if (!updatedBatch) {
      return res.status(404).json({ message: "Batch not found" });
    }

    res.status(200).json({ message: "Batch updated successfully", updatedBatch });
  } catch (error) {
    console.error("Error updating Batch:", error);
    res.status(500).json({ message: "Internal server error" });
  }
};

export const getBatch = async (req, res) => {
  try {
    let { batchId } = req.params;

    batchId = new mongoose.Types.ObjectId(batchId)

    const batch = await Batch.findById(batchId);
    
    if (!batch) {
      return res.status(404).json({ status: false, message: "Batch Not Found" });
    }

    res.status(200).json({ status: true, batch });
  } catch (error) {
    console.error("Error fetching class:", error);
    res.status(500).json({ status: false, message: "Server error", error: error.message });
  }
};

export const getAssignedBatch = async (req, res) => {
  try {
    const { teacherId } = req.params;

    const assignedbatches = await Batch.find({ classTeacher: teacherId });
    
    if (!assignedbatches) {
      return res.status(404).json({ status: false, message: "No class assigned" });
    }

    res.status(200).json({ status: true, assignedbatches });
  } catch (error) {
    console.error("Error fetching class:", error);
    res.status(500).json({ status: false, message: "Server error", error: error.message });
  }
};

export const postbatches = async (req, res) => {
  try {
    const { name } = req.body;

    const isBatch = await Batch.findOne({ name });
    if (isBatch) {
      return res.status(400).json({ message: "This class already exists" });
    }

    const newBatch = new Batch({ name });
    await newBatch.save(); 

    res.status(201).json({ message: "Batch created successfully", newBatch });
  } catch (error) {
    console.error("Error creating class:", error);
    res.status(500).json({ message: "Internal server error" });
  }
};

export const CELinkUpdate = async (req, res) => {
  
  try {
    const { batchId, CEmarkListLink } = req.body;

    if (!batchId || !CEmarkListLink) {
      return res.status(400).json({ message: "Missing batchId or CEmarkList" });
    }

    const batch = await Batch.findById(batchId);
    if (!batch) {
      return res.status(404).json({ message: "Batch not found" });
    }

    batch.CEmarkList = CEmarkListLink;
    await batch.save();

    return res.status(200).json({ message: "CE Marklist link updated successfully", batch });
  } catch (error) {
    console.error("Error updating CE Marklist link:", error);
    return res.status(500).json({ message: "Server error", error });
  }
};

export const CELinkDelete = async (req, res) => {
  
  try {
    const { batchId } = req.body;

    if (!batchId) {
      return res.status(400).json({ message: "Missing batchId" });
    }

    const batch = await Batch.findById(batchId);
    if (!batch) {
      return res.status(404).json({ message: "Batch not found" });
    }

    batch.CEmarkList = null;
    await batch.save();

    return res.status(200).json({ message: "CE Marklist link Deleted successfully", batch });
  } catch (error) {
    console.error("Error in deleting CE Marklist link:", error);
    return res.status(500).json({ message: "Server error", error });
  }
};

export const IRLinkUpdate = async (req, res) => {
  
  try {
    const { batchId, IRmarkListLink } = req.body;

    if (!batchId || !IRmarkListLink) {
      return res.status(400).json({ message: "Missing batchId or CEmarkList" });
    }

    const batch = await Batch.findById(batchId);
    if (!batch) {
      return res.status(404).json({ message: "Batch not found" });
    }

    batch.IRmarkList = IRmarkListLink;
    await batch.save();

    return res.status(200).json({ message: "IR Marklist link updated successfully", batch });
  } catch (error) {
    console.error("Error updating CE Marklist link:", error);
    return res.status(500).json({ message: "Server error", error });
  }
};

export const IRLinkDelete = async (req, res) => {
  
  try {
    const { batchId } = req.body;

    if (!batchId ) {
      return res.status(400).json({ message: "Missing batchId" });
    }

    const batch = await Batch.findById(batchId);
    if (!batch) {
      return res.status(404).json({ message: "Batch not found" });
    }

    batch.IRmarkList = null;
    await batch.save();

    return res.status(200).json({ message: "IR Marklist link updated successfully", batch });
  } catch (error) {
    console.error("Error updating CE Marklist link:", error);
    return res.status(500).json({ message: "Server error", error });
  }
};

export const academicStatusLinkUpdate = async (req, res) => {
  
  try {
    const { batchId, ...rest } = req.body;

    const item = Object.keys(rest)[0]
    

    if (!batchId || !item) {
      console.log(`Missing batchId or ${item}`);
      
      return res.status(400).json({ message: `Missing batchId or ${item}` });
    }

    const batch = await Batch.findById(batchId);
    if (!batch) {
      return res.status(404).json({ message: "Batch not found" });
    }

    batch[item] = rest[item];
    await batch.save();

    return res.status(200).json({ message: `${item} link updated successfully `, batch });
  } catch (error) {
    console.error( `Error updating ${item} link:`, error);
    return res.status(500).json({ message: "Server error", error });
  }
};

export const academicStatusLinkDelete = async (req, res) => {
  
  try {
    const { batchId, item } = req.body;
    
    if (!batchId || !item) {
      
      return res.status(400).json({ message: `Missing batchId or ${item}` });
    }

    const batch = await Batch.findById(batchId);
    if (!batch) {
      return res.status(404).json({ message: "Batch not found" });
    }

    batch[item] = null;
    await batch.save();

    return res.status(200).json({ message: ` ${item} link Deleted successfully`, batch });
  } catch (error) {
    console.error( `Error updating ${item} link:`, error);
    return res.status(500).json({ message: "Server error", error });
  }
};

export const getSubjects = async (req,res) => {
  try {
    let {semesterId} = req.params;

    const subjects = await Subject.find({semester: semesterId}); 

    if (subjects.length === 0) {
      return res.status(200).json( subjects);
    }

    res.status(200).json(subjects); 

  } catch (error) {
    console.error("Error fetching subjects:", error);
    res.status(500).json({ message: "Internal server error" });
  }
};

export const getArtSubjects = async (req,res) => {
  try {
    let {semesterId} = req.params;

    const subjects = await ArtSubject.find({artSemester: semesterId}); 

    if (subjects.length === 0) {
      return res.status(200).json( subjects);
    }

    res.status(200).json(subjects); 

  } catch (error) {
    console.error("Error fetching subjects:", error);
    res.status(500).json({ message: "Internal server error" });
  }
};

export const postSubject = async (req, res) => {
  try {
    const { semesterId } = req.params;
    
    const { name, mark, CEmark, isArtSub } = req.body;

    if (!name || !mark) {
      return res.status(400).json({ message: "Subject name and mark are required" });
    }
    
    if (isArtSub) {
      
      const isArtSubject = await ArtSubject.findOne({ name, artSemester: semesterId });
      if (isArtSubject) {
        return res.status(400).json({ message: "This subject already exists" });
      }
      const newSubject = new ArtSubject({ name, mark, CEmark, artSemester: semesterId });

      await newSubject.save();

      const selectedArtSemester = await ArtSemester.findById(semesterId);
      if (!selectedArtSemester) {
        return res.status(404).json({ message: "Art Semester not found" });
      }

      selectedArtSemester.subjects = selectedArtSemester.subjects || [];
      selectedArtSemester.subjects.push(newSubject._id);
      await selectedArtSemester.save();

      return res.status(201).json({ message: "Art subject created successfully", newSubject });
    }

    const isRegularSubject = await Subject.findOne({ name, semester: semesterId });
    if (isRegularSubject) {
      return res.status(400).json({ message: "This subject already exists" });
    }

    const newSubject = new Subject({ name, mark, CEmark, semester: semesterId });
    await newSubject.save();

    const selectedSemester = await Semester.findById(semesterId);
    if (!selectedSemester) {
      return res.status(404).json({ message: "Semester not found" });
    }

    selectedSemester.subjects = selectedSemester.subjects || [];
    selectedSemester.subjects.push(newSubject._id);
    await selectedSemester.save();

    return res.status(201).json({ message: "Subject created successfully", newSubject });
  } catch (error) {
    console.error("Error creating subject:", error);
    return res.status(500).json({ message: "Internal server error" });
  }
};

export const deleteSubject = async (req, res) => {
  try {
    const { subjectId } = req.params;

    const deletedSubject = await Subject.findByIdAndDelete(subjectId);
    if (!deletedSubject) {
      return res.status(404).json({ message: "Subject not found" });
    }

    await Semester.findOneAndUpdate(
      { subjects: subjectId },
      { $pull: { subjects: subjectId } },
      { new: true }
    );
    

    res.status(200).json({ message: "Subject deleted successfully" });
  } catch (error) {
    console.error("Error deleting Subject:", error);
    res.status(500).json({ message: "Internal server error" });
  }
};

export const updateSubject = async (req, res) => {
  try {
    const { subjectId } = req.params;
    const { name, mark, CEmark } = req.body;
    const updates = {};
    if (name !== undefined) updates.name = name;
    if (mark !== undefined) updates.mark = mark;
    if (CEmark !== undefined) updates.CEmark = CEmark;

    const updatedSubject = await Subject.findByIdAndUpdate(subjectId, updates, {
      new: true,
      runValidators: true
    });

    

    if (!updatedSubject) {
      return res.status(404).json({ message: "Subject not found" });
    }

    res.status(200).json({ message: "Subject updated successfully", updatedSubject });
  } catch (error) {
    console.error("Error updating Subject:", error);
    res.status(500).json({ message: "Internal server error" });
  }
};

export const deleteArtSubject = async (req, res) => {
  try {
    const { subjectId } = req.params;

    const deletedSubject = await ArtSubject.findByIdAndDelete(subjectId);
    if (!deletedSubject) {
      return res.status(404).json({ message: "Subject not found" });
    }

    await ArtSemester.findOneAndUpdate(
      { subjects: subjectId },
      { $pull: { subjects: subjectId } },
      { new: true }
    );
    

    res.status(200).json({ message: "Subject deleted successfully" });
  } catch (error) {
    console.error("Error deleting Subject:", error);
    res.status(500).json({ message: "Internal server error" });
  }
};

export const updateArtSubject = async (req, res) => {
  try {
    const { subjectId } = req.params;
    const { name, mark, CEmark } = req.body;
    const updates = {};
    if (name !== undefined) updates.name = name;
    if (mark !== undefined) updates.mark = mark;
    if (CEmark !== undefined) updates.CEmark = CEmark;

    const updatedSubject = await ArtSubject.findByIdAndUpdate(subjectId, updates, {
      new: true,
      runValidators: true
    });

    

    if (!updatedSubject) {
      return res.status(404).json({ message: "Subject not found" });
    }

    res.status(200).json({ message: "Subject updated successfully", updatedSubject });
  } catch (error) {
    console.error("Error updating Subject:", error);
    res.status(500).json({ message: "Internal server error" });
  }
};

export const asignBatchTeacher = async (req, res) => {
   try {
    const {classId, teacherId} = req.body;
    const selectedBatch = await Batch.findById(classId);
    if(!selectedBatch){
     return res.status(404).json({status: false, message:"Batch not found"});
    }
    
    selectedBatch.classTeacher = mongoose.Types.ObjectId.isValid(teacherId) ? teacherId : null;
     
    await selectedBatch.save();

    res.status(200).json({ status: true, message: "Teacher assigned successfully", selectedBatch });
  } catch (error) {
     res.status(500).json({ status: false, message: "Internal server error", error: error.message });
  }
};

export const asignClassLeader = async (req, res) => {
   try {
    const {classId, studentId, second = false} = req.body;
    const selectedBatch = await Batch.findById(classId);
    if(!selectedBatch){
     return res.status(404).json({status: false, message:"Batch not found"});
    }
    if (studentId === "No") {
      if (second) {
        selectedBatch.classLeader = null;
      } else {
        selectedBatch.classLeader2 = null;
      }
      
      await selectedBatch.save();
      
      return res.status(200).json({
        status: true,
        message: "Class Leader removed successfully",
        selectedBatch,
      });
      
    }
    
    if(second){
      selectedBatch.classLeader2 = mongoose.Types.ObjectId.isValid(studentId) ? studentId : null;
    }else{
      selectedBatch.classLeader = mongoose.Types.ObjectId.isValid(studentId) ? studentId : null;
    }
    
     
    await selectedBatch.save();

    res.status(200).json({ status: true, message: "Class Leader assigned successfully", selectedBatch });
  } catch (error) {
     res.status(500).json({ status: false, message: "Internal server error", error: error.message });
  }
};

export const asignsemester = async (req, res) => {
   try {
    const {classId, semesterId, art} = req.body;
    
    const selectedBatch = await Batch.findById(classId);
    if(!selectedBatch){
     return res.status(404).json({status: false, message:"Batch not found"});
    }
    if(art){
    selectedBatch.currentArtSemester = mongoose.Types.ObjectId.isValid(semesterId) ? semesterId : null;
    }else{
    selectedBatch.currentSemester = mongoose.Types.ObjectId.isValid(semesterId) ? semesterId : null;
    }
     
    await selectedBatch.save();

    res.status(200).json({ status: true, message: "Semester assigned successfully", selectedBatch });
  } catch (error) {
     res.status(500).json({ status: false, message: "Internal server error", error: error.message });
  }
};

export const asignSubteacher = async (req, res) => {
  try {
    const { subjectId, teacherId, second = false, art = false } = req.body;
    let subject;
    if(art){
        subject = await ArtSubject.findById(subjectId);
    if (!subject) {
      return res.status(404).json({ status: false, message: "Subject not found" });
    }
    }else{
        subject = await Subject.findById(subjectId);
    if (!subject) {
      return res.status(404).json({ status: false, message: "Subject not found" });
    }
    }
   

    if (teacherId === "No") {
      if (second) {
        subject.subTeacher2 = null;
      } else {
        subject.subTeacher = null;
      }
      
      await subject.save();
      
      return res.status(200).json({
        status: true,
        message: "Subject teacher removed successfully",
        subject,
      });
      
    }

    // Validate the teacher
    const teacher = await Staff.findById(teacherId);
    if (!teacher) {
      return res.status(404).json({ status: false, message: "Teacher not found" });
    }

    // Assign the teacher
    if (second) {
      subject.subTeacher2 = teacherId;
    } else {
      subject.subTeacher = teacherId;
    }

    await subject.save();

    res.status(200).json({
      status: true,
      message: "Subject teacher assigned successfully",
      subject,
    });
  } catch (error) {
    res.status(500).json({
      status: false,
      message: "Internal server error",
      error: error.message,
    });
  }
};

export const asignSubteacherPeriod = async (req, res) => {
  try {
    const { subjectId, period, second = false, art = false } = req.body;

    let subject;
    if(art){
        subject = await ArtSubject.findById(subjectId);
    if (!subject) {
      return res.status(404).json({ status: false, message: "Subject not found" });
    }
    }else{
        subject = await Subject.findById(subjectId);
    if (!subject) {
      return res.status(404).json({ status: false, message: "Subject not found" });
    }
    }

    if (period === 0) {
      if (second) {
        subject.periodTeacher2 = null;
      } else {
        subject.periodTeacher1 = null;
      }
      
      await subject.save();
      
      return res.status(200).json({
        status: true,
        message: "Subject Period removed successfully",
        subject,
      });
      
    }


    // Assign the Period
    if (second) {
      subject.periodTeacher2 = period;
    } else {
      subject.periodTeacher1 = period;
    }

    await subject.save();

    res.status(200).json({
      status: true,
      message: "Subject Period assigned successfully",
      subject,
    });
  } catch (error) {
    res.status(500).json({
      status: false,
      message: "Internal server error",
      error: error.message,
    });
  }
};

export const assignedSubjects = async (req, res) => {
  try {
    const { teacherId } = req.params;

    const subjects = await Subject.aggregate([
      {
        $match: {
          $or: [
            { subTeacher: new mongoose.Types.ObjectId(teacherId) },
            { subTeacher2: new mongoose.Types.ObjectId(teacherId) }
          ]
        }
      },
      {
        $lookup: {
          from: "batches",
          let: { semesterId: "$semester" },
          pipeline: [
            {
              $match: {
                $expr: {
                  $eq: [
                    "$currentSemester",
                    "$$semesterId"
                  ]
                }
              }
            },
            {
              $project: {
                _id: 1,
                name: 1,
                CEmarkList:1,
                currentSemester: 1
              }
            }
          ],
          as: "batchDetails"
        }
      },
      {
        $unwind: {
          path: "$batchDetails",
          preserveNullAndEmptyArrays: true 
        }
      }
    ]);

    const artSubjects = await ArtSubject.aggregate([
      {
        $match: {
          $or: [
            { subTeacher: new mongoose.Types.ObjectId(teacherId) },
            { subTeacher2: new mongoose.Types.ObjectId(teacherId) }
          ]
        }
      },
      {
        $lookup: {
          from: "batches",
          let: { semesterId: "$artSemester" },
          pipeline: [
            {
              $match: {
                $expr: {
                  $eq: [
                    "$currentArtSemester",
                    "$$semesterId"
                  ]
                }
              }
            },
            {
              $project: {
                _id: 1,
                name: 1,
                CEmarkList:1,
                currentArtSemester: 1
              }
            }
          ],
          as: "batchDetails"
        }
      },
      {
        $unwind: {
          path: "$batchDetails",
          preserveNullAndEmptyArrays: true 
        }
      }
    ]);

    const combined = [...subjects, ...artSubjects];

    return res.status(200).json(combined);
  } catch (error) {
    return res.status(500).json({
      status: false,
      message: "Internal server error",
      error: error.message,
    });
  }
};

export const curruntSemSubjects = async (req, res) => {
  try {
    const { batchId } = req.params;

    const batch = await Batch.findById(batchId);
    if (!batch) {
      
      return res.status(404).json({ message: "Batch not found" });
    }

    if (!batch.currentSemester) {

      return res.status(400).json({ message: "Semester not assigned" });
    }


    const subjects = await Subject.aggregate([
      {
        $match: { semester: batch.currentSemester }
      },
      {
        $lookup: {
          from: "staffs",
          localField: "subTeacher",
          foreignField: "_id",
          as: "subTeacherInfo"
        }
      },
      {
        $lookup: {
          from: "staffs",
          localField: "subTeacher2",
          foreignField: "_id",
          as: "subTeacher2Info"
        }
      },
      {
        $project: {
          name: 1,
          mark: 1,
          CEmark: 1,
          "subTeacherInfo.name": 1,
          "subTeacher2Info.name": 1
        }
      }
    ]);
    const artSubjects = await ArtSubject.aggregate([
      {
        $match: { artSemester: batch.currentArtSemester }
      },
      {
        $lookup: {
          from: "staffs",
          localField: "subTeacher",
          foreignField: "_id",
          as: "subTeacherInfo"
        }
      },
      {
        $lookup: {
          from: "staffs",
          localField: "subTeacher2",
          foreignField: "_id",
          as: "subTeacher2Info"
        }
      },
      {
        $project: {
          name: 1,
          mark: 1,
          CEmark: 1,
          "subTeacherInfo.name": 1,
          "subTeacher2Info.name": 1
        }
      }
    ]);
    
    const combined = [...subjects, ...artSubjects];

    return res.status(200).json(combined);

  } catch (error) {
    console.error(error);
    return res.status(500).json({ message: "Server error" });
  }
};

export const postAttendance = async (req, res) => {
try {
  let {attendance, classId, date} = req.body;

  if (!classId) {
    return res.status(400).json({ error: "classId is required" });
  }
    
  date = date ? new Date(date) : new Date();
  if (isNaN(date.getTime())) {
    console.log("Invalid date format");
    return res.status(400).json({ error: "Invalid date format" });
  }

  const monthName = date.toLocaleString("default", { month: "long" }); 
  const day = date.getDate();

let response = await Batch.updateOne(
  { _id: classId },
  { $set: { [`attendance.${monthName}.${day}`]: attendance } }
);


 res.status(200).json({ message: "Attendance marked successfully!" });

  } catch (error) {
    console.log(error);
    
    res.status(500).json({ error: error.message });
  }
};

export const getAttendance = async (req, res) => {
  try {
    const { classId, date } = req.query;

    if (!classId || !date) {
      return res.status(400).json({ error: "classId and date are required" });
    }

    const parsedDate = new Date(date);
    if (isNaN(parsedDate.getTime())) {
      return res.status(400).json({ error: "Invalid date format" });
    }

    const monthName = parsedDate.toLocaleString("default", { month: "long" });
    const day = parsedDate.getDate(); 

    const classData = await Batch.findOne(
      { _id: classId },
      { [`attendance.${monthName}.${day}`]: 1, _id: 0 }
    );

    if (!classData) {
      return res.status(404).json({ error: "Batch not found" });
    }

    const attendance = classData.attendance?.[monthName]?.[day] || {};

    res.status(200).json({ date, attendance });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
};

================
File: frontend/src/routes/AdminRoutes.jsx
================
import { Routes, Route } from "react-router-dom";
import AdminHome from "../pages/admin/AdminHome";
import StudentList from "../pages/admin/StudentList";
import StudentForm from "../pages/admin/StudentForm";
import AdmissionForm from "../pages/admin/AdmissionForm";
import RegisterdStudents from "../pages/admin/RegisterdStudents";
import TimetableAsigment from "../pages/admin/TimetableAsigment";
import AssignDutiesPage from "../pages/admin/AssignDutiesPage";
import ManagementPage from "../pages/admin/ManagementPage";
import AdminAttendance from "../pages/admin/AdminAttendance";
import SemesterPage from "../pages/admin/SemesterPage";
import AdminMarkUpdate from "../pages/admin/AdminMarkUpdate";
import MarkSubmitedStudentsPage from "../pages/admin/MarkSubmitedStudentsPage";
import AdminsideMarkListes from "../pages/admin/AdminsideMarkListes ";
import CEMarkAdmin from "../pages/admin/CEMarkAdmin";
import IRMarkAdmin from "../pages/admin/IRMarkAdmin";
import StaffProfile from "../pages/admin/StaffProfile";
import SignupPage from "../pages/admin/SignupPage";
import BatchAcademicStatus from "../pages/admin/BatchAcademicStatus";
import AcademicRegister from "../pages/admin/AcademicRegister";
import InactiveStdList from "../pages/admin/InactiveStdList";
import AdminIshthiraq from "../pages/admin/AdminIshthiraq";
import AdminAchievementsPage from "../pages/admin/AdminAchievementsPage";
import AdminReadingProgressPage from "../pages/admin/AdminReadingProgressPage";
import AdminBatches from "../pages/admin/AdminBatches";
import BatchStudents from "../pages/admin/BatchStudents";
import RecordPage from "../pages/admin/RecordPage";
import AssignedSubjects from "../pages/staff/AssignedSubjects";
import AssignFees from "../pages/admin/AssignFees";
import FeesDashboardAnalytics from "../pages/admin/FeesDashboardAnalytics";
import FeesRegister from "../pages/admin/FeesRegister";


const AdminRoutes = () => {
  return (
    <Routes>
      <Route index element={<AdminHome />} />
      <Route path="users" element={<StudentList />} />
      <Route path="inactive-std" element={<InactiveStdList />} />
      <Route path="users/add" element={<StudentForm />} />
      <Route path="users/edit/:id" element={<StudentForm edit />} />
      <Route path="admission-form" element={<AdmissionForm />} />
      <Route path="registered-students" element={<RegisterdStudents />} />
      <Route path="timetable-Assign" element={<TimetableAsigment />} />
      <Route path="assign-duties" element={<AssignDutiesPage />} />
      <Route path="management" element={<ManagementPage />} />
      <Route path="attendance/:batchId" element={<AdminAttendance />} />
      <Route path="semester/:semesterId" element={<SemesterPage />} />
      <Route path="arts/:artsId" element={<SemesterPage />} />
      {/* <Route path="batches/marklist/:batchId" element={<MarkSubmitedStudentsPage />} /> */}

      <Route path="teacher-subjects/:teacherId" element={<AssignedSubjects />} />

      <Route path="batches/:item" element={<AdminBatches />} />
      <Route path="batches/:item/:batchId" element={<BatchStudents />} />

      <Route path="marklist/:studentId" element={<AdminsideMarkListes />} />
      <Route path="achievements/:studentId" element={<AdminAchievementsPage />} />
      <Route path="reading-progress/:studentId" element={<AdminReadingProgressPage />} />

      <Route path="ishthiraq" element={<FeesDashboardAnalytics />} />
      <Route path="add-fees" element={<FeesRegister />} />
      <Route path="assign-fees" element={<AssignFees />} />
      {/* <Route path="ishthiraq" element={<AdminIshthiraq item="ishthiraq" />} /> */}
      <Route path="ce-mark" element={<CEMarkAdmin />} />
      <Route path="ir-mark" element={<IRMarkAdmin />} />
      <Route path="profile" element={<StaffProfile />} />
      <Route path="std-edit/:studentId" element={<AdmissionForm />} />
      <Route path="staff-edit/:teacherId" element={<SignupPage />} />
      <Route path="signup" element={<SignupPage />} />

      <Route path="academic-records" element={<RecordPage  />} />

      <Route path="academic-register" element={<AcademicRegister  />} />
      <Route path="std-attendance-register" element={<BatchAcademicStatus item="stdAttendanceRegister" />} />
      <Route path="staff-attendance-register" element={<BatchAcademicStatus item="staffAttendanceRegister" />} />
      <Route path="subject-status" element={<BatchAcademicStatus item="subjectStatus" />} />
      <Route path="ce-status" element={<BatchAcademicStatus item="ceStatus" />} />
      

      <Route path="*" element={<AdminHome />} />
    </Routes>
  );
};

export default AdminRoutes;





================================================================
End of Codebase
================================================================
